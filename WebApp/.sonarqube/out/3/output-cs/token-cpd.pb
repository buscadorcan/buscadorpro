ƒq
7C:\Users\Dell\source\repos\BuscadorCan\WebApp\Routes.cs
	namespace 	
WebApp
 
{ 
public 

static 
class 
Routes 
{ 
public 
const 
string 
BUSCADOR $
=% &
$str' 5
;5 6
public		 
const		 
string		 
SEARCH_PHRASE		 )
=		* +
$str		, ;
;		; <
public

 
const

 
string

 %
HOMOLOGACION_ESQUEMA_TODO

 5
=

6 7
$str

8 Q
;

Q R
public 
const 
string #
HOMOLOGACION_ESQUEMA_ID 3
=4 5
$str6 K
;K L
public 
const 
string "
FN_ESQUEMA_CABECERA_ID 2
=3 4
$str5 H
;H I
public 
const 
string %
HOMOLOGACION_ESQUEMA_DATO 5
=6 7
$str8 Q
;Q R
public 
const 
string  
ESQUEMA_DATO_BUSCADO 0
=1 2
$str3 G
;G H
public 
const 
string 
PREDIC_WORDS (
=) *
$str+ 9
;9 :
public 
const 
string 
VALIDATE_WORDS *
=+ ,
$str- <
;< =
public 
const 
string 
EVENTTRACKING )
=* +
$str, >
;> ?
public 
const 
string 
GEO_CODE $
=% &
$str' 0
;0 1
public 
const 
string 
EXCEL !
=" #
$str$ +
;+ ,
public 
const 
string 
PDF 
=  !
$str" '
;' (
public 
const 
string 
	CATALOGOS %
=& '
$str( 7
;7 8
public 
const 
string 
GRID_SCHEMA '
=( )
$str* 7
;7 8
public 
const 
string 
FILTERS_SCHEMA *
=+ ,
$str- =
;= >
public 
const 
string 
FILTERS_DATA (
=) *
$str+ 9
;9 :
public 
const 
string 
DIMENSION_SCHEMA ,
=- .
$str/ B
;B C
public 
const 
string 
GRUPOS "
=# $
$str% -
;- .
public 
const 
string 
ROLES !
=" #
$str$ +
;+ ,
public 
const 
string 
ONAS  
=! "
$str# )
;) *
public   
const   
string   
MENU_CATALOGO   )
=  * +
$str  , 2
;  2 3
public!! 
const!! 
string!! 
PANEL!! !
=!!" #
$str!!$ +
;!!+ ,
public"" 
const"" 
string""  
ESQUEMA_ORGANIZACION"" 0
=""1 2
$str""3 D
;""D E
public## 
const## 
string## 
VW_ONA## "
=### $
$str##% ,
;##, -
public$$ 
const$$ 
string$$ 
FILTERS_ANINADOS$$ ,
=$$- .
$str$$/ A
;$$A B
public%% 
const%% 
string%% 
ANINADOS%% $
=%%% &
$str%%' 1
;%%1 2
public)) 
const)) 
string)) 
DYNAMIC)) #
=))$ %
$str))& 2
;))2 3
public** 
const** 
string** 
GETPROPERTIES** )
=*** +
$"**, .
$str**. L
"**L M
;**M N
public++ 
const++ 
string++ 
GETVALUECOLUMNA++ +
=++, -
$"++. 0
$str++0 ^
"++^ _
;++_ `
public,, 
const,, 
string,, %
GETLISTAVALIDACIONESQUEMA,, 5
=,,6 7
$",,8 :
$str,,: \
",,\ ]
;,,] ^
public-- 
const-- 
string-- 
TEST--  
=--! "
$"--# %
$str--% 7
"--7 8
;--8 9
public.. 
const.. 
string.. 
MIGRAR.. "
=..# $
$"..% '
$str..' ;
"..; <
;..< =
public22 
const22 
string22 
ENVIAR22 "
=22# $
$str22% -
;22- .
public66 
const66 
string66 
ESQUEMA66 #
=66$ %
$str66& 3
;663 4
public77 
const77 
string77 

VALIDACION77 &
=77' (
$str77) 5
;775 6
public88 
const88 
string88 $
VALIDACION_ACTUALIZACION88 4
=885 6
$str887 N
;88N O
public99 
const99 
string99 
VISTA_COLUMNA99 )
=99* +
$str99, ;
;99; <
public:: 
const:: 
string:: 

ESQUEMA_ID:: &
=::' (
$"::) +
$str::+ =
"::= >
;::> ?
public>> 
const>> 
string>> 
EVENT_TRACKING>> *
=>>+ ,
$str>>- @
;>>@ A
public?? 
const?? 
string?? 
EVENT_USER_ALL?? *
=??+ ,
$str??- ;
;??; <
public@@ 
const@@ 
string@@ 
EVENT@@ !
=@@" #
$str@@$ *
;@@* +
publicAA 
constAA 
stringAA 
EVENT_DELETEAA (
=AA) *
$"AA+ -
$strAA- I
"AAI J
;AAJ K
publicBB 
constBB 
stringBB 
EVENT_DELETE_IDBB +
=BB, -
$"BB. 0
$strBB0 O
"BBO P
;BBP Q
publicCC 
constCC 
stringCC 
EVENT_SESSIONCC )
=CC* +
$strCC, :
;CC: ;
publicDD 
constDD 
stringDD 
COORDINATESDD '
=DD( )
$"DD* ,
$strDD, >
"DD> ?
;DD? @
publicEE 
constEE 
stringEE 
EVENT_PAG_MAS_VISITEE /
=EE0 1
$strEE2 D
;EED E
publicFF 
constFF 
stringFF "
EVENT_FILTRO_MAS_USADOFF 2
=FF3 4
$strFF5 J
;FFJ K
publicJJ 
constJJ 
stringJJ 
GOOGLEJJ "
=JJ# $
$strJJ% 2
;JJ2 3
publicKK 
constKK 
stringKK 
	AUTHORIZEKK %
=KK& '
$strKK( 3
;KK3 4
publicLL 
constLL 
stringLL 
CALLBACKLL $
=LL% &
$strLL' 1
;LL1 2
publicPP 
constPP 
stringPP 
HOMOLOGACIONPP (
=PP) *
$strPP+ =
;PP= >
publicQQ 
constQQ 
stringQQ 
FIND_BY_PARENTQQ *
=QQ+ ,
$strQQ- ;
;QQ; <
publicRR 
constRR 
stringRR '
FIND_BY_CODIGO_HOMOLOGACIONRR 7
=RR8 9
$"RR: <
$strRR< k
"RRk l
;RRl m
publicSS 
constSS 
stringSS $
FIND_BY_ALL_HOMOLOGACIONSS 4
=SS5 6
$strSS7 B
;SSB C
publicWW 
constWW 
stringWW 
LOG_MIGRACIONWW )
=WW* +
$strWW, >
;WW> ?
public[[ 
const[[ 
string[[ 
MIGRACION_EXCEL[[ +
=[[, -
$str[[. B
;[[B C
public\\ 
const\\ 
string\\ 
MIGRACION_UPLOAD\\ ,
=\\- .
$str\\/ 7
;\\7 8
public`` 
const`` 
string`` 
CONEXION`` $
=``% &
$str``' 5
;``5 6
publicaa 
constaa 
stringaa 
	LISTA_ONAaa %
=aa& '
$"aa( *
$straa* @
"aa@ A
;aaA B
publicee 
constee 
stringee 
ONACee  
=ee! "
$stree# -
;ee- .
publicff 
constff 
stringff 
POST_ONA_MIGRATEff ,
=ff- .
$strff/ ?
;ff? @
publicjj 
constjj 
stringjj 
MENUjj  
=jj! "
$strjj# -
;jj- .
publicnn 
constnn 
stringnn 
ONAnn 
=nn  !
$strnn" +
;nn+ ,
publicoo 
constoo 
stringoo 
LISTA_ONA_BY_IDoo +
=oo, -
$"oo. 0
$stroo0 C
"ooC D
;ooD E
publicpp 
constpp 
stringpp 
PAISESpp "
=pp# $
$strpp% -
;pp- .
publictt 
consttt 
stringtt 
REPORTES_VISTAtt *
=tt+ ,
$strtt- ?
;tt? @
publicuu 
constuu 
stringuu 
FIND_BY_VISTAuu )
=uu* +
$"uu, .
$struu. P
"uuP Q
;uuQ R
publicvv 
constvv 
stringvv 
ACREDITACION_ONAvv ,
=vv- .
$strvv/ A
;vvA B
publicww 
constww 
stringww  
ACREDITACION_ESQUEMAww 0
=ww1 2
$strww3 I
;wwI J
publicxx 
constxx 
stringxx 
ESTADO_ESQUEMAxx *
=xx+ ,
$strxx- =
;xx= >
publicyy 
constyy 
stringyy 
OEC_PAISyy $
=yy% &
$stryy' 1
;yy1 2
publiczz 
constzz 
stringzz 
ESQUEMA_PAISzz (
=zz) *
$strzz+ 9
;zz9 :
public{{ 
const{{ 
string{{ 
	OEC_FECHA{{ %
={{& '
$str{{( 3
;{{3 4
public|| 
const|| 
string|| "
PROFESIONAL_CALIFICADO|| 2
=||3 4
$str||5 M
;||M N
public}} 
const}} 
string}} 
PROFESIONAL_ONA}} +
=}}, -
$str}}. ?
;}}? @
public~~ 
const~~ 
string~~ 
PROFESIONAL_ESQUEMA~~ /
=~~0 1
$str~~2 G
;~~G H
public 
const 
string 
PROFESIONAL_FECHA -
=. /
$str0 C
;C D
public
ÄÄ 
const
ÄÄ 
string
ÄÄ  
CALIFICA_UBICACION
ÄÄ .
=
ÄÄ/ 0
$str
ÄÄ1 E
;
ÄÄE F
public
ÅÅ 
const
ÅÅ 
string
ÅÅ 
BUSQUEDA_FECHA
ÅÅ *
=
ÅÅ+ ,
$str
ÅÅ- =
;
ÅÅ= >
public
ÇÇ 
const
ÇÇ 
string
ÇÇ 
BUSQUEDA_FILTRO
ÇÇ +
=
ÇÇ, -
$str
ÇÇ. ?
;
ÇÇ? @
public
ÉÉ 
const
ÉÉ 
string
ÉÉ  
BUSQUEDA_UBICACION
ÉÉ .
=
ÉÉ/ 0
$str
ÉÉ1 E
;
ÉÉE F
public
ÑÑ 
const
ÑÑ 
string
ÑÑ 
ACTUALIZACION_ONA
ÑÑ -
=
ÑÑ. /
$str
ÑÑ0 C
;
ÑÑC D
public
ÖÖ 
const
ÖÖ 
string
ÖÖ "
ORGANISMO_REGISTRADO
ÖÖ 0
=
ÖÖ1 2
$str
ÖÖ3 I
;
ÖÖI J
public
ÜÜ 
const
ÜÜ 
string
ÜÜ 
ORGANISMO_ESQUEMA
ÜÜ -
=
ÜÜ. /
$str
ÜÜ0 F
;
ÜÜF G
public
áá 
const
áá 
string
áá !
ORGANISMO_ACTIVIDAD
áá /
=
áá0 1
$str
áá2 G
;
ááG H
public
ãã 
const
ãã 
string
ãã 
	THESAURUS
ãã %
=
ãã& '
$str
ãã( 7
;
ãã7 8
public
åå 
const
åå 
string
åå 
GET_THESAURUS
åå )
=
åå* +
$str
åå, ?
;
åå? @
public
çç 
const
çç 
string
çç 
THESAURUS_AGREGAR
çç -
=
çç. /
$str
çç0 C
;
ççC D
public
éé 
const
éé 
string
éé "
THESAURUS_ACTUALIZAR
éé 0
=
éé1 2
$str
éé3 I
;
ééI J
public
èè 
const
èè 
string
èè #
THESAURUS_AGREGAR_SUB
èè 1
=
èè2 3
$"
èè4 6
$str
èè6 o
"
èèo p
;
èèp q
public
êê 
const
êê 
string
êê  
THESAURUS_EJECUTAR
êê .
=
êê/ 0
$str
êê1 ?
;
êê? @
public
ëë 
const
ëë 
string
ëë 
THESAURUS_RESET
ëë +
=
ëë, -
$str
ëë. ?
;
ëë? @
public
ïï 
const
ïï 
string
ïï 
USUARIOS
ïï $
=
ïï% &
$str
ïï' 5
;
ïï5 6
public
ññ 
const
ññ 
string
ññ 
LOGIN
ññ !
=
ññ" #
$str
ññ$ +
;
ññ+ ,
public
óó 
const
óó 
string
óó 
VALIDAR
óó #
=
óó$ %
$str
óó& /
;
óó/ 0
public
òò 
const
òò 
string
òò 
	RECUPERAR
òò %
=
òò& '
$str
òò( 3
;
òò3 4
public
ôô 
const
ôô 
string
ôô 
REGISTRO
ôô $
=
ôô% &
$str
ôô' 1
;
ôô1 2
public
öö 
const
öö 
string
öö 
VALIDAR_EMAIL
öö )
=
öö* +
$str
öö, ;
;
öö; <
public
õõ 
const
õõ 
string
õõ 
CAMBIAR_CLAVE
õõ )
=
õõ* +
$str
õõ, ;
;
õõ; <
public
üü 
const
üü 
string
üü 
UPLOAD_ICON
üü '
=
üü( )
$str
üü* 6
;
üü6 7
}
°° 
}¢¢ Ö;
8C:\Users\Dell\source\repos\BuscadorCan\WebApp\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
Log 
. 
Logger 

= 
new 
LoggerConfiguration $
($ %
)% &
. 
ReadFrom 
. 
Configuration 
( 
builder #
.# $
Configuration$ 1
)1 2
. 
Enrich 
. 
FromLogContext 
( 
) 
. 
CreateLogger 
( 
) 
; 
builder 
. 
Host 
. 

UseSerilog 
( 
) 
; 
builder 
. 
Services 
. 
	Configure 
< 
FormOptions &
>& '
(' (
options( /
=>0 2
{3 4
options 	
.	 
$
MultipartBodyLengthLimit
 "
=# $
$num% -
;- .
} 
) 
; 
builder 
. 
Services 
. 
ConfigureDbContexts $
($ %
builder% ,
., -
Configuration- :
): ;
;; <
builder"" 
."" 
Services"" 
."" 
ConfigureServices"" "
(""" #
)""# $
;""$ %
builder'' 
.'' 
Services'' 
.'' #
ConfigureAuthentication'' (
(''( )
builder'') 0
.''0 1
Configuration''1 >
)''> ?
;''? @
builder,, 
.,, 
Services,, 
.,, 
ConfigureSwagger,, !
(,,! "
),," #
;,,# $
builder.. 
... 
Services.. 
... 
ConfigureRoutes..  
(..  !
builder..! (
...( )
Configuration..) 6
)..6 7
;..7 8
builder44 
.44 
Services44 
.44 
AddControllers44 
(44  
)44  !
.44! "
AddNewtonsoftJson44" 3
(443 4
)444 5
;445 6
builder66 
.66 
Services66 
.66 
AddCors66 
(66 
options66  
=>66! #
{77 
options88 
.88 
	AddPolicy88 
(88 
$str88 "
,88" #
builder99 
=>99 
{:: 	
string;; 
[;; 
];; 
domainsAllowed;; #
=;;$ %
[;;& '
Inicializar<< 
.<< 

UrlBaseApi<< &
,<<& '
Inicializar== 
.== 
UrlBaseAdmin== (
,==( )
Inicializar>> 
.>> 
UrlBaseServ>> '
,>>' (
Inicializar?? 
.?? 
UrlBaseBuscador?? +
,??+ ,
Inicializar@@ 
.@@ 
UrlBasePublicServ@@ -
]AA 
;AA 
builderCC 
.CC 
WithOriginsCC 
(CC  
domainsAllowedCC  .
)CC. /
.DD 
AllowAnyHeaderDD "
(DD" #
)DD# $
.EE 
AllowAnyMethodEE "
(EE" #
)EE# $
;EE$ %
}FF 	
)FF	 

;FF
 
}GG 
)GG 
;GG 
builderII 
.II 
ConfigurationII 
.JJ 
AddJsonFileJJ 
(JJ 
$strJJ #
,JJ# $
optionalJJ% -
:JJ- .
falseJJ/ 4
)JJ4 5
.KK 
AddJsonFileKK 
(KK 
$"KK 
$strKK 
{KK  
builderKK  '
.KK' (
EnvironmentKK( 3
.KK3 4
EnvironmentNameKK4 C
}KKC D
$strKKD I
"KKI J
,KKJ K
optionalKKL T
:KKT U
trueKKV Z
)KKZ [
.LL #
AddEnvironmentVariablesLL 
(LL 
)LL 
;LL 
builderQQ 
.QQ 
ServicesQQ 
.QQ 
AddRateLimiterQQ 
(QQ  
optionsQQ  '
=>QQ( *
{RR 
optionsSS 
.SS 
GlobalLimiterSS 
=SS "
PartitionedRateLimiterSS 2
.SS2 3
CreateSS3 9
<SS9 :
HttpContextSS: E
,SSE F
stringSSG M
>SSM N
(SSN O
httpContextSSO Z
=>SS[ ]
RateLimitPartitionTT 
.TT !
GetFixedWindowLimiterTT 0
(TT0 1
partitionKeyUU 
:UU 
httpContextUU %
.UU% &

ConnectionUU& 0
.UU0 1
RemoteIpAddressUU1 @
?UU@ A
.UUA B
ToStringUUB J
(UUJ K
)UUK L
??UUM O
$strUUP Y
,UUY Z
factoryVV 
:VV 
_VV 
=>VV 
newVV )
FixedWindowRateLimiterOptionsVV ;
{WW 
PermitLimitXX 
=XX 
$numXX !
,XX! "
WindowYY 
=YY 
TimeSpanYY !
.YY! "
FromMinutesYY" -
(YY- .
$numYY. /
)YY/ 0
,YY0 1 
QueueProcessingOrderZZ $
=ZZ% & 
QueueProcessingOrderZZ' ;
.ZZ; <
OldestFirstZZ< G
,ZZG H

QueueLimit[[ 
=[[ 
$num[[ 
}\\ 
)\\ 
)\\ 
;\\ 
options]] 
.]] 
RejectionStatusCode]] 
=]]  !
StatusCodes]]" -
.]]- .$
Status429TooManyRequests]]. F
;]]F G
}^^ 
)^^ 
;^^ 
var`` 
app`` 
=`` 	
builder``
 
.`` 
Build`` 
(`` 
)`` 
;`` 
appbb 
.bb 
UseRateLimiterbb 
(bb 
)bb 
;bb 
appii 
.ii 
UseCorsii 
(ii 
$strii 
)ii 
;ii 
appoo 
.oo 
UseStaticFilesoo 
(oo 
)oo 
;oo 
iftt 
(tt 
apptt 
.tt 
Environmenttt 
.tt 
IsDevelopmenttt !
(tt! "
)tt" #
||tt$ &
apptt' *
.tt* +
Environmenttt+ 6
.tt6 7
IsProductiontt7 C
(ttC D
)ttD E
)ttE F
{uu 
appvv 
.vv 

UseSwaggervv 
(vv 
)vv 
;vv 
appww 
.ww 
UseSwaggerUIww 
(ww 
)ww 
;ww 
appxx 
.xx 
UsePathBasexx 
(xx 
$strxx )
)xx) *
;xx* +
}yy 
app 
. 
UseAuthentication 
( 
) 
; 
appÑÑ 
.
ÑÑ 
UseAuthorization
ÑÑ 
(
ÑÑ 
)
ÑÑ 
;
ÑÑ 
appââ 
.
ââ 
MapControllers
ââ 
(
ââ 
)
ââ 
;
ââ 
appéé 
.
éé 
Run
éé 
(
éé 
)
éé 	
;
éé	 
˝T
;C:\Users\Dell\source\repos\BuscadorCan\WebApp\Extensions.cs
	namespace 	
WebApp
 
. 

Extensions 
{ 
public 

static 
class 
ServiceExtensions )
{ 
public 
static 
void 
ConfigureDbContexts .
(. /
this/ 3
IServiceCollection4 F
servicesG O
,O P
IConfigurationQ _
configuration` m
)m n
{ 	
services 
. 
AddDbContextPool %
<% &
SqlServerDbContext& 8
>8 9
(9 :
options: A
=>B D
options 
. 
UseSqlServer "
(" #
configuration# 0
.0 1
GetConnectionString1 D
(D E
$strE R
)R S
)S T
)   
;   
services## 
.## 
	AddScoped## 
<## &
ISqlServerDbContextFactory## 9
>##9 :
(##: ;
provider##; C
=>##D F
{$$ 
var%% 
options%% 
=%% 
provider%% &
.%%& '
GetRequiredService%%' 9
<%%9 :
DbContextOptions%%: J
<%%J K
SqlServerDbContext%%K ]
>%%] ^
>%%^ _
(%%_ `
)%%` a
;%%a b
return&& 
new&& %
SqlServerDbContextFactory&& 4
(&&4 5
options&&5 <
)&&< =
;&&= >
}'' 
)'' 
;'' 
services** 
.** 
AddSingleton** !
<**! "
IDbContextFactory**" 3
,**3 4
DbContextFactory**5 E
>**E F
(**F G
)**G H
;**H I
}++ 	
public11 
static11 
void11 
ConfigureServices11 ,
(11, -
this11- 1
IServiceCollection112 D
services11E M
)11M N
{22 	
services44 
.44 
AddAutoMapper44 "
(44" #
typeof44# )
(44) *
Mapper44* 0
)440 1
)441 2
;442 3
services77 
.77 
Scan77 
(77 
scan77 
=>77 !
scan77" &
.88 
FromAssembliesOf88 !
(88! "
typeof88" (
(88( )
EmailService88) 5
)885 6
,886 7
typeof888 >
(88> ?
ONARepository88? L
)88L M
)88M N
.99 

AddClasses99 
(99 
classes99 #
=>99$ &
classes99' .
.99. /
AssignableToAny99/ >
(99> ?
typeof:: 
(:: 
IGmailClientFactory:: .
)::. /
,::/ 0
typeof;; 
(;; 
ICatalogosService;; ,
);;, -
,;;- .
typeof<< 
(<< 
IEmailService<< (
)<<( )
,<<) *
typeof== 
(== #
IUsuarioEmailRepository== 2
)==2 3
,==3 4
typeof>> 
(>> 
IJwtFactory>> &
)>>& '
,>>' (
typeof?? 
(?? 
IJwtService?? &
)??& '
,??' (
typeof@@ 
(@@ 
IHashStrategy@@ (
)@@( )
,@@) *
typeofAA 
(AA 
IHashServiceAA '
)AA' (
,AA( )
typeofBB 
(BB )
IRandomStringGeneratorServiceBB 8
)BB8 9
,BB9 :
typeofCC 
(CC 
IThesaurusServiceCC ,
)CC, -
,CC- .
typeofDD 
(DD 
IUsuarioRepositoryDD -
)DD- .
,DD. /
typeofEE 
(EE 
IImportadorEE &
)EE& '
,EE' (
typeofFF 
(FF 
	IMigradorFF $
)FF$ %
,FF% &
typeofGG 
(GG 
IOnaMigrateGG &
)GG& '
,GG' (
typeofHH 
(HH  
IAuthenticateServiceHH /
)HH/ 0
,HH0 1
typeofII 
(II 
IRecoverUserServiceII .
)II. /
,II/ 0
typeofJJ 
(JJ *
IConectionStringBuilderServiceJJ 9
)JJ9 :
,JJ: ;
typeofKK 
(KK 
IDynamicRepositoryKK -
)KK- .
,KK. /
typeofLL 
(LL 
IReporteRepositoryLL -
)LL- .
,LL. /
typeofMM 
(MM )
IpaActualizarFiltroRepositoryMM 8
)MM8 9
,MM9 :
typeofNN 
(NN $
IEventTrackingRepositoryNN 3
)NN3 4
,NN4 5
typeofOO 
(OO  
IThesaurusRepositoryOO /
)OO/ 0
)PP 
)PP 
.QQ #
AsImplementedInterfacesQQ (
(QQ( )
)QQ) *
.RR 
WithScopedLifetimeRR #
(RR# $
)RR$ %
)SS 
;SS 
servicesVV 
.VV 
ScanVV 
(VV 
scanVV 
=>VV !
scanVV" &
.WW 
FromAssembliesOfWW !
(WW! "
typeofWW" (
(WW( )
EmailServiceWW) 5
)WW5 6
,WW6 7
typeofWW8 >
(WW> ?
ONARepositoryWW? L
)WWL M
)WWM N
.XX 

AddClassesXX 
(XX 
)XX 
.YY 
AsMatchingInterfaceYY $
(YY$ %
)YY% &
.ZZ 
WithScopedLifetimeZZ #
(ZZ# $
)ZZ$ %
)[[ 
;[[ 
services^^ 
.^^ 
AddSingleton^^ !
<^^! " 
IHttpContextAccessor^^" 6
,^^6 7
HttpContextAccessor^^8 K
>^^K L
(^^L M
)^^M N
;^^N O
servicesaa 
.aa 
AddHttpClientaa "
<aa" #!
IIpCoordinatesServiceaa# 8
,aa8 9 
IpCoordinatesServiceaa: N
>aaN O
(aaO P
)aaP Q
;aaQ R
}cc 	
publicjj 
staticjj 
voidjj #
ConfigureAuthenticationjj 2
(jj2 3
thisjj3 7
IServiceCollectionjj8 J
servicesjjK S
,jjS T
IConfigurationjjU c
configurationjjd q
)jjq r
{kk 	
varmm 
keymm 
=mm 
Encodingmm 
.mm 
ASCIImm $
.mm$ %
GetBytesmm% -
(mm- .
configurationmm. ;
.mm; <
GetValuemm< D
<mmD E
stringmmE K
>mmK L
(mmL M
$strmmM b
)mmb c
??mmd f
$strmmg i
)mmi j
;mmj k
servicespp 
.pp 
AddAuthenticationpp &
(pp& '
JwtBearerDefaultspp' 8
.pp8 9 
AuthenticationSchemepp9 M
)ppM N
.ppN O
AddJwtBearerppO [
(pp[ \
optionspp\ c
=>ppd f
{qq 
optionsrr 
.rr  
RequireHttpsMetadatarr ,
=rr- .
falserr/ 4
;rr4 5
optionsss 
.ss 
	SaveTokenss !
=ss" #
truess$ (
;ss( )
optionstt 
.tt %
TokenValidationParameterstt 1
=tt2 3
newtt4 7%
TokenValidationParameterstt8 Q
{uu $
ValidateIssuerSigningKeyvv ,
=vv- .
truevv/ 3
,vv3 4
IssuerSigningKeyww $
=ww% &
newww' * 
SymmetricSecurityKeyww+ ?
(ww? @
keyww@ C
)wwC D
,wwD E
ValidateIssuerxx "
=xx# $
falsexx% *
,xx* +
ValidateAudienceyy $
=yy% &
falseyy' ,
}zz 
;zz 
}{{ 
){{ 
;{{ 
}|| 	
public
ÇÇ 
static
ÇÇ 
void
ÇÇ 
ConfigureSwagger
ÇÇ +
(
ÇÇ+ ,
this
ÇÇ, 0 
IServiceCollection
ÇÇ1 C
services
ÇÇD L
)
ÇÇL M
{
ÉÉ 	
services
ÑÑ 
.
ÑÑ %
AddEndpointsApiExplorer
ÑÑ ,
(
ÑÑ, -
)
ÑÑ- .
;
ÑÑ. /
services
ÖÖ 
.
ÖÖ 
AddSwaggerGen
ÖÖ "
(
ÖÖ" #
options
ÖÖ# *
=>
ÖÖ+ -
{
ÜÜ 
options
àà 
.
àà #
AddSecurityDefinition
àà -
(
àà- .
$str
àà. 6
,
àà6 7
new
àà8 ;#
OpenApiSecurityScheme
àà< Q
{
ââ 
Description
ää 
=
ää  !
$str
ää" Y
+
ääZ [
$str
ãã z
+
ãã{ |
$str
åå 6
,
åå6 7
Name
çç 
=
çç 
$str
çç *
,
çç* +
In
éé 
=
éé 
ParameterLocation
éé *
.
éé* +
Header
éé+ 1
,
éé1 2
Scheme
èè 
=
èè 
$str
èè %
}
êê 
)
êê 
;
êê 
options
ìì 
.
ìì $
AddSecurityRequirement
ìì .
(
ìì. /
new
ìì/ 2(
OpenApiSecurityRequirement
ìì3 M
{
ììN O
{
îî
 
new
ïï #
OpenApiSecurityScheme
ïï %
{
ïï& '
	Reference
ññ 
=
ññ 
new
ññ 
OpenApiReference
ññ .
{
ññ/ 0
Type
óó 
=
óó 
ReferenceType
óó $
.
óó$ %
SecurityScheme
óó% 3
,
óó3 4
Id
òò 
=
òò 
$str
òò 
}
ôô 
,
ôô 
Scheme
öö 
=
öö 
$str
öö 
,
öö  
Name
õõ 
=
õõ 
$str
õõ 
,
õõ 
In
úú 
=
úú 
ParameterLocation
úú $
.
úú$ %
Header
úú% +
}
ùù 
,
ùù 
new
ûû 
List
ûû 
<
ûû 
string
ûû 
>
ûû 
(
ûû 
)
ûû 
}
üü
 
}
†† 	
)
††	 

;
††
 
}
°° 
)
°° 
;
°° 
}
¢¢ 	
public
§§ 
static
§§ 
void
§§ 
ConfigureRoutes
§§ *
(
§§* +
this
§§+ / 
IServiceCollection
§§0 B
services
§§C K
,
§§K L
IConfiguration
§§M [
configuration
§§\ i
)
§§i j
{
•• 	
var
¶¶ 
routes
¶¶ 
=
¶¶ 
configuration
¶¶ &
.
¶¶& '

GetSection
¶¶' 1
(
¶¶1 2
$str
¶¶2 <
)
¶¶< =
;
¶¶= >
}
®® 	
}
™™ 
}´´ ï(
PC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\UtilitiesController.cs
	namespace 	
WebApp
 
. 
Controllers 
{ 
[ 
	Authorize 
] 
[		 
Route		 

(		
 
$str		 
)		 
]		 
[

 
ApiController

 
]

 
public 

class 
UtilitiesController $
:% &
ControllerBase' 5
{ 
private 
readonly 
IWebHostEnvironment ,
_environment- 9
;9 :
public 
UtilitiesController "
(" #
IWebHostEnvironment# 6
environment7 B
)B C
{ 	
_environment 
= 
environment &
;& '
} 	
[ 	
HttpPost	 
( 
Routes 
. 
UPLOAD_ICON $
)$ %
]% &
public 
async 
Task 
< 
IActionResult '
>' (

UploadIcon) 3
(3 4
[4 5
FromForm5 =
]= >
	IFormFile? H
fileI M
,M N
[O P
FromFormP X
]X Y
intZ ]
idONA^ c
)c d
{ 	
try   
{!! 
if"" 
("" 
file"" 
=="" 
null""  
||""! #
file""$ (
.""( )
Length"") /
==""0 2
$num""3 4
)""4 5
return## 

BadRequest## %
(##% &
$str##& K
)##K L
;##L M
Console&& 
.&& 
	WriteLine&& !
(&&! "
$"&&" $
$str&&$ 5
{&&5 6
idONA&&6 ;
}&&; <
"&&< =
)&&= >
;&&> ?
var)) 
	extension)) 
=)) 
Path))  $
.))$ %
GetExtension))% 1
())1 2
file))2 6
.))6 7
FileName))7 ?
)))? @
?))@ A
.))A B
ToLowerInvariant))B R
())R S
)))S T
;))T U
var** 
allowedExtensions** %
=**& '
new**( +
[**+ ,
]**, -
{**. /
$str**0 6
,**6 7
$str**8 >
}**? @
;**@ A
if,, 
(,, 
string,, 
.,, 
IsNullOrEmpty,, (
(,,( )
	extension,,) 2
),,2 3
||,,4 6
!,,7 8
allowedExtensions,,8 I
.,,I J
Contains,,J R
(,,R S
	extension,,S \
),,\ ]
),,] ^
return-- 

BadRequest-- %
(--% &
$str--& H
)--H I
;--I J
var// 
uniqueFileName// "
=//# $
$"//% '
{//' (
idONA//( -
}//- .
{//. /
	extension/// 8
}//8 9
"//9 :
;//: ;
var00 

folderPath00 
=00  
Path00! %
.00% &
Combine00& -
(00- .
_environment00. :
.00: ;
ContentRootPath00; J
,00J K
$str00L U
,00U V
$str00W ^
)00^ _
;00_ `
if22 
(22 
!22 
	Directory22 
.22 
Exists22 %
(22% &

folderPath22& 0
)220 1
)221 2
	Directory33 
.33 
CreateDirectory33 -
(33- .

folderPath33. 8
)338 9
;339 :
var55 
filePath55 
=55 
Path55 #
.55# $
Combine55$ +
(55+ ,

folderPath55, 6
,556 7
uniqueFileName558 F
)55F G
;55G H
using77 
(77 
var77 
stream77 !
=77" #
new77$ '

FileStream77( 2
(772 3
filePath773 ;
,77; <
FileMode77= E
.77E F
Create77F L
)77L M
)77M N
{88 
await99 
file99 
.99 
CopyToAsync99 *
(99* +
stream99+ 1
)991 2
;992 3
}:: 
var<< 
relativePath<<  
=<<! "
$"<<# %
$str<<% +
{<<+ ,
uniqueFileName<<, :
}<<: ;
"<<; <
;<<< =
return== 
Ok== 
(== 
new== 
{== 
FilePath==  (
===) *
relativePath==+ 7
}==8 9
)==9 :
;==: ;
}>> 
catch?? 
(?? 
	Exception?? 
ex?? 
)??  
{@@ 
returnAA 

StatusCodeAA !
(AA! "
$numAA" %
,AA% &
$"AA' )
$strAA) O
{AAO P
exAAP R
.AAR S
MessageAAS Z
}AAZ [
"AA[ \
)AA\ ]
;AA] ^
}BB 
}CC 	
}DD 
}EE ⁄ç
OC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\UsuariosController.cs
	namespace		 	
WebApp		
 
.		 
Controllers		 
{

 
[ 
Route 

(
 
Routes 
. 
USUARIOS 
) 
] 
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class 
UsuariosController #
:$ %
BaseController& 4
{ 
private 
readonly 
IUsuarioService (
_iUsuarioService) 9
;9 :
private 
readonly  
IAuthenticateService -
	_iService. 7
;7 8
private 
readonly 
IRecoverUserService ,
_iServiceRecover- =
;= >
public 
UsuariosController !
(! "
IUsuarioService" 1
iUsuarioService2 A
,A B 
IAuthenticateServiceC W
iServiceX `
,` a
IRecoverUserServiceb u
iServiceRecover	v Ö
,
Ö Ü
ILogger
á é
<
é è 
UsuariosController
è °
>
° ¢
logger
£ ©
)
© ™
:
´ ¨
base
≠ ±
(
± ≤
logger
≤ ∏
)
∏ π
{ 	
this 
. 
_iUsuarioService !
=" #
iUsuarioService$ 3
;3 4
this 
. 
	_iService 
= 
iService %
;% &
this 
. 
_iServiceRecover !
=" #
iServiceRecover$ 3
;3 4
} 	
[)) 	
AllowAnonymous))	 
])) 
[** 	
HttpPost**	 
(** 
Routes** 
.** 
LOGIN** 
)** 
]**  
public++ 
IActionResult++ 
Login++ "
(++" #
[++# $
FromBody++$ ,
]++, -#
UsuarioAutenticacionDto++. E#
usuarioAutenticacionDto++F ]
)++] ^
{,, 	
try-- 
{.. 
var// 
result// 
=// 
	_iService// &
.//& '
Authenticate//' 3
(//3 4#
usuarioAutenticacionDto//4 K
)//K L
;//L M
if11 
(11 
!11 
result11 
.11 
	IsSuccess11 %
)11% &
{22 
return33 
BadRequestResponse33 -
(33- .
result33. 4
.334 5
ErrorMessage335 A
)33A B
;33B C
}44 
return66 
Ok66 
(66 
new66 
RespuestasAPI66 +
<66+ ,#
AuthenticateResponseDto66, C
>66C D
{77 
Result88 
=88 
result88 #
.88# $
Value88$ )
}99 
)99 
;99 
}:: 
catch;; 
(;; 
	Exception;; 
e;; 
);; 
{<< 
return== 
HandleException== &
(==& '
e==' (
,==( )
nameof==* 0
(==0 1
Login==1 6
)==6 7
)==7 8
;==8 9
}>> 
}?? 	
[JJ 	
AllowAnonymousJJ	 
]JJ 
[KK 	
HttpPostKK	 
(KK 
RoutesKK 
.KK 
VALIDARKK  
)KK  !
]KK! "
publicLL 
IActionResultLL 
ValidarLL $
(LL$ %
[LL% &
FromBodyLL& .
]LL. /
AuthValidationDtoLL0 A
authValidationDtoLLB S
)LLS T
{MM 	
tryNN 
{OO 
varPP 
resultPP 
=PP 
	_iServicePP &
.PP& '
ValidateCodePP' 3
(PP3 4
authValidationDtoPP4 E
)PPE F
;PPF G
ifRR 
(RR 
!RR 
resultRR 
.RR 
	IsSuccessRR %
)RR% &
{SS 
returnTT 
BadRequestResponseTT -
(TT- .
resultTT. 4
.TT4 5
ErrorMessageTT5 A
)TTA B
;TTB C
}UU 
returnWW 
OkWW 
(WW 
newWW 
RespuestasAPIWW +
<WW+ ,,
 UsuarioAutenticacionRespuestaDtoWW, L
>WWL M
{XX 
ResultYY 
=YY 
resultYY #
.YY# $
ValueYY$ )
}ZZ 
)ZZ 
;ZZ 
}[[ 
catch\\ 
(\\ 
	Exception\\ 
e\\ 
)\\ 
{]] 
return^^ 
HandleException^^ &
(^^& '
e^^' (
,^^( )
nameof^^* 0
(^^0 1
Validar^^1 8
)^^8 9
)^^9 :
;^^: ;
}__ 
}`` 	
[jj 	
AllowAnonymousjj	 
]jj 
[kk 	
HttpPostkk	 
(kk 
Routeskk 
.kk 
	RECUPERARkk "
)kk" #
]kk# $
publicll 
IActionResultll 
RecoverAsyncll )
(ll) *
[ll* +
FromBodyll+ 3
]ll3 4"
UsuarioRecuperacionDtoll5 K"
usuarioRecuperacionDtollL b
)llb c
{mm 	
trynn 
{oo 
varpp 
resultpp 
=pp 
_iServiceRecoverpp -
.pp- .
RecoverPasswordpp. =
(pp= >"
usuarioRecuperacionDtopp> T
)ppT U
;ppU V
ifrr 
(rr 
!rr 
resultrr 
.rr 
	IsSuccessrr %
)rr% &
{ss 
returntt 
BadRequestResponsett -
(tt- .
resulttt. 4
.tt4 5
ErrorMessagett5 A
)ttA B
;ttB C
}uu 
returnww 
Okww 
(ww 
newww 
RespuestasAPIww +
<ww+ ,
boolww, 0
>ww0 1
{xx 
Resultyy 
=yy 
resultyy #
.yy# $
Valueyy$ )
}zz 
)zz 
;zz 
}{{ 
catch|| 
(|| 
	Exception|| 
e|| 
)|| 
{}} 
return~~ 
HandleException~~ &
(~~& '
e~~' (
,~~( )
nameof~~* 0
(~~0 1
RecoverAsync~~1 =
)~~= >
)~~> ?
;~~? @
} 
}
ÄÄ 	
[
ãã 	
AllowAnonymous
ãã	 
]
ãã 
[
åå 	
HttpPost
åå	 
(
åå 
Routes
åå 
.
åå 
REGISTRO
åå !
)
åå! "
]
åå" #
public
çç 
IActionResult
çç 
Create
çç #
(
çç# $
[
çç$ %
FromBody
çç% -
]
çç- .

UsuarioDto
çç/ 9
dto
çç: =
)
çç= >
{
éé 	
try
èè 
{
êê 
bool
ëë 
validarEmailUnico
ëë &
=
ëë' (
_iUsuarioService
ëë) 9
.
ëë9 :
IsUniqueUser
ëë: F
(
ëëF G
dto
ëëG J
.
ëëJ K
Email
ëëK P
??
ëëQ S
$str
ëëT V
)
ëëV W
;
ëëW X
if
íí 
(
íí 
!
íí 
validarEmailUnico
íí &
)
íí& '
{
ìì 
return
îî  
BadRequestResponse
îî -
(
îî- .
$str
îî. N
)
îîN O
;
îîO P
}
ïï 
return
óó 
Ok
óó 
(
óó 
new
óó 
RespuestasAPI
óó +
<
óó+ ,
bool
óó, 0
>
óó0 1
{
òò 
	IsSuccess
ôô 
=
ôô 
_iUsuarioService
ôô  0
.
ôô0 1
Create
ôô1 7
(
ôô7 8
dto
ôô8 ;
)
ôô; <
}
öö 
)
öö 
;
öö 
}
õõ 
catch
úú 
(
úú 
	Exception
úú 
e
úú 
)
úú 
{
ùù 
return
ûû 
HandleException
ûû &
(
ûû& '
e
ûû' (
,
ûû( )
nameof
ûû* 0
(
ûû0 1
Create
ûû1 7
)
ûû7 8
)
ûû8 9
;
ûû9 :
}
üü 
}
†† 	
[
©© 	
	Authorize
©©	 
]
©© 
[
™™ 	
HttpGet
™™	 
]
™™ 
public
´´ 
IActionResult
´´ 
FindAll
´´ $
(
´´$ %
)
´´% &
{
¨¨ 	
try
≠≠ 
{
ÆÆ 
return
ØØ 
Ok
ØØ 
(
ØØ 
new
ØØ 
RespuestasAPI
ØØ +
<
ØØ+ ,
List
ØØ, 0
<
ØØ0 1

UsuarioDto
ØØ1 ;
>
ØØ; <
>
ØØ< =
{
∞∞ 
Result
±± 
=
±± 
_iUsuarioService
±± -
.
±±- .
FindAll
±±. 5
(
±±5 6
)
±±6 7
}
≤≤ 
)
≤≤ 
;
≤≤ 
}
≥≥ 
catch
¥¥ 
(
¥¥ 
	Exception
¥¥ 
e
¥¥ 
)
¥¥ 
{
µµ 
return
∂∂ 
HandleException
∂∂ &
(
∂∂& '
e
∂∂' (
,
∂∂( )
nameof
∂∂* 0
(
∂∂0 1
FindAll
∂∂1 8
)
∂∂8 9
)
∂∂9 :
;
∂∂: ;
}
∑∑ 
}
∏∏ 	
[
¬¬ 	
	Authorize
¬¬	 
]
¬¬ 
[
√√ 	
HttpGet
√√	 
(
√√ 
$str
√√ "
,
√√" #
Name
√√$ (
=
√√) *
$str
√√+ 5
)
√√5 6
]
√√6 7
public
ƒƒ 
IActionResult
ƒƒ 
FindById
ƒƒ %
(
ƒƒ% &
int
ƒƒ& )
	idUsuario
ƒƒ* 3
)
ƒƒ3 4
{
≈≈ 	
try
∆∆ 
{
«« 
var
»» 
itemUsuario
»» 
=
»»  !
_iUsuarioService
»»" 2
.
»»2 3
FindById
»»3 ;
(
»»; <
	idUsuario
»»< E
)
»»E F
;
»»F G
if
   
(
   
itemUsuario
   
==
    "
null
  # '
)
  ' (
{
ÀÀ 
return
ÃÃ 
NotFoundResponse
ÃÃ +
(
ÃÃ+ ,
$str
ÃÃ, C
)
ÃÃC D
;
ÃÃD E
}
ÕÕ 
return
œœ 
Ok
œœ 
(
œœ 
new
œœ 
RespuestasAPI
œœ +
<
œœ+ ,

UsuarioDto
œœ, 6
>
œœ6 7
{
–– 
Result
—— 
=
—— 
itemUsuario
—— (
}
““ 
)
““ 
;
““ 
}
”” 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘ 
e
‘‘ 
)
‘‘ 
{
’’ 
return
÷÷ 
HandleException
÷÷ &
(
÷÷& '
e
÷÷' (
,
÷÷( )
nameof
÷÷* 0
(
÷÷0 1
FindById
÷÷1 9
)
÷÷9 :
)
÷÷: ;
;
÷÷; <
}
◊◊ 
}
ÿÿ 	
[
‚‚ 	
	Authorize
‚‚	 
]
‚‚ 
[
„„ 	
HttpPut
„„	 
(
„„ 
$str
„„ "
,
„„" #
Name
„„$ (
=
„„) *
$str
„„+ 3
)
„„3 4
]
„„4 5
public
‰‰ 
IActionResult
‰‰ 
Update
‰‰ #
(
‰‰# $
int
‰‰$ '
	idUsuario
‰‰( 1
,
‰‰1 2
[
‰‰3 4
FromBody
‰‰4 <
]
‰‰< =

UsuarioDto
‰‰> H
dto
‰‰I L
)
‰‰L M
{
ÂÂ 	
try
ÊÊ 
{
ÁÁ 
dto
ËË 
.
ËË 
	IdUsuario
ËË 
=
ËË 
	idUsuario
ËË  )
;
ËË) *
return
ÈÈ 
Ok
ÈÈ 
(
ÈÈ 
new
ÈÈ 
RespuestasAPI
ÈÈ +
<
ÈÈ+ ,
bool
ÈÈ, 0
>
ÈÈ0 1
{
ÍÍ 
	IsSuccess
ÎÎ 
=
ÎÎ 
_iUsuarioService
ÎÎ  0
.
ÎÎ0 1
Update
ÎÎ1 7
(
ÎÎ7 8
dto
ÎÎ8 ;
)
ÎÎ; <
}
ÏÏ 
)
ÏÏ 
;
ÏÏ 
}
ÌÌ 
catch
ÓÓ 
(
ÓÓ 
	Exception
ÓÓ 
e
ÓÓ 
)
ÓÓ 
{
ÔÔ 
return
 
HandleException
 &
(
& '
e
' (
,
( )
nameof
* 0
(
0 1
Update
1 7
)
7 8
)
8 9
;
9 :
}
ÒÒ 
}
ÚÚ 	
[
¸¸ 	
	Authorize
¸¸	 
]
¸¸ 
[
˝˝ 	

HttpDelete
˝˝	 
(
˝˝ 
$str
˝˝ %
,
˝˝% &
Name
˝˝' +
=
˝˝, -
$str
˝˝. :
)
˝˝: ;
]
˝˝; <
public
˛˛ 
IActionResult
˛˛ 

Deactivate
˛˛ '
(
˛˛' (
int
˛˛( +
	idUsuario
˛˛, 5
)
˛˛5 6
{
ˇˇ 	
try
ÄÄ 
{
ÅÅ 
bool
ÇÇ 
response
ÇÇ 
=
ÇÇ 
_iUsuarioService
ÇÇ  0
.
ÇÇ0 1

Deactivate
ÇÇ1 ;
(
ÇÇ; <
	idUsuario
ÇÇ< E
)
ÇÇE F
;
ÇÇF G
if
ÉÉ 
(
ÉÉ 
!
ÉÉ 
response
ÉÉ 
)
ÉÉ 
{
ÑÑ 
return
ÖÖ 
NotFoundResponse
ÖÖ +
(
ÖÖ+ ,
$str
ÖÖ, F
)
ÖÖF G
;
ÖÖG H
}
ÜÜ 
return
àà 
Ok
àà 
(
àà 
new
àà 
RespuestasAPI
àà +
<
àà+ ,
bool
àà, 0
>
àà0 1
{
ââ 
	IsSuccess
ää 
=
ää 
response
ää  (
}
ãã 
)
ãã 
;
ãã 
}
åå 
catch
çç 
(
çç 
	Exception
çç 
e
çç 
)
çç 
{
éé 
return
èè 
HandleException
èè &
(
èè& '
e
èè' (
,
èè( )
nameof
èè* 0
(
èè0 1

Deactivate
èè1 ;
)
èè; <
)
èè< =
;
èè= >
}
êê 
}
ëë 	
[
öö 	
	Authorize
öö	 
]
öö 
[
õõ 	
HttpGet
õõ	 
(
õõ 
Routes
õõ 
.
õõ 
VALIDAR_EMAIL
õõ %
)
õõ% &
]
õõ& '
public
úú 
IActionResult
úú 
ValidarEmail
úú )
(
úú) *
[
úú* +
	FromQuery
úú+ 4
]
úú4 5
string
úú6 <
email
úú= B
)
úúB C
{
ùù 	
try
ûû 
{
üü 
bool
†† 
isUnique
†† 
=
†† 
_iUsuarioService
††  0
.
††0 1
IsUniqueUser
††1 =
(
††= >
email
††> C
)
††C D
;
††D E
return
°° 
Ok
°° 
(
°° 
isUnique
°° "
)
°°" #
;
°°# $
}
¢¢ 
catch
££ 
(
££ 
	Exception
££ 
e
££ 
)
££ 
{
§§ 
return
•• 
HandleException
•• &
(
••& '
e
••' (
,
••( )
nameof
••* 0
(
••0 1
ValidarEmail
••1 =
)
••= >
)
••> ?
;
••? @
}
¶¶ 
}
ßß 	
[
≠≠ 	
	Authorize
≠≠	 
]
≠≠ 
[
ÆÆ 	
HttpPost
ÆÆ	 
(
ÆÆ 
Routes
ÆÆ 
.
ÆÆ 
CAMBIAR_CLAVE
ÆÆ &
)
ÆÆ& '
]
ÆÆ' (
public
ØØ 
IActionResult
ØØ 
CambiarClave
ØØ )
(
ØØ) *
[
ØØ* +
FromBody
ØØ+ 3
]
ØØ3 4$
UsuarioCambiarClaveDto
ØØ5 K
usuario
ØØL S
)
ØØS T
{
∞∞ 	
try
±± 
{
≤≤ 
var
≥≥ 
result
≥≥ 
=
≥≥ 
_iUsuarioService
≥≥ -
.
≥≥- .
ChangePasswd
≥≥. :
(
≥≥: ;
usuario
≥≥; B
.
≥≥B C
Clave
≥≥C H
,
≥≥H I
usuario
≥≥J Q
.
≥≥Q R

ClaveNueva
≥≥R \
)
≥≥\ ]
;
≥≥] ^
if
µµ 
(
µµ 
!
µµ 
result
µµ 
.
µµ 
	IsSuccess
µµ %
)
µµ% &
{
∂∂ 
return
∑∑  
BadRequestResponse
∑∑ -
(
∑∑- .
result
∑∑. 4
.
∑∑4 5
ErrorMessage
∑∑5 A
)
∑∑A B
;
∑∑B C
}
∏∏ 
return
∫∫ 
Ok
∫∫ 
(
∫∫ 
new
∫∫ 
RespuestasAPI
∫∫ +
<
∫∫+ ,
bool
∫∫, 0
>
∫∫0 1
{
ªª 
Result
ºº 
=
ºº 
result
ºº #
.
ºº# $
Value
ºº$ )
}
ΩΩ 
)
ΩΩ 
;
ΩΩ 
}
ææ 
catch
øø 
(
øø 
	Exception
øø 
e
øø 
)
øø 
{
¿¿ 
return
¡¡ 
HandleException
¡¡ &
(
¡¡& '
e
¡¡' (
,
¡¡( )
nameof
¡¡* 0
(
¡¡0 1
Login
¡¡1 6
)
¡¡6 7
)
¡¡7 8
;
¡¡8 9
}
¬¬ 
}
√√ 	
}
ƒƒ 
}≈≈ Ê1
VC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\UsuarioEndpointController.cs
	namespace 	
WebApp
 
. 
Controllers 
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class %
UsuarioEndpointController *
:+ ,
BaseController- ;
{ 
private 
readonly "
IUsuarioEndpontService /"
_usuarioEndpontService0 F
;F G
private 
readonly 
IMapper  
_mapper! (
;( )
public %
UsuarioEndpointController (
(( )"
IUsuarioEndpontService) ?!
usuarioEndpontService@ U
,U V
IMapperW ^
mapper_ e
,e f
ILoggerg n
<n o&
UsuarioEndpointController	o à
>
à â
logger
ä ê
)
ê ë
:
í ì
base
î ò
(
ò ô
logger
ô ü
)
ü †
{ 	
this 
. "
_usuarioEndpontService '
=( )!
usuarioEndpontService* ?
;? @
this 
. 
_mapper 
= 
mapper !
;! "
} 	
[&& 	
	Authorize&&	 
]&& 
['' 	
HttpPost''	 
]'' 
public(( 
IActionResult(( 
Create(( #
(((# $
[(($ %
FromBody((% -
]((- .-
!UsuarioEndpointPermisoRegistroDto((/ P
data((Q U
)((U V
{)) 	
try** 
{++ 
return,, 
Ok,, 
(,, 
new,, 
RespuestasAPI,, +
<,,+ ,
bool,,, 0
>,,0 1
{-- 
	IsSuccess.. 
=.. "
_usuarioEndpontService..  6
...6 7
Create..7 =
(..= >
_mapper..> E
...E F
Map..F I
<..I J
UsuarioEndpoint..J Y
>..Y Z
(..Z [
data..[ _
).._ `
)..` a
}// 
)// 
;// 
}00 
catch11 
(11 
	Exception11 
e11 
)11 
{22 
return33 
HandleException33 &
(33& '
e33' (
,33( )
nameof33* 0
(330 1
Create331 7
)337 8
)338 9
;339 :
}44 
}55 	
[== 	
	Authorize==	 
]== 
[>> 	
HttpGet>>	 
]>> 
public?? 
IActionResult?? 
FindAll?? $
(??$ %
)??% &
{@@ 	
tryAA 
{BB 
returnCC 
OkCC 
(CC 
newCC 
RespuestasAPICC +
<CC+ ,
ListCC, 0
<CC0 1%
UsuarioEndpointPermisoDtoCC1 J
>CCJ K
>CCK L
{DD 
ResultEE 
=EE 
_mapperEE $
.EE$ %
MapEE% (
<EE( )
ListEE) -
<EE- .%
UsuarioEndpointPermisoDtoEE. G
>EEG H
>EEH I
(EEI J"
_usuarioEndpontServiceEEJ `
.EE` a
FindAllEEa h
(EEh i
)EEi j
)EEj k
}FF 
)FF 
;FF 
}GG 
catchHH 
(HH 
	ExceptionHH 
eHH 
)HH 
{II 
returnJJ 
HandleExceptionJJ &
(JJ& '
eJJ' (
,JJ( )
nameofJJ* 0
(JJ0 1
FindAllJJ1 8
)JJ8 9
)JJ9 :
;JJ: ;
}KK 
}LL 	
[VV 	
	AuthorizeVV	 
]VV 
[WW 	
HttpGetWW	 
(WW 
$strWW #
,WW# $
NameWW% )
=WW* +
$strWW, >
)WW> ?
]WW? @
publicXX 
IActionResultXX 
FindByEndpointIdXX -
(XX- .
intXX. 1

endpointIdXX2 <
)XX< =
{YY 	
tryZZ 
{[[ 
var\\ 
itemUsuario\\ 
=\\  !"
_usuarioEndpontService\\" 8
.\\8 9
FindByEndpointId\\9 I
(\\I J

endpointId\\J T
)\\T U
;\\U V
if^^ 
(^^ 
itemUsuario^^ 
==^^  "
null^^# '
)^^' (
{__ 
return`` 
NotFoundResponse`` +
(``+ ,

Constantes``, 6
.``6 7)
MESAGGE_REGISTRO_NO_ENCOTRADO``7 T
)``T U
;``U V
}aa 
returncc 
Okcc 
(cc 
newcc 
RespuestasAPIcc +
<cc+ ,

UsuarioDtocc, 6
>cc6 7
{dd 
Resultee 
=ee 
_mapperee $
.ee$ %
Mapee% (
<ee( )

UsuarioDtoee) 3
>ee3 4
(ee4 5
itemUsuarioee5 @
)ee@ A
}ff 
)ff 
;ff 
}gg 
catchhh 
(hh 
	Exceptionhh 
ehh 
)hh 
{ii 
returnjj 
HandleExceptionjj &
(jj& '
ejj' (
,jj( )
nameofjj* 0
(jj0 1
FindByEndpointIdjj1 A
)jjA B
)jjB C
;jjC D
}kk 
}ll 	
}nn 
}oo ÑE
PC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\ThesaurusController.cs
	namespace

 	
WebApp


 
.

 
Controllers

 
{ 
[ 
	Authorize 
] 
[ 
Route 

(
 
Routes 
. 
	THESAURUS 
) 
] 
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class 
ThesaurusController $
:% &
BaseController' 5
{ 
private 
readonly 
IThesaurusService *
_thesaurusService+ <
;< =
public 
ThesaurusController "
(" #
IThesaurusService# 4
thesaurusService5 E
,E F
ILoggerG N
<N O
ThesaurusControllerO b
>b c
loggerd j
)j k
:l m
basen r
(r s
loggers y
)y z
{ 	
this 
. 
_thesaurusService "
=# $
thesaurusService% 5
;5 6
} 	
[$$ 	
HttpGet$$	 
($$ 
Routes$$ 
.$$ 
GET_THESAURUS$$ %
)$$% &
]$$& '
public%% 
IActionResult%% 
ObtenerThesaurus%% -
(%%- .
)%%. /
{&& 	
try'' 
{(( 
return)) 
Ok)) 
()) 
new)) 
RespuestasAPI)) +
<))+ ,
ThesaurusDto)), 8
>))8 9
{** 
Result++ 
=++ 
_thesaurusService++ .
.++. /
ObtenerThesaurus++/ ?
(++? @
)++@ A
},, 
),, 
;,, 
}-- 
catch.. 
(.. 
	Exception.. 
e.. 
).. 
{// 
return00 
HandleException00 &
(00& '
e00' (
,00( )
nameof00* 0
(000 1
ObtenerThesaurus001 A
)00A B
)00B C
;00C D
}11 
}22 	
[;; 	
HttpPost;;	 
(;; 
Routes;; 
.;; 
THESAURUS_AGREGAR;; *
);;* +
];;+ ,
public<< 
IActionResult<< 
AgregarExpansion<< -
(<<- .
[<<. /
FromBody<</ 7
]<<7 8
List<<9 =
<<<= >
string<<> D
><<D E
	sinonimos<<F O
)<<O P
{== 	
try>> 
{?? 
return@@ 
Ok@@ 
(@@ 
new@@ 
RespuestasAPI@@ +
<@@+ ,
string@@, 2
>@@2 3
{AA 
ResultBB 
=BB 
_thesaurusServiceBB .
.BB. /
AgregarExpansionBB/ ?
(BB? @
	sinonimosBB@ I
)BBI J
}CC 
)CC 
;CC 
}DD 
catchEE 
(EE 
	ExceptionEE 
eEE 
)EE 
{FF 
returnGG 
HandleExceptionGG &
(GG& '
eGG' (
,GG( )
nameofGG* 0
(GG0 1
AgregarExpansionGG1 A
)GGA B
)GGB C
;GGC D
}HH 
}II 	
[RR 	
HttpPostRR	 
(RR 
RoutesRR 
.RR  
THESAURUS_ACTUALIZARRR -
)RR- .
]RR. /
publicSS 
IActionResultSS 
ActualizarExpansionSS 0
(SS0 1
[SS1 2
FromBodySS2 :
]SS: ;
ListSS< @
<SS@ A
ExpansionDtoSSA M
>SSM N

expansionsSSO Y
)SSY Z
{TT 	
tryUU 
{VV 
returnWW 
OkWW 
(WW 
newWW 
RespuestasAPIWW +
<WW+ ,
stringWW, 2
>WW2 3
{XX 
ResultYY 
=YY 
_thesaurusServiceYY .
.YY. /
ActualizarExpansionYY/ B
(YYB C

expansionsYYC M
)YYM N
}ZZ 
)ZZ 
;ZZ 
}[[ 
catch\\ 
(\\ 
	Exception\\ 
e\\ 
)\\ 
{]] 
return^^ 
HandleException^^ &
(^^& '
e^^' (
,^^( )
nameof^^* 0
(^^0 1
ActualizarExpansion^^1 D
)^^D E
)^^E F
;^^F G
}__ 
}`` 	
[jj 	
HttpGetjj	 
(jj 
Routesjj 
.jj !
THESAURUS_AGREGAR_SUBjj -
)jj- .
]jj. /
publickk 
IActionResultkk 
AgregarSubExpansionkk 0
(kk0 1
[kk1 2
	FromRoutekk2 ;
]kk; <
stringkk= C
expansionExistentekkD V
,kkV W
stringkkX ^
nuevoSubkk_ g
)kkg h
{ll 	
trymm 
{nn 
returnoo 
Okoo 
(oo 
newoo 
RespuestasAPIoo +
<oo+ ,
stringoo, 2
>oo2 3
{pp 
Resultqq 
=qq 
_thesaurusServiceqq .
.qq. / 
AgregarSubAExpansionqq/ C
(qqC D
expansionExistenteqqD V
,qqV W
nuevoSubqqX `
)qq` a
}rr 
)rr 
;rr 
}ss 
catchtt 
(tt 
	Exceptiontt 
ett 
)tt 
{uu 
returnvv 
HandleExceptionvv &
(vv& '
evv' (
,vv( )
nameofvv* 0
(vv0 1
AgregarSubExpansionvv1 D
)vvD E
)vvE F
;vvF G
}ww 
}xx 	
[
ÅÅ 	
HttpGet
ÅÅ	 
(
ÅÅ 
Routes
ÅÅ 
.
ÅÅ  
THESAURUS_EJECUTAR
ÅÅ *
)
ÅÅ* +
]
ÅÅ+ ,
public
ÇÇ 
IActionResult
ÇÇ 
EjecutarBat
ÇÇ (
(
ÇÇ( )
)
ÇÇ) *
{
ÉÉ 	
try
ÑÑ 
{
ÖÖ 
return
ÜÜ 
Ok
ÜÜ 
(
ÜÜ 
new
ÜÜ 
RespuestasAPI
ÜÜ +
<
ÜÜ+ ,
string
ÜÜ, 2
>
ÜÜ2 3
{
áá 
Result
àà 
=
àà 
_thesaurusService
àà .
.
àà. / 
EjecutarArchivoBat
àà/ A
(
ààA B
)
ààB C
}
ââ 
)
ââ 
;
ââ 
}
ää 
catch
ãã 
(
ãã 
	Exception
ãã 
e
ãã 
)
ãã 
{
åå 
return
çç 
HandleException
çç &
(
çç& '
e
çç' (
,
çç( )
nameof
çç* 0
(
çç0 1
EjecutarBat
çç1 <
)
çç< =
)
çç= >
;
çç> ?
}
éé 
}
èè 	
[
òò 	
HttpGet
òò	 
(
òò 
Routes
òò 
.
òò 
THESAURUS_RESET
òò '
)
òò' (
]
òò( )
public
ôô 
IActionResult
ôô 
ResetSQLServer
ôô +
(
ôô+ ,
)
ôô, -
{
öö 	
try
õõ 
{
úú 
return
ùù 
Ok
ùù 
(
ùù 
new
ùù 
RespuestasAPI
ùù +
<
ùù+ ,
string
ùù, 2
>
ùù2 3
{
ûû 
Result
üü 
=
üü 
_thesaurusService
üü .
.
üü. /
ResetSQLServer
üü/ =
(
üü= >
)
üü> ?
}
†† 
)
†† 
;
†† 
}
°° 
catch
¢¢ 
(
¢¢ 
	Exception
¢¢ 
e
¢¢ 
)
¢¢ 
{
££ 
return
§§ 
HandleException
§§ &
(
§§& '
e
§§' (
,
§§( )
nameof
§§* 0
(
§§0 1
ResetSQLServer
§§1 ?
)
§§? @
)
§§@ A
;
§§A B
}
•• 
}
¶¶ 	
}
®® 
}©© àÀ
NC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\ReporteController.cs
	namespace		 	
WebApp		
 
.		 
Controllers		 
{

 
[ 
Route 

(
 
Routes 
. 
REPORTES_VISTA  
)  !
]! "
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class 
ReporteController "
:# $
BaseController% 3
{ 
private 
readonly 
IReporteService (
_reporteService) 8
;8 9
public 
ReporteController  
(  !
IReporteService! 0
reporteService1 ?
,? @
ILoggerA H
<H I
ReporteControllerI Z
>Z [
logger\ b
)b c
:d e
basef j
(j k
loggerk q
)q r
{ 	
this 
. 
_reporteService  
=! "
reporteService# 1
;1 2
} 	
["" 	
	Authorize""	 
]"" 
[## 	
HttpGet##	 
(## 
Routes## 
.## 
FIND_BY_VISTA## %
)##% &
]##& '
public$$ 
IActionResult$$ 
findByVista$$ (
($$( )
string$$) /
codigoHomologacion$$0 B
)$$B C
{%% 	
try&& 
{'' 
var(( 
homologacion((  
=((! "
_reporteService((# 2
.((2 3
findByVista((3 >
(((> ?
codigoHomologacion((? Q
)((Q R
;((R S
if** 
(** 
homologacion**  
==**! #
null**$ (
)**( )
{++ 
return,, 
NotFound,, #
(,,# $
new,,$ '
RespuestasAPI,,( 5
<,,5 6
VwHomologacionDto,,6 G
>,,G H
{-- 
Result.. 
=..  
new..! $
VwHomologacionDto..% 6
(..6 7
)..7 8
}// 
)// 
;// 
}00 
var22 
homologacionDto22 #
=22$ %
homologacion22& 2
;222 3
return44 
Ok44 
(44 
new44 
RespuestasAPI44 +
<44+ ,
VwHomologacionDto44, =
>44= >
{55 
Result66 
=66 
homologacionDto66 ,
}77 
)77 
;77 
}88 
catch99 
(99 
	Exception99 
e99 
)99 
{:: 
return;; 
HandleException;; &
(;;& '
e;;' (
,;;( )
nameof;;* 0
(;;0 1
findByVista;;1 <
);;< =
);;= >
;;;> ?
}<< 
}== 	
[EE 	
	AuthorizeEE	 
]EE 
[FF 	
HttpGetFF	 
(FF 
RoutesFF 
.FF 
ACREDITACION_ONAFF (
)FF( )
]FF) *
publicGG 
IActionResultGG "
ObtenerAcreditacionOnaGG 3
(GG3 4
)GG4 5
{HH 	
tryII 
{JJ 
returnKK 
OkKK 
(KK 
newKK 
RespuestasAPIKK +
<KK+ ,
ListKK, 0
<KK0 1 
VwAcreditacionOnaDtoKK1 E
>KKE F
>KKF G
{LL 
ResultMM 
=MM 
_reporteServiceMM ,
.MM, -$
ObtenerVwAcreditacionOnaMM- E
(MME F
)MMF G
}NN 
)NN 
;NN 
}OO 
catchPP 
(PP 
	ExceptionPP 
ePP 
)PP 
{QQ 
returnRR 
HandleExceptionRR &
(RR& '
eRR' (
,RR( )
nameofRR* 0
(RR0 1"
ObtenerAcreditacionOnaRR1 G
)RRG H
)RRH I
;RRI J
}SS 
}TT 	
[\\ 	
	Authorize\\	 
]\\ 
[]] 	
HttpGet]]	 
(]] 
Routes]] 
.]]  
ACREDITACION_ESQUEMA]] ,
)]], -
]]]- .
public^^ 
IActionResult^^ &
ObtenerAcreditacionEsquema^^ 7
(^^7 8
)^^8 9
{__ 	
try`` 
{aa 
returnbb 
Okbb 
(bb 
newbb 
RespuestasAPIbb +
<bb+ ,
Listbb, 0
<bb0 1$
VwAcreditacionEsquemaDtobb1 I
>bbI J
>bbJ K
{cc 
Resultdd 
=dd 
_reporteServicedd ,
.dd, -(
ObtenerVwAcreditacionEsquemadd- I
(ddI J
)ddJ K
}ee 
)ee 
;ee 
}ff 
catchgg 
(gg 
	Exceptiongg 
egg 
)gg 
{hh 
returnii 
HandleExceptionii &
(ii& '
eii' (
,ii( )
nameofii* 0
(ii0 1&
ObtenerAcreditacionEsquemaii1 K
)iiK L
)iiL M
;iiM N
}jj 
}kk 	
[ss 	
	Authorizess	 
]ss 
[tt 	
HttpGettt	 
(tt 
Routestt 
.tt 
ESTADO_ESQUEMAtt &
)tt& '
]tt' (
publicuu 
IActionResultuu  
ObtenerEstadoEsquemauu 1
(uu1 2
)uu2 3
{vv 	
tryww 
{xx 
returnyy 
Okyy 
(yy 
newyy 
RespuestasAPIyy +
<yy+ ,
Listyy, 0
<yy0 1
VwEstadoEsquemaDtoyy1 C
>yyC D
>yyD E
{zz 
Result{{ 
={{ 
_reporteService{{ ,
.{{, -"
ObtenerVwEstadoEsquema{{- C
({{C D
){{D E
}|| 
)|| 
;|| 
}}} 
catch~~ 
(~~ 
	Exception~~ 
e~~ 
)~~ 
{ 
return
ÄÄ 
HandleException
ÄÄ &
(
ÄÄ& '
e
ÄÄ' (
,
ÄÄ( )
nameof
ÄÄ* 0
(
ÄÄ0 1"
ObtenerEstadoEsquema
ÄÄ1 E
)
ÄÄE F
)
ÄÄF G
;
ÄÄG H
}
ÅÅ 
}
ÇÇ 	
[
ää 	
	Authorize
ää	 
]
ää 
[
ãã 	
HttpGet
ãã	 
(
ãã 
Routes
ãã 
.
ãã 
OEC_PAIS
ãã  
)
ãã  !
]
ãã! "
public
åå 
IActionResult
åå 
ObtenerOecPais
åå +
(
åå+ ,
)
åå, -
{
çç 	
try
éé 
{
èè 
return
êê 
Ok
êê 
(
êê 
new
êê 
RespuestasAPI
êê +
<
êê+ ,
List
êê, 0
<
êê0 1
VwOecPaisDto
êê1 =
>
êê= >
>
êê> ?
{
ëë 
Result
íí 
=
íí 
_reporteService
íí ,
.
íí, -
ObtenerVwOecPais
íí- =
(
íí= >
)
íí> ?
}
ìì 
)
ìì 
;
ìì 
}
îî 
catch
ïï 
(
ïï 
	Exception
ïï 
e
ïï 
)
ïï 
{
ññ 
return
óó 
HandleException
óó &
(
óó& '
e
óó' (
,
óó( )
nameof
óó* 0
(
óó0 1
ObtenerOecPais
óó1 ?
)
óó? @
)
óó@ A
;
óóA B
}
òò 
}
ôô 	
[
°° 	
	Authorize
°°	 
]
°° 
[
¢¢ 	
HttpGet
¢¢	 
(
¢¢ 
Routes
¢¢ 
.
¢¢ 
ESQUEMA_PAIS
¢¢ $
)
¢¢$ %
]
¢¢% &
public
££ 
IActionResult
££  
ObtenerEsquemaPais
££ /
(
££/ 0
)
££0 1
{
§§ 	
try
•• 
{
¶¶ 
return
ßß 
Ok
ßß 
(
ßß 
new
ßß 
RespuestasAPI
ßß +
<
ßß+ ,
List
ßß, 0
<
ßß0 1
VwEsquemaPaisDto
ßß1 A
>
ßßA B
>
ßßB C
{
®® 
Result
©© 
=
©© 
_reporteService
©© ,
.
©©, -"
ObtenerVwEsquemaPais
©©- A
(
©©A B
)
©©B C
}
™™ 
)
™™ 
;
™™ 
}
´´ 
catch
¨¨ 
(
¨¨ 
	Exception
¨¨ 
e
¨¨ 
)
¨¨ 
{
≠≠ 
return
ÆÆ 
HandleException
ÆÆ &
(
ÆÆ& '
e
ÆÆ' (
,
ÆÆ( )
nameof
ÆÆ* 0
(
ÆÆ0 1 
ObtenerEsquemaPais
ÆÆ1 C
)
ÆÆC D
)
ÆÆD E
;
ÆÆE F
}
ØØ 
}
∞∞ 	
[
∏∏ 	
	Authorize
∏∏	 
]
∏∏ 
[
ππ 	
HttpGet
ππ	 
(
ππ 
Routes
ππ 
.
ππ 
	OEC_FECHA
ππ !
)
ππ! "
]
ππ" #
public
∫∫ 
IActionResult
∫∫ 
ObtenerOecFecha
∫∫ ,
(
∫∫, -
)
∫∫- .
{
ªª 	
try
ºº 
{
ΩΩ 
return
ææ 
Ok
ææ 
(
ææ 
new
ææ 
RespuestasAPI
ææ +
<
ææ+ ,
List
ææ, 0
<
ææ0 1
VwOecFechaDto
ææ1 >
>
ææ> ?
>
ææ? @
{
øø 
Result
¿¿ 
=
¿¿ 
_reporteService
¿¿ ,
.
¿¿, -
ObtenerVwOecFecha
¿¿- >
(
¿¿> ?
)
¿¿? @
}
¡¡ 
)
¡¡ 
;
¡¡ 
}
¬¬ 
catch
√√ 
(
√√ 
	Exception
√√ 
e
√√ 
)
√√ 
{
ƒƒ 
return
≈≈ 
HandleException
≈≈ &
(
≈≈& '
e
≈≈' (
,
≈≈( )
nameof
≈≈* 0
(
≈≈0 1
ObtenerOecFecha
≈≈1 @
)
≈≈@ A
)
≈≈A B
;
≈≈B C
}
∆∆ 
}
«« 	
[
–– 	
	Authorize
––	 
]
–– 
[
—— 	
HttpGet
——	 
(
—— 
Routes
—— 
.
—— $
PROFESIONAL_CALIFICADO
—— .
)
——. /
]
——/ 0
public
““ 
IActionResult
““ *
ObtenerProfesionalCalificado
““ 9
(
““9 :
)
““: ;
{
”” 	
try
‘‘ 
{
’’ 
return
÷÷ 
Ok
÷÷ 
(
÷÷ 
new
÷÷ 
RespuestasAPI
÷÷ +
<
÷÷+ ,
List
÷÷, 0
<
÷÷0 1(
VwProfesionalCalificadoDto
÷÷1 K
>
÷÷K L
>
÷÷L M
{
◊◊ 
Result
ÿÿ 
=
ÿÿ 
_reporteService
ÿÿ ,
.
ÿÿ, -,
ObtenerVwProfesionalCalificado
ÿÿ- K
(
ÿÿK L
)
ÿÿL M
}
ŸŸ 
)
ŸŸ 
;
ŸŸ 
}
⁄⁄ 
catch
€€ 
(
€€ 
	Exception
€€ 
e
€€ 
)
€€ 
{
‹‹ 
return
›› 
HandleException
›› &
(
››& '
e
››' (
,
››( )
nameof
››* 0
(
››0 1*
ObtenerProfesionalCalificado
››1 M
)
››M N
)
››N O
;
››O P
}
ﬁﬁ 
}
ﬂﬂ 	
[
ÁÁ 	
	Authorize
ÁÁ	 
]
ÁÁ 
[
ËË 	
HttpGet
ËË	 
(
ËË 
Routes
ËË 
.
ËË 
PROFESIONAL_ONA
ËË '
)
ËË' (
]
ËË( )
public
ÈÈ 
IActionResult
ÈÈ #
ObtenerProfesionalOna
ÈÈ 2
(
ÈÈ2 3
)
ÈÈ3 4
{
ÍÍ 	
try
ÎÎ 
{
ÏÏ 
return
ÌÌ 
Ok
ÌÌ 
(
ÌÌ 
new
ÌÌ 
RespuestasAPI
ÌÌ +
<
ÌÌ+ ,
List
ÌÌ, 0
<
ÌÌ0 1!
VwProfesionalOnaDto
ÌÌ1 D
>
ÌÌD E
>
ÌÌE F
{
ÓÓ 
Result
ÔÔ 
=
ÔÔ 
_reporteService
ÔÔ ,
.
ÔÔ, -%
ObtenerVwProfesionalOna
ÔÔ- D
(
ÔÔD E
)
ÔÔE F
}
 
)
 
;
 
}
ÒÒ 
catch
ÚÚ 
(
ÚÚ 
	Exception
ÚÚ 
e
ÚÚ 
)
ÚÚ 
{
ÛÛ 
return
ÙÙ 
HandleException
ÙÙ &
(
ÙÙ& '
e
ÙÙ' (
,
ÙÙ( )
nameof
ÙÙ* 0
(
ÙÙ0 1#
ObtenerProfesionalOna
ÙÙ1 F
)
ÙÙF G
)
ÙÙG H
;
ÙÙH I
}
ıı 
}
ˆˆ 	
[
˛˛ 	
	Authorize
˛˛	 
]
˛˛ 
[
ˇˇ 	
HttpGet
ˇˇ	 
(
ˇˇ 
Routes
ˇˇ 
.
ˇˇ !
PROFESIONAL_ESQUEMA
ˇˇ +
)
ˇˇ+ ,
]
ˇˇ, -
public
ÄÄ 
IActionResult
ÄÄ '
ObtenerProfesionalEsquema
ÄÄ 6
(
ÄÄ6 7
)
ÄÄ7 8
{
ÅÅ 	
try
ÇÇ 
{
ÉÉ 
return
ÑÑ 
Ok
ÑÑ 
(
ÑÑ 
new
ÑÑ 
RespuestasAPI
ÑÑ +
<
ÑÑ+ ,
List
ÑÑ, 0
<
ÑÑ0 1%
VwProfesionalEsquemaDto
ÑÑ1 H
>
ÑÑH I
>
ÑÑI J
{
ÖÖ 
Result
ÜÜ 
=
ÜÜ 
_reporteService
ÜÜ ,
.
ÜÜ, -)
ObtenerVwProfesionalEsquema
ÜÜ- H
(
ÜÜH I
)
ÜÜI J
}
áá 
)
áá 
;
áá 
}
àà 
catch
ââ 
(
ââ 
	Exception
ââ 
e
ââ 
)
ââ 
{
ää 
return
ãã 
HandleException
ãã &
(
ãã& '
e
ãã' (
,
ãã( )
nameof
ãã* 0
(
ãã0 1'
ObtenerProfesionalEsquema
ãã1 J
)
ããJ K
)
ããK L
;
ããL M
}
åå 
}
çç 	
[
ïï 	
	Authorize
ïï	 
]
ïï 
[
ññ 	
HttpGet
ññ	 
(
ññ 
Routes
ññ 
.
ññ 
PROFESIONAL_FECHA
ññ )
)
ññ) *
]
ññ* +
public
óó 
IActionResult
óó %
ObtenerProfesionalFecha
óó 4
(
óó4 5
)
óó5 6
{
òò 	
try
ôô 
{
öö 
return
õõ 
Ok
õõ 
(
õõ 
new
õõ 
RespuestasAPI
õõ +
<
õõ+ ,
List
õõ, 0
<
õõ0 1#
VwProfesionalFechaDto
õõ1 F
>
õõF G
>
õõG H
{
úú 
Result
ùù 
=
ùù 
_reporteService
ùù ,
.
ùù, -'
ObtenerVwProfesionalFecha
ùù- F
(
ùùF G
)
ùùG H
}
ûû 
)
ûû 
;
ûû 
}
üü 
catch
†† 
(
†† 
	Exception
†† 
e
†† 
)
†† 
{
°° 
return
¢¢ 
HandleException
¢¢ &
(
¢¢& '
e
¢¢' (
,
¢¢( )
nameof
¢¢* 0
(
¢¢0 1%
ObtenerProfesionalFecha
¢¢1 H
)
¢¢H I
)
¢¢I J
;
¢¢J K
}
££ 
}
§§ 	
[
¨¨ 	
	Authorize
¨¨	 
]
¨¨ 
[
≠≠ 	
HttpGet
≠≠	 
(
≠≠ 
Routes
≠≠ 
.
≠≠  
CALIFICA_UBICACION
≠≠ *
)
≠≠* +
]
≠≠+ ,
public
ÆÆ 
IActionResult
ÆÆ &
ObtenerCalificaUbicacion
ÆÆ 5
(
ÆÆ5 6
)
ÆÆ6 7
{
ØØ 	
try
∞∞ 
{
±± 
return
≤≤ 
Ok
≤≤ 
(
≤≤ 
new
≤≤ 
RespuestasAPI
≤≤ +
<
≤≤+ ,
List
≤≤, 0
<
≤≤0 1$
VwCalificaUbicacionDto
≤≤1 G
>
≤≤G H
>
≤≤H I
{
≥≥ 
Result
¥¥ 
=
¥¥ 
_reporteService
¥¥ ,
.
¥¥, -(
ObtenerVwCalificaUbicacion
¥¥- G
(
¥¥G H
)
¥¥H I
}
µµ 
)
µµ 
;
µµ 
}
∂∂ 
catch
∑∑ 
(
∑∑ 
	Exception
∑∑ 
e
∑∑ 
)
∑∑ 
{
∏∏ 
return
ππ 
HandleException
ππ &
(
ππ& '
e
ππ' (
,
ππ( )
nameof
ππ* 0
(
ππ0 1&
ObtenerCalificaUbicacion
ππ1 I
)
ππI J
)
ππJ K
;
ππK L
}
∫∫ 
}
ªª 	
[
√√ 	
	Authorize
√√	 
]
√√ 
[
ƒƒ 	
HttpGet
ƒƒ	 
(
ƒƒ 
Routes
ƒƒ 
.
ƒƒ 
BUSQUEDA_FECHA
ƒƒ &
)
ƒƒ& '
]
ƒƒ' (
public
≈≈ 
IActionResult
≈≈ "
ObtenerBusquedaFecha
≈≈ 1
(
≈≈1 2
)
≈≈2 3
{
∆∆ 	
try
«« 
{
»» 
return
…… 
Ok
…… 
(
…… 
new
…… 
RespuestasAPI
…… +
<
……+ ,
List
……, 0
<
……0 1 
VwBusquedaFechaDto
……1 C
>
……C D
>
……D E
{
   
Result
ÀÀ 
=
ÀÀ 
_reporteService
ÀÀ ,
.
ÀÀ, -$
ObtenerVwBusquedaFecha
ÀÀ- C
(
ÀÀC D
)
ÀÀD E
}
ÃÃ 
)
ÃÃ 
;
ÃÃ 
}
ÕÕ 
catch
ŒŒ 
(
ŒŒ 
	Exception
ŒŒ 
e
ŒŒ 
)
ŒŒ 
{
œœ 
return
–– 
HandleException
–– &
(
––& '
e
––' (
,
––( )
nameof
––* 0
(
––0 1"
ObtenerBusquedaFecha
––1 E
)
––E F
)
––F G
;
––G H
}
—— 
}
““ 	
[
⁄⁄ 	
	Authorize
⁄⁄	 
]
⁄⁄ 
[
€€ 	
HttpGet
€€	 
(
€€ 
Routes
€€ 
.
€€ 
BUSQUEDA_FILTRO
€€ '
)
€€' (
]
€€( )
public
‹‹ 
IActionResult
‹‹ #
ObtenerBusquedaFiltro
‹‹ 2
(
‹‹2 3
)
‹‹3 4
{
›› 	
try
ﬁﬁ 
{
ﬂﬂ 
return
‡‡ 
Ok
‡‡ 
(
‡‡ 
new
‡‡ 
RespuestasAPI
‡‡ +
<
‡‡+ ,
List
‡‡, 0
<
‡‡0 1!
VwBusquedaFiltroDto
‡‡1 D
>
‡‡D E
>
‡‡E F
{
·· 
Result
‚‚ 
=
‚‚ 
_reporteService
‚‚ ,
.
‚‚, -%
ObtenerVwBusquedaFiltro
‚‚- D
(
‚‚D E
)
‚‚E F
}
„„ 
)
„„ 
;
„„ 
}
‰‰ 
catch
ÂÂ 
(
ÂÂ 
	Exception
ÂÂ 
e
ÂÂ 
)
ÂÂ 
{
ÊÊ 
return
ÁÁ 
HandleException
ÁÁ &
(
ÁÁ& '
e
ÁÁ' (
,
ÁÁ( )
nameof
ÁÁ* 0
(
ÁÁ0 1#
ObtenerBusquedaFiltro
ÁÁ1 F
)
ÁÁF G
)
ÁÁG H
;
ÁÁH I
}
ËË 
}
ÈÈ 	
[
ÒÒ 	
	Authorize
ÒÒ	 
]
ÒÒ 
[
ÚÚ 	
HttpGet
ÚÚ	 
(
ÚÚ 
Routes
ÚÚ 
.
ÚÚ  
BUSQUEDA_UBICACION
ÚÚ *
)
ÚÚ* +
]
ÚÚ+ ,
public
ÛÛ 
IActionResult
ÛÛ &
ObtenerBusquedaUbicacion
ÛÛ 5
(
ÛÛ5 6
)
ÛÛ6 7
{
ÙÙ 	
try
ıı 
{
ˆˆ 
return
˜˜ 
Ok
˜˜ 
(
˜˜ 
new
˜˜ 
RespuestasAPI
˜˜ +
<
˜˜+ ,
List
˜˜, 0
<
˜˜0 1$
VwBusquedaUbicacionDto
˜˜1 G
>
˜˜G H
>
˜˜H I
{
¯¯ 
Result
˘˘ 
=
˘˘ 
_reporteService
˘˘ ,
.
˘˘, -(
ObtenerVwBusquedaUbicacion
˘˘- G
(
˘˘G H
)
˘˘H I
}
˙˙ 
)
˙˙ 
;
˙˙ 
}
˚˚ 
catch
¸¸ 
(
¸¸ 
	Exception
¸¸ 
e
¸¸ 
)
¸¸ 
{
˝˝ 
return
˛˛ 
HandleException
˛˛ &
(
˛˛& '
e
˛˛' (
,
˛˛( )
nameof
˛˛* 0
(
˛˛0 1&
ObtenerBusquedaUbicacion
˛˛1 I
)
˛˛I J
)
˛˛J K
;
˛˛K L
}
ˇˇ 
}
ÄÄ 	
[
àà 	
	Authorize
àà	 
]
àà 
[
ââ 	
HttpGet
ââ	 
(
ââ 
Routes
ââ 
.
ââ 
ACTUALIZACION_ONA
ââ )
)
ââ) *
]
ââ* +
public
ää 
IActionResult
ää %
ObtenerActualizacionONA
ää 4
(
ää4 5
)
ää5 6
{
ãã 	
try
åå 
{
çç 
return
éé 
Ok
éé 
(
éé 
new
éé 
RespuestasAPI
éé +
<
éé+ ,
List
éé, 0
<
éé0 1#
VwActualizacionONADto
éé1 F
>
ééF G
>
ééG H
{
èè 
Result
êê 
=
êê 
_reporteService
êê ,
.
êê, -'
ObtenerVwActualizacionONA
êê- F
(
êêF G
)
êêG H
}
ëë 
)
ëë 
;
ëë 
}
íí 
catch
ìì 
(
ìì 
	Exception
ìì 
e
ìì 
)
ìì 
{
îî 
return
ïï 
HandleException
ïï &
(
ïï& '
e
ïï' (
,
ïï( )
nameof
ïï* 0
(
ïï0 1%
ObtenerActualizacionONA
ïï1 H
)
ïïH I
)
ïïI J
;
ïïJ K
}
ññ 
}
óó 	
[
üü 	
	Authorize
üü	 
]
üü 
[
†† 	
HttpGet
††	 
(
†† 
Routes
†† 
.
†† "
ORGANISMO_REGISTRADO
†† ,
)
††, -
]
††- .
public
°° 
IActionResult
°° (
ObtenerOrganismoRegistrado
°° 7
(
°°7 8
)
°°8 9
{
¢¢ 	
try
££ 
{
§§ 
return
•• 
Ok
•• 
(
•• 
new
•• 
RespuestasAPI
•• +
<
••+ ,
List
••, 0
<
••0 1&
VwOrganismoRegistradoDto
••1 I
>
••I J
>
••J K
{
¶¶ 
Result
ßß 
=
ßß 
_reporteService
ßß ,
.
ßß, -*
ObtenerVwOrganismoRegistrado
ßß- I
(
ßßI J
)
ßßJ K
}
®® 
)
®® 
;
®® 
}
©© 
catch
™™ 
(
™™ 
	Exception
™™ 
e
™™ 
)
™™ 
{
´´ 
return
¨¨ 
HandleException
¨¨ &
(
¨¨& '
e
¨¨' (
,
¨¨( )
nameof
¨¨* 0
(
¨¨0 1(
ObtenerOrganismoRegistrado
¨¨1 K
)
¨¨K L
)
¨¨L M
;
¨¨M N
}
≠≠ 
}
ÆÆ 	
[
∂∂ 	
	Authorize
∂∂	 
]
∂∂ 
[
∑∑ 	
HttpGet
∑∑	 
(
∑∑ 
Routes
∑∑ 
.
∑∑ 
ORGANISMO_ESQUEMA
∑∑ )
)
∑∑) *
]
∑∑* +
public
∏∏ 
IActionResult
∏∏ (
ObtenerOrganizacionEsquema
∏∏ 7
(
∏∏7 8
)
∏∏8 9
{
ππ 	
try
∫∫ 
{
ªª 
return
ºº 
Ok
ºº 
(
ºº 
new
ºº 
RespuestasAPI
ºº +
<
ºº+ ,
List
ºº, 0
<
ºº0 1&
VwOrganizacionEsquemaDto
ºº1 I
>
ººI J
>
ººJ K
{
ΩΩ 
Result
ææ 
=
ææ 
_reporteService
ææ ,
.
ææ, -*
ObtenerVwOrganizacionEsquema
ææ- I
(
ææI J
)
ææJ K
}
øø 
)
øø 
;
øø 
}
¿¿ 
catch
¡¡ 
(
¡¡ 
	Exception
¡¡ 
e
¡¡ 
)
¡¡ 
{
¬¬ 
return
√√ 
HandleException
√√ &
(
√√& '
e
√√' (
,
√√( )
nameof
√√* 0
(
√√0 1(
ObtenerOrganizacionEsquema
√√1 K
)
√√K L
)
√√L M
;
√√M N
}
ƒƒ 
}
≈≈ 	
[
ÕÕ 	
	Authorize
ÕÕ	 
]
ÕÕ 
[
ŒŒ 	
HttpGet
ŒŒ	 
(
ŒŒ 
Routes
ŒŒ 
.
ŒŒ !
ORGANISMO_ACTIVIDAD
ŒŒ +
)
ŒŒ+ ,
]
ŒŒ, -
public
œœ 
IActionResult
œœ '
ObtenerOrganismoActividad
œœ 6
(
œœ6 7
)
œœ7 8
{
–– 	
try
—— 
{
““ 
return
”” 
Ok
”” 
(
”” 
new
”” 
RespuestasAPI
”” +
<
””+ ,
List
””, 0
<
””0 1%
VwOrganismoActividadDto
””1 H
>
””H I
>
””I J
{
‘‘ 
Result
’’ 
=
’’ 
_reporteService
’’ ,
.
’’, -)
ObtenerVwOrganismoActividad
’’- H
(
’’H I
)
’’I J
}
÷÷ 
)
÷÷ 
;
÷÷ 
}
◊◊ 
catch
ÿÿ 
(
ÿÿ 
	Exception
ÿÿ 
e
ÿÿ 
)
ÿÿ 
{
ŸŸ 
return
⁄⁄ 
HandleException
⁄⁄ &
(
⁄⁄& '
e
⁄⁄' (
,
⁄⁄( )
nameof
⁄⁄* 0
(
⁄⁄0 1'
ObtenerOrganismoActividad
⁄⁄1 J
)
⁄⁄J K
)
⁄⁄K L
;
⁄⁄L M
}
€€ 
}
‹‹ 	
}
›› 
}ﬁﬁ ∫c
KC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\ONAsController.cs
	namespace 	
WebApp
 
. 
Controllers 
{ 
[ 
Route 

(
 
Routes 
. 
ONA 
) 
] 
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class 
ONAsController 
:  !
BaseController" 0
{ 
private 
readonly 
IONAService $
_oNAService% 0
;0 1
private 
readonly 
IMapper  
_mapper! (
;( )
public 
ONAsController 
( 
IONAService )

oNAService* 4
,4 5
IMapper6 =
mapper> D
,D E
ILoggerF M
<M N
BaseControllerN \
>\ ]
logger^ d
)d e
:f g
baseh l
(l m
loggerm s
)s t
{ 	
this 
. 
_oNAService 
= 

oNAService )
;) *
this 
. 
_mapper 
= 
mapper !
;! "
} 	
['' 	
HttpGet''	 
]'' 
public(( 
IActionResult(( 
FindAll(( $
((($ %
)((% &
{)) 	
try** 
{++ 
return,, 
Ok,, 
(,, 
new,, 
RespuestasAPI,, +
<,,+ ,
List,,, 0
<,,0 1
OnaDto,,1 7
>,,7 8
>,,8 9
{-- 
Result.. 
=.. 
_oNAService.. (
...( )
FindAll..) 0
(..0 1
)..1 2
...2 3
Select..3 9
(..9 :
item..: >
=>..? A
_mapper..B I
...I J
Map..J M
<..M N
OnaDto..N T
>..T U
(..U V
item..V Z
)..Z [
)..[ \
...\ ]
ToList..] c
(..c d
)..d e
}// 
)// 
;// 
}00 
catch11 
(11 
	Exception11 
e11 
)11 
{22 
return33 
HandleException33 &
(33& '
e33' (
,33( )
nameof33* 0
(330 1
FindAll331 8
)338 9
)339 :
;33: ;
}44 
}55 	
[?? 	
	Authorize??	 
]?? 
[@@ 	
HttpGet@@	 
(@@ 
Routes@@ 
.@@ 
LISTA_ONA_BY_ID@@ '
)@@' (
]@@( )
publicAA 
IActionResultAA 
GetListByONAsAsyncAA /
(AA/ 0
intAA0 3
idOnaAA4 9
)AA9 :
{BB 	
tryCC 
{DD 
returnEE 
OkEE 
(EE 
newEE 
RespuestasAPIEE +
<EE+ ,
ListEE, 0
<EE0 1
OnaDtoEE1 7
>EE7 8
>EE8 9
{FF 
ResultGG 
=GG 
_oNAServiceGG (
.GG( )
GetListByONAsAsyncGG) ;
(GG; <
idOnaGG< A
)GGA B
.GGB C
SelectGGC I
(GGI J
itemGGJ N
=>GGO Q
_mapperGGR Y
.GGY Z
MapGGZ ]
<GG] ^
OnaDtoGG^ d
>GGd e
(GGe f
itemGGf j
)GGj k
)GGk l
.GGl m
ToListGGm s
(GGs t
)GGt u
}HH 
)HH 
;HH 
}II 
catchJJ 
(JJ 
	ExceptionJJ 
eJJ 
)JJ 
{KK 
returnLL 
HandleExceptionLL &
(LL& '
eLL' (
,LL( )
nameofLL* 0
(LL0 1
GetListByONAsAsyncLL1 C
)LLC D
)LLD E
;LLE F
}MM 
}NN 	
[WW 	
	AuthorizeWW	 
]WW 
[XX 	
HttpGetXX	 
(XX 
RoutesXX 
.XX 
PAISESXX 
)XX 
]XX  
publicYY 
IActionResultYY 
FindAllPaisYY (
(YY( )
)YY) *
{ZZ 	
try[[ 
{\\ 
return]] 
Ok]] 
(]] 
new]] 
RespuestasAPI]] +
<]]+ ,
List]], 0
<]]0 1
	VwPaisDto]]1 :
>]]: ;
>]]; <
{^^ 
Result__ 
=__ 
_oNAService__ (
.__( )
FindAllPaises__) 6
(__6 7
)__7 8
.__8 9
Select__9 ?
(__? @
item__@ D
=>__E G
_mapper__H O
.__O P
Map__P S
<__S T
	VwPaisDto__T ]
>__] ^
(__^ _
item___ c
)__c d
)__d e
.__e f
ToList__f l
(__l m
)__m n
}`` 
)`` 
;`` 
}aa 
catchbb 
(bb 
	Exceptionbb 
ebb 
)bb 
{cc 
returndd 
HandleExceptiondd &
(dd& '
edd' (
,dd( )
nameofdd* 0
(dd0 1
FindAllPaisdd1 <
)dd< =
)dd= >
;dd> ?
}ee 
}ff 	
[pp 	
AllowAnonymouspp	 
]pp 
[qq 	
HttpGetqq	 
(qq 
$strqq 
)qq 
]qq 
publicrr 
IActionResultrr 
FindByIdrr %
(rr% &
intrr& )
idrr* ,
)rr, -
{ss 	
trytt 
{uu 
varvv 
recordvv 
=vv 
_oNAServicevv (
.vv( )
FindByIdvv) 1
(vv1 2
idvv2 4
)vv4 5
;vv5 6
ifxx 
(xx 
recordxx 
==xx 
nullxx "
)xx" #
{yy 
returnzz 
NotFoundResponsezz +
(zz+ ,

Constanteszz, 6
.zz6 7)
MESAGGE_REGISTRO_NO_ENCOTRADOzz7 T
)zzT U
;zzU V
}{{ 
return}} 
Ok}} 
(}} 
new}} 
RespuestasAPI}} +
<}}+ ,
OnaDto}}, 2
>}}2 3
{~~ 
Result 
= 
_mapper $
.$ %
Map% (
<( )
OnaDto) /
>/ 0
(0 1
record1 7
)7 8
}
ÄÄ 
)
ÄÄ 
;
ÄÄ 
}
ÅÅ 
catch
ÇÇ 
(
ÇÇ 
	Exception
ÇÇ 
e
ÇÇ 
)
ÇÇ 
{
ÉÉ 
return
ÑÑ 
HandleException
ÑÑ &
(
ÑÑ& '
e
ÑÑ' (
,
ÑÑ( )
nameof
ÑÑ* 0
(
ÑÑ0 1
FindById
ÑÑ1 9
)
ÑÑ9 :
)
ÑÑ: ;
;
ÑÑ; <
}
ÖÖ 
}
ÜÜ 	
[
êê 	
	Authorize
êê	 
]
êê 
[
ëë 	
HttpPut
ëë	 
(
ëë 
$str
ëë 
)
ëë 
]
ëë 
public
íí 
IActionResult
íí 
Update
íí #
(
íí# $
int
íí$ '
id
íí( *
,
íí* +
[
íí, -
FromBody
íí- 5
]
íí5 6
OnaDto
íí7 =
dto
íí> A
)
ííA B
{
ìì 	
try
îî 
{
ïï 
dto
ññ 
.
ññ 
IdONA
ññ 
=
ññ 
id
ññ 
;
ññ 
var
óó 
homologacion
óó  
=
óó! "
_mapper
óó# *
.
óó* +
Map
óó+ .
<
óó. /
ONA
óó/ 2
>
óó2 3
(
óó3 4
dto
óó4 7
)
óó7 8
;
óó8 9
return
ôô 
Ok
ôô 
(
ôô 
new
ôô 
RespuestasAPI
ôô +
<
ôô+ ,
bool
ôô, 0
>
ôô0 1
{
öö 
	IsSuccess
õõ 
=
õõ 
_oNAService
õõ  +
.
õõ+ ,
Update
õõ, 2
(
õõ2 3
homologacion
õõ3 ?
)
õõ? @
}
úú 
)
úú 
;
úú 
}
ùù 
catch
ûû 
(
ûû 
	Exception
ûû 
e
ûû 
)
ûû 
{
üü 
return
†† 
HandleException
†† &
(
††& '
e
††' (
,
††( )
nameof
††* 0
(
††0 1
Update
††1 7
)
††7 8
)
††8 9
;
††9 :
}
°° 
}
¢¢ 	
[
´´ 	
	Authorize
´´	 
]
´´ 
[
¨¨ 	
HttpPost
¨¨	 
]
¨¨ 
public
≠≠ 
IActionResult
≠≠ 
Create
≠≠ #
(
≠≠# $
[
≠≠$ %
FromBody
≠≠% -
]
≠≠- .
OnaDto
≠≠/ 5
dto
≠≠6 9
)
≠≠9 :
{
ÆÆ 	
try
ØØ 
{
∞∞ 
var
±± 
record
±± 
=
±± 
_mapper
±± $
.
±±$ %
Map
±±% (
<
±±( )
ONA
±±) ,
>
±±, -
(
±±- .
dto
±±. 1
)
±±1 2
;
±±2 3
return
≥≥ 
Ok
≥≥ 
(
≥≥ 
new
≥≥ 
RespuestasAPI
≥≥ +
<
≥≥+ ,
bool
≥≥, 0
>
≥≥0 1
{
¥¥ 
	IsSuccess
µµ 
=
µµ 
_oNAService
µµ  +
.
µµ+ ,
Create
µµ, 2
(
µµ2 3
record
µµ3 9
)
µµ9 :
}
∂∂ 
)
∂∂ 
;
∂∂ 
}
∑∑ 
catch
∏∏ 
(
∏∏ 
	Exception
∏∏ 
e
∏∏ 
)
∏∏ 
{
ππ 
return
∫∫ 
HandleException
∫∫ &
(
∫∫& '
e
∫∫' (
,
∫∫( )
nameof
∫∫* 0
(
∫∫0 1
Create
∫∫1 7
)
∫∫7 8
)
∫∫8 9
;
∫∫9 :
}
ªª 
}
ºº 	
[
≈≈ 	
	Authorize
≈≈	 
]
≈≈ 
[
∆∆ 	

HttpDelete
∆∆	 
(
∆∆ 
$str
∆∆ 
)
∆∆ 
]
∆∆  
public
«« 
IActionResult
«« 
Deactive
«« %
(
««% &
int
««& )
id
««* ,
)
««, -
{
»» 	
try
…… 
{
   
var
ÀÀ 
record
ÀÀ 
=
ÀÀ 
_oNAService
ÀÀ (
.
ÀÀ( )
FindById
ÀÀ) 1
(
ÀÀ1 2
id
ÀÀ2 4
)
ÀÀ4 5
;
ÀÀ5 6
if
ÕÕ 
(
ÕÕ 
record
ÕÕ 
==
ÕÕ 
null
ÕÕ "
)
ÕÕ" #
{
ŒŒ 
return
œœ 
NotFoundResponse
œœ +
(
œœ+ ,

Constantes
œœ, 6
.
œœ6 7+
MESAGGE_REGISTRO_NO_ENCOTRADO
œœ7 T
)
œœT U
;
œœU V
}
–– 
record
““ 
.
““ 
Estado
““ 
=
““ 

Constantes
““  *
.
““* +
ESTADO_USUARIO_X
““+ ;
;
““; <
return
‘‘ 
Ok
‘‘ 
(
‘‘ 
new
‘‘ 
RespuestasAPI
‘‘ +
<
‘‘+ ,
bool
‘‘, 0
>
‘‘0 1
{
’’ 
	IsSuccess
÷÷ 
=
÷÷ 
_oNAService
÷÷  +
.
÷÷+ ,
Update
÷÷, 2
(
÷÷2 3
record
÷÷3 9
)
÷÷9 :
}
◊◊ 
)
◊◊ 
;
◊◊ 
}
ÿÿ 
catch
ŸŸ 
(
ŸŸ 
	Exception
ŸŸ 
e
ŸŸ 
)
ŸŸ 
{
⁄⁄ 
return
€€ 
HandleException
€€ &
(
€€& '
e
€€' (
,
€€( )
nameof
€€* 0
(
€€0 1
Deactive
€€1 9
)
€€9 :
)
€€: ;
;
€€; <
}
‹‹ 
}
›› 	
}
ﬂﬂ 
}‡‡ Ú
QC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\OnaMigrateController.cs
	namespace 	
WebApp
 
. 
Controllers 
{ 
[ 
Route 

(
 
Routes 
. 
ONAC 
) 
] 
[		 
ApiController		 
]		 
[

  
ProducesResponseType

 
(

 
StatusCodes

 %
.

% &
Status200OK

& 1
)

1 2
]

2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class  
OnaMigrateController %
:& '
BaseController( 6
{ 
private 
readonly 
IOnaMigrate $
_ionaMigrate% 1
;1 2
public  
OnaMigrateController #
(# $
IOnaMigrate$ /
IonaMigrate0 ;
,; <
ILogger 
< 
BaseController #
># $
logger% +
)+ ,
:- .
base/ 3
(3 4
logger4 :
): ;
{ 	
_ionaMigrate 
= 
IonaMigrate &
;& '
} 	
[ 	
HttpPost	 
( 
Routes 
. 
POST_ONA_MIGRATE )
)) *
]* +
public   
async   
Task   
<   
IActionResult   '
>  ' (
postOnaMigrate  ) 7
(  7 8
[  8 9
FromBody  9 A
]  A B 
OnaMigrateRequestDto  C W
request  X _
)  _ `
{!! 	
try"" 
{## 
return$$ 
Ok$$ 
($$ 
new$$ 
RespuestasAPI$$ +
<$$+ ,
List$$, 0
<$$0 1
OnaMigrateDto$$1 >
>$$> ?
>$$? @
{%% 
Result&& 
=&& 
(&& 
await&& #
_ionaMigrate&&$ 0
.&&0 1
postOnaMigrate&&1 ?
(&&? @
request&&@ G
.&&G H
vista&&H M
,&&M N
request&&O V
.&&V W
IdOna&&W \
,&&\ ]
request&&^ e
.&&e f
	IdEsquema&&f o
)&&o p
)&&p q
.&&q r
ToList&&r x
(&&x y
)&&y z
}'' 
)'' 
;'' 
})) 
catch** 
(** 
	Exception** 
e** 
)** 
{++ 
return,, 
HandleException,, &
(,,& '
e,,' (
,,,( )
nameof,,* 0
(,,0 1
postOnaMigrate,,1 ?
),,? @
),,@ A
;,,A B
}-- 
}.. 	
}00 
}11 √M
RC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\ONAConexionController.cs
	namespace

 	
WebApp


 
.

 
Controllers

 
{ 
[ 
Route 

(
 
Routes 
. 
CONEXION 
) 
] 
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class !
ONAConexionController &
:' (
BaseController) 7
{ 
private 
readonly 
IONAConexionService ,
_oNAConexionService- @
;@ A
public !
ONAConexionController $
($ %
IONAConexionService% 8
oNAConexionService9 K
,K L
ILoggerM T
<T U!
ONAConexionControllerU j
>j k
loggerl r
)r s
:t u
basev z
(z {
logger	{ Å
)
Å Ç
{ 	
this 
. 
_oNAConexionService $
=% &
oNAConexionService' 9
;9 :
} 	
[## 	
	Authorize##	 
]## 
[$$ 	
HttpGet$$	 
]$$ 
public%% 
IActionResult%% 
FindAll%% $
(%%$ %
)%%% &
{&& 	
try'' 
{(( 
return)) 
Ok)) 
()) 
new)) 
RespuestasAPI)) +
<))+ ,
List)), 0
<))0 1
ONAConexionDto))1 ?
>))? @
>))@ A
{** 
Result++ 
=++ 
_oNAConexionService++ 0
.++0 1
FindAll++1 8
(++8 9
)++9 :
},, 
),, 
;,, 
}-- 
catch.. 
(.. 
	Exception.. 
e.. 
).. 
{// 
return00 
HandleException00 &
(00& '
e00' (
,00( )
nameof00* 0
(000 1
FindAll001 8
)008 9
)009 :
;00: ;
}11 
}22 	
[<< 	
	Authorize<<	 
]<< 
[== 	
HttpGet==	 
(== 
Routes== 
.== 
	LISTA_ONA== !
)==! "
]==" #
public>> 
IActionResult>> (
GetOnaConexionByOnaListAsync>> 9
(>>9 :
int>>: =
idOna>>> C
)>>C D
{?? 	
try@@ 
{AA 
returnBB 
OkBB 
(BB 
newBB 
RespuestasAPIBB +
<BB+ ,
ListBB, 0
<BB0 1
ONAConexionDtoBB1 ?
>BB? @
>BB@ A
{CC 
ResultDD 
=DD 
_oNAConexionServiceDD 0
.DD0 1(
GetONAConexionByOnaListAsyncDD1 M
(DDM N
idOnaDDN S
)DDS T
}EE 
)EE 
;EE 
}FF 
catchGG 
(GG 
	ExceptionGG 
eGG 
)GG 
{HH 
returnII 
HandleExceptionII &
(II& '
eII' (
,II( )
nameofII* 0
(II0 1(
GetOnaConexionByOnaListAsyncII1 M
)IIM N
)IIN O
;IIO P
}JJ 
}KK 	
[UU 	
	AuthorizeUU	 
]UU 
[VV 	
HttpGetVV	 
(VV 
$strVV 
)VV 
]VV 
publicWW 
IActionResultWW 
FindByIdWW %
(WW% &
intWW& )
idWW* ,
)WW, -
{XX 	
tryYY 
{ZZ 
var[[ 
record[[ 
=[[ 
_oNAConexionService[[ 0
.[[0 1
FindById[[1 9
([[9 :
id[[: <
)[[< =
;[[= >
if]] 
(]] 
record]] 
==]] 
null]] "
)]]" #
{^^ 
return__ 
NotFoundResponse__ +
(__+ ,

Constantes__, 6
.__6 7)
MESAGGE_REGISTRO_NO_ENCOTRADO__7 T
)__T U
;__U V
}`` 
returnbb 
Okbb 
(bb 
newbb 
RespuestasAPIbb +
<bb+ ,
ONAConexionDtobb, :
>bb: ;
{cc 
Resultdd 
=dd 
recorddd #
}ee 
)ee 
;ee 
}ff 
catchgg 
(gg 
	Exceptiongg 
egg 
)gg 
{hh 
returnii 
HandleExceptionii &
(ii& '
eii' (
,ii( )
nameofii* 0
(ii0 1
FindByIdii1 9
)ii9 :
)ii: ;
;ii; <
}jj 
}kk 	
[uu 	
	Authorizeuu	 
]uu 
[vv 	
HttpPutvv	 
(vv 
$strvv 
)vv 
]vv 
publicww 
IActionResultww 
Updateww #
(ww# $
intww$ '
idww( *
,ww* +
[ww, -
FromBodyww- 5
]ww5 6
ONAConexionDtoww7 E
dtowwF I
)wwI J
{xx 	
tryyy 
{zz 
dto{{ 
.{{ 
IdONA{{ 
={{ 
id{{ 
;{{ 
return|| 
Ok|| 
(|| 
new|| 
RespuestasAPI|| +
<||+ ,
bool||, 0
>||0 1
{}} 
	IsSuccess~~ 
=~~ 
_oNAConexionService~~  3
.~~3 4
Update~~4 :
(~~: ;
dto~~; >
)~~> ?
} 
) 
; 
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
	Exception
ÅÅ 
e
ÅÅ 
)
ÅÅ 
{
ÇÇ 
return
ÉÉ 
HandleException
ÉÉ &
(
ÉÉ& '
e
ÉÉ' (
,
ÉÉ( )
nameof
ÉÉ* 0
(
ÉÉ0 1
Update
ÉÉ1 7
)
ÉÉ7 8
)
ÉÉ8 9
;
ÉÉ9 :
}
ÑÑ 
}
ÖÖ 	
[
éé 	
	Authorize
éé	 
]
éé 
[
èè 	
HttpPost
èè	 
]
èè 
public
êê 
IActionResult
êê 
Create
êê #
(
êê# $
[
êê$ %
FromBody
êê% -
]
êê- .
ONAConexionDto
êê/ =
dto
êê> A
)
êêA B
{
ëë 	
try
íí 
{
ìì 
return
îî 
Ok
îî 
(
îî 
new
îî 
RespuestasAPI
îî +
<
îî+ ,
bool
îî, 0
>
îî0 1
{
ïï 
	IsSuccess
ññ 
=
ññ !
_oNAConexionService
ññ  3
.
ññ3 4
Create
ññ4 :
(
ññ: ;
dto
ññ; >
)
ññ> ?
}
óó 
)
óó 
;
óó 
}
òò 
catch
ôô 
(
ôô 
	Exception
ôô 
e
ôô 
)
ôô 
{
öö 
return
õõ 
HandleException
õõ &
(
õõ& '
e
õõ' (
,
õõ( )
nameof
õõ* 0
(
õõ0 1
Create
õõ1 7
)
õõ7 8
)
õõ8 9
;
õõ9 :
}
úú 
}
ùù 	
[
¶¶ 	
	Authorize
¶¶	 
]
¶¶ 
[
ßß 	

HttpDelete
ßß	 
(
ßß 
$str
ßß 
)
ßß 
]
ßß  
public
®® 
IActionResult
®® 
Deactive
®® %
(
®®% &
int
®®& )
id
®®* ,
)
®®, -
{
©© 	
try
™™ 
{
´´ 
var
¨¨ 
record
¨¨ 
=
¨¨ !
_oNAConexionService
¨¨ 0
.
¨¨0 1
FindById
¨¨1 9
(
¨¨9 :
id
¨¨: <
)
¨¨< =
;
¨¨= >
if
ÆÆ 
(
ÆÆ 
record
ÆÆ 
==
ÆÆ 
null
ÆÆ "
)
ÆÆ" #
{
ØØ 
return
∞∞ 
NotFoundResponse
∞∞ +
(
∞∞+ ,

Constantes
∞∞, 6
.
∞∞6 7+
MESAGGE_REGISTRO_NO_ENCOTRADO
∞∞7 T
)
∞∞T U
;
∞∞U V
}
±± 
record
≥≥ 
.
≥≥ 
Estado
≥≥ 
=
≥≥ 

Constantes
≥≥  *
.
≥≥* +
ESTADO_USUARIO_X
≥≥+ ;
;
≥≥; <
return
µµ 
Ok
µµ 
(
µµ 
new
µµ 
RespuestasAPI
µµ +
<
µµ+ ,
bool
µµ, 0
>
µµ0 1
{
∂∂ 
	IsSuccess
∑∑ 
=
∑∑ !
_oNAConexionService
∑∑  3
.
∑∑3 4
Update
∑∑4 :
(
∑∑: ;
record
∑∑; A
)
∑∑A B
}
∏∏ 
)
∏∏ 
;
∏∏ 
}
ππ 
catch
∫∫ 
(
∫∫ 
	Exception
∫∫ 
e
∫∫ 
)
∫∫ 
{
ªª 
return
ºº 
HandleException
ºº &
(
ºº& '
e
ºº' (
,
ºº( )
nameof
ºº* 0
(
ºº0 1
Deactive
ºº1 9
)
ºº9 :
)
ºº: ;
;
ºº; <
}
ΩΩ 
}
ææ 	
}
¡¡ 
}¬¬ ŸC
UC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\MigracionExcelController.cs
	namespace 	
WebApp
 
. 
Controllers 
{ 
[ 
Route 
( 	
Routes	 
. 
MIGRACION_EXCEL 
)  
]  !
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes #
.# $
Status200OK$ /
)/ 0
]0 1
[  
ProducesResponseType 
( 
StatusCodes #
.# $
Status400BadRequest$ 7
)7 8
]8 9
[  
ProducesResponseType 
( 
StatusCodes #
.# $
Status403Forbidden$ 6
)6 7
]7 8
[  
ProducesResponseType 
( 
StatusCodes #
.# $!
Status401Unauthorized$ 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes #
.# $(
Status500InternalServerError$ @
)@ A
]A B
public 
class	 #
MigacionExcelController &
:& '
BaseController( 6
{ 
private 
readonly "
IMigracionExcelService /"
_migracionExcelService0 F
;F G
private 
readonly 
IMapper  
_mapper! (
;( )
private 
readonly 
IExcelService &
	_importer' 0
;0 1
public #
MigacionExcelController &
(& '"
IMigracionExcelService &!
migracionExcelService' <
,< =
IMapper 
mapper 
, 
IExcelService 
importer &
,& '
ILogger 
< 
BaseController &
>& '
logger( .
)   
:   
base   
(   
logger   
)   
{!! 	
this"" 
."" "
_migracionExcelService"" '
=""( )!
migracionExcelService""* ?
;""? @
this## 
.## 
_mapper## 
=## 
mapper## !
;##! "
this$$ 
.$$ 
	_importer$$ 
=$$ 
importer$$ %
;$$% &
}%% 	
[.. 	
	Authorize..	 
].. 
[// 	
HttpGet//	 
]// 
public00 
IActionResult00 
FindAll00 $
(00$ %
)00% &
{11 	
try22 
{33 
return44 
Ok44 
(44 
new44 
RespuestasAPI44 +
<44+ ,
List44, 0
<440 1
MigracionExcelDto441 B
>44B C
>44C D
{55 
Result66 
=66 "
_migracionExcelService66 3
.663 4
FindAll664 ;
(66; <
)66< =
.66= >
Select66> D
(66D E
item66E I
=>66J L
_mapper66M T
.66T U
Map66U X
<66X Y
MigracionExcelDto66Y j
>66j k
(66k l
item66l p
)66p q
)66q r
.66r s
ToList66s y
(66y z
)66z {
}77 
)77 
;77 
}88 
catch99 
(99 
	Exception99 
e99 
)99 
{:: 
return;; 
HandleException;; &
(;;& '
e;;' (
,;;( )
nameof;;* 0
(;;0 1
FindAll;;1 8
);;8 9
);;9 :
;;;: ;
}<< 
}== 	
[HH 	
	AuthorizeHH	 
]HH 
[II 	
HttpPostII	 
(II 
RoutesII 
.II 
MIGRACION_UPLOADII )
)II) *
]II* +
publicJJ 
IActionResultJJ 
ImportarExcelJJ *
(JJ* +
	IFormFileJJ+ 4
fileJJ5 9
,JJ9 :
[JJ; <
	FromQueryJJ< E
]JJE F
intJJG J
idOnaJJK P
)JJP Q
{KK 	
tryLL 
{MM 
ifNN 
(NN 
fileNN 
==NN 
nullNN  
||NN! #
fileNN$ (
.NN( )
LengthNN) /
==NN0 2
$numNN3 4
)NN4 5
{OO 
returnPP 
BadRequestResponsePP -
(PP- .
$strPP. E
)PPE F
;PPF G
}QQ 
ifRR 
(RR 
idOnaRR 
<=RR 
$numRR 
)RR 
{SS 
returnTT 
BadRequestResponseTT -
(TT- .
$strTT. B
)TTB C
;TTC D
}UU 
stringWW 
fileExtensionWW $
=WW% &
PathWW' +
.WW+ ,
GetExtensionWW, 8
(WW8 9
fileWW9 =
.WW= >
FileNameWW> F
)WWF G
;WWG H
ifXX 
(XX 
fileExtensionXX !
!=XX" $
$strXX% +
&&XX, .
fileExtensionXX/ <
!=XX= ?
$strXX@ G
)XXG H
{YY 
returnZZ 
BadRequestResponseZZ -
(ZZ- .
$strZZ. A
)ZZA B
;ZZB C
}[[ 
string^^ 
wwwrootPath^^ "
=^^# $
Path^^% )
.^^) *
Combine^^* 1
(^^1 2
	Directory^^2 ;
.^^; <
GetCurrentDirectory^^< O
(^^O P
)^^P Q
,^^Q R
$str^^S \
)^^\ ]
;^^] ^
string__ 
	filesPath__  
=__! "
Path__# '
.__' (
Combine__( /
(__/ 0
wwwrootPath__0 ;
,__; <
$str__= D
)__D E
;__E F
ifbb 
(bb 
!bb 
	Directorybb 
.bb 
Existsbb %
(bb% &
	filesPathbb& /
)bb/ 0
)bb0 1
{cc 
	Directorydd 
.dd 
CreateDirectorydd -
(dd- .
	filesPathdd. 7
)dd7 8
;dd8 9
}ee 
stringhh 
filePathhh 
=hh  !
Pathhh" &
.hh& '
Combinehh' .
(hh. /
	filesPathhh/ 8
,hh8 9
filehh: >
.hh> ?
FileNamehh? G
)hhG H
;hhH I
usingkk 
(kk 
varkk 
streamkk !
=kk" #
newkk$ '

FileStreamkk( 2
(kk2 3
filePathkk3 ;
,kk; <
FileModekk= E
.kkE F
CreatekkF L
)kkL M
)kkM N
{ll 
filemm 
.mm 
CopyTomm 
(mm  
streammm  &
)mm& '
;mm' (
}nn 
LogMigracionqq 
	migracionqq &
=qq' ("
_migracionExcelServiceqq) ?
.qq? @
Createqq@ F
(qqF G
newqqG J
LogMigracionqqK W
{rr 
Estadoss 
=ss 

Constantesss '
.ss' ("
ESTADO_USUARIO_PENDINGss( >
,ss> ?
ExcelFileNamett !
=tt" #
filett$ (
.tt( )
FileNamett) 1
}uu 
)uu 
;uu 
	_importerww 
.ww 
ImportarExcelww '
(ww' (
filePathww( 0
,ww0 1
	migracionww2 ;
,ww; <
idOnaww= B
)wwB C
;wwC D
returnyy 
Okyy 
(yy 
newyy 
RespuestasAPIyy +
<yy+ ,
boolyy, 0
>yy0 1
{zz 
	IsSuccess{{ 
={{ 
true{{  $
}|| 
)|| 
;|| 
}}} 
catch~~ 
(~~ 
	Exception~~ 
ex~~ 
)~~  
{ 
return
ÄÄ 

StatusCode
ÄÄ !
(
ÄÄ! "
$num
ÄÄ" %
,
ÄÄ% &
new
ÄÄ' *
{
ÅÅ 

statusCode
ÇÇ 
=
ÇÇ  
$num
ÇÇ! $
,
ÇÇ$ %
	isSuccess
ÉÉ 
=
ÉÉ 
false
ÉÉ  %
,
ÉÉ% &
errorMessages
ÑÑ !
=
ÑÑ" #
new
ÑÑ$ '
[
ÑÑ' (
]
ÑÑ( )
{
ÑÑ* +
ex
ÑÑ, .
.
ÑÑ. /
Message
ÑÑ/ 6
}
ÑÑ7 8
}
ÖÖ 
)
ÖÖ 
;
ÖÖ 
}
ÜÜ 
}
áá 	
}
ââ 
}ää “N
KC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\MenuController.cs
	namespace

 	
WebApp


 
.

 
Controllers

 
{ 
[ 
Route 

(
 
Routes 
. 
MENU 
) 
] 
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class 
MenuController 
:  !
BaseController" 0
{ 
private 
readonly 
IMenuService %
_menuService& 2
;2 3
public 
MenuController 
( 
IMenuService *
menuService+ 6
,6 7
ILogger8 ?
<? @
MenuController@ N
>N O
loggerP V
)V W
:X Y
baseZ ^
(^ _
logger_ e
)e f
{ 	
this 
. 
_menuService 
= 
menuService  +
;+ ,
} 	
["" 	
HttpGet""	 
]"" 
public## 
IActionResult## 
FindAll## $
(##$ %
)##% &
{$$ 	
try%% 
{&& 
return'' 
Ok'' 
('' 
new'' 
RespuestasAPI'' +
<''+ ,
List'', 0
<''0 1

MenuRolDto''1 ;
>''; <
>''< =
{(( 
Result)) 
=)) 
_menuService)) )
.))) *
FindAll))* 1
())1 2
)))2 3
}** 
)** 
;** 
}++ 
catch,, 
(,, 
	Exception,, 
e,, 
),, 
{-- 
return.. 
HandleException.. &
(..& '
e..' (
,..( )
nameof..* 0
(..0 1
FindAll..1 8
)..8 9
)..9 :
;..: ;
}// 
}00 	
[;; 	
HttpGet;;	 
(;; 
$str;; -
);;- .
];;. /
public<< 
IActionResult<< 
FindById<< %
(<<% &
int<<& )
idHRol<<* 0
,<<0 1
int<<2 5
idHMenu<<6 =
)<<= >
{== 	
try>> 
{?? 
var@@ 
record@@ 
=@@ 
_menuService@@ )
.@@) *
FindDataById@@* 6
(@@6 7
idHRol@@7 =
,@@= >
idHMenu@@? F
)@@F G
;@@G H
ifAA 
(AA 
recordAA 
==AA 
nullAA "
)AA" #
{BB 
returnCC 
NotFoundResponseCC +
(CC+ ,

ConstantesCC, 6
.CC6 7)
MESAGGE_REGISTRO_NO_ENCOTRADOCC7 T
)CCT U
;CCU V
}DD 
returnEE 
OkEE 
(EE 
newEE 
RespuestasAPIEE +
<EE+ ,

MenuRolDtoEE, 6
>EE6 7
{FF 
ResultGG 
=GG 
recordGG #
}HH 
)HH 
;HH 
}II 
catchJJ 
(JJ 
	ExceptionJJ 
eJJ 
)JJ 
{KK 
returnLL 
HandleExceptionLL &
(LL& '
eLL' (
,LL( )
nameofLL* 0
(LL0 1
FindByIdLL1 9
)LL9 :
)LL: ;
;LL; <
}MM 
}NN 	
[YY 	
	AuthorizeYY	 
]YY 
[ZZ 	
HttpPutZZ	 
(ZZ 
$strZZ -
)ZZ- .
]ZZ. /
public[[ 
IActionResult[[ 
Update[[ #
([[# $
int[[$ '
idHRol[[( .
,[[. /
int[[0 3
idHMenu[[4 ;
,[[; <
[[[= >
FromBody[[> F
][[F G

MenuRolDto[[H R
dto[[S V
)[[V W
{\\ 	
try]] 
{^^ 
return__ 
Ok__ 
(__ 
new__ 
RespuestasAPI__ +
<__+ ,
bool__, 0
>__0 1
{`` 
	IsSuccessaa 
=aa 
_menuServiceaa  ,
.aa, -
Updateaa- 3
(aa3 4
dtoaa4 7
)aa7 8
}bb 
)bb 
;bb 
}cc 
catchdd 
(dd 
	Exceptiondd 
edd 
)dd 
{ee 
returnff 
HandleExceptionff &
(ff& '
eff' (
,ff( )
nameofff* 0
(ff0 1
Updateff1 7
)ff7 8
)ff8 9
;ff9 :
}gg 
}hh 	
[qq 	
	Authorizeqq	 
]qq 
[rr 	
HttpPostrr	 
]rr 
publicss 
IActionResultss 
Createss #
(ss# $
[ss$ %
FromBodyss% -
]ss- .

MenuRolDtoss/ 9
dtoss: =
)ss= >
{tt 	
tryuu 
{vv 
returnww 
Okww 
(ww 
newww 
RespuestasAPIww +
<ww+ ,
boolww, 0
>ww0 1
{xx 
	IsSuccessyy 
=yy 
_menuServiceyy  ,
.yy, -
Createyy- 3
(yy3 4
dtoyy4 7
)yy7 8
}zz 
)zz 
;zz 
}{{ 
catch|| 
(|| 
	Exception|| 
e|| 
)|| 
{}} 
return~~ 
HandleException~~ &
(~~& '
e~~' (
,~~( )
nameof~~* 0
(~~0 1
Create~~1 7
)~~7 8
)~~8 9
;~~9 :
} 
}
ÄÄ 	
[
ää 	
	Authorize
ää	 
]
ää 
[
ãã 	

HttpDelete
ãã	 
(
ãã 
$str
ãã 0
)
ãã0 1
]
ãã1 2
public
åå 
IActionResult
åå 
Deactive
åå %
(
åå% &
int
åå& )
idHRol
åå* 0
,
åå0 1
int
åå2 5
idHMenu
åå6 =
)
åå= >
{
çç 	
try
éé 
{
èè 
var
êê 
record
êê 
=
êê 
_menuService
êê )
.
êê) *
FindById
êê* 2
(
êê2 3
idHRol
êê3 9
,
êê9 :
idHMenu
êê; B
)
êêB C
;
êêC D
record
ëë 
.
ëë 
Estado
ëë 
=
ëë 
record
ëë  &
.
ëë& '
Estado
ëë' -
==
ëë. 0

Constantes
ëë1 ;
.
ëë; <
ESTADO_USUARIO_A
ëë< L
?
ëëM N

Constantes
ëëO Y
.
ëëY Z
ESTADO_USUARIO_X
ëëZ j
:
ëëk l

Constantes
ëëm w
.
ëëw x
ESTADO_USUARIO_Aëëx à
;ëëà â
if
íí 
(
íí 
record
íí 
==
íí 
null
íí "
)
íí" #
{
ìì 
return
îî 
NotFoundResponse
îî +
(
îî+ ,

Constantes
îî, 6
.
îî6 7+
MESAGGE_REGISTRO_NO_ENCOTRADO
îî7 T
)
îîT U
;
îîU V
}
ïï 
return
ññ 
Ok
ññ 
(
ññ 
new
ññ 
RespuestasAPI
ññ +
<
ññ+ ,
bool
ññ, 0
>
ññ0 1
{
óó 
	IsSuccess
òò 
=
òò 
_menuService
òò  ,
.
òò, -
Update
òò- 3
(
òò3 4
record
òò4 :
)
òò: ;
}
ôô 
)
ôô 
;
ôô 
}
öö 
catch
õõ 
(
õõ 
	Exception
õõ 
e
õõ 
)
õõ 
{
úú 
return
ùù 
HandleException
ùù &
(
ùù& '
e
ùù' (
,
ùù( )
nameof
ùù* 0
(
ùù0 1
Deactive
ùù1 9
)
ùù9 :
)
ùù: ;
;
ùù; <
}
ûû 
}
üü 	
[
®® 	
HttpGet
®®	 
(
®® 
$str
®® *
,
®®* +
Name
®®, 0
=
®®1 2
$str
®®3 :
)
®®: ;
]
®®; <
public
©© 
IActionResult
©© '
ObtenerMenusPendingConfig
©© 6
(
©©6 7
int
©©7 :
idHomologacionRol
©©; L
)
©©L M
{
™™ 	
try
´´ 
{
¨¨ 
return
≠≠ 
Ok
≠≠ 
(
≠≠ 
new
≠≠ 
RespuestasAPI
≠≠ +
<
≠≠+ ,
List
≠≠, 0
<
≠≠0 1
MenuPaginaDto
≠≠1 >
>
≠≠> ?
>
≠≠? @
{
ÆÆ 
Result
ØØ 
=
ØØ 
_menuService
ØØ )
.
ØØ) *'
ObtenerMenusPendingConfig
ØØ* C
(
ØØC D
idHomologacionRol
ØØD U
)
ØØU V
}
∞∞ 
)
∞∞ 
;
∞∞ 
}
±± 
catch
≤≤ 
(
≤≤ 
	Exception
≤≤ 
e
≤≤ 
)
≤≤ 
{
≥≥ 
return
¥¥ 
HandleException
¥¥ &
(
¥¥& '
e
¥¥' (
,
¥¥( )
nameof
¥¥* 0
(
¥¥0 1'
ObtenerMenusPendingConfig
¥¥1 J
)
¥¥J K
)
¥¥K L
;
¥¥L M
}
µµ 
}
∂∂ 	
}
∑∑ 
}∏∏ ˇ
SC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\LogMigracionController.cs
	namespace

 	
WebApp


 
.

 
Controllers

 
{ 
[ 
Route 

(
 
Routes 
. 
LOG_MIGRACION 
)  
]  !
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class "
LogMigracionController '
:( )
BaseController* 8
{ 
private 
readonly  
ILogMigracionService - 
_logMigracionService. B
;B C
private 
readonly 
IMapper  
_mapper! (
;( )
public "
LogMigracionController %
(% & 
ILogMigracionService& :
logMigracionService; N
,N O
IMapper 
mapper 
, 
ILogger 
< 
BaseController "
>" #
logger$ *
)* +
: 
base 
( 
logger 
) 
{ 	
this 
.  
_logMigracionService %
=& '
logMigracionService( ;
;; <
this 
. 
_mapper 
= 
mapper !
;! "
} 	
[(( 	
	Authorize((	 
](( 
[)) 	
HttpGet))	 
])) 
public** 
IActionResult** 
FindAll** $
(**$ %
)**% &
{++ 	
try,, 
{-- 
return.. 
Ok.. 
(.. 
new.. 
RespuestasAPI.. +
<..+ ,
List.., 0
<..0 1
LogMigracionDto..1 @
>..@ A
>..A B
{// 
Result00 
=00  
_logMigracionService00 1
.001 2
FindAll002 9
(009 :
)00: ;
.00; <
Select00< B
(00B C
item00C G
=>00H J
_mapper00K R
.00R S
Map00S V
<00V W
LogMigracionDto00W f
>00f g
(00g h
item00h l
)00l m
)00m n
.00n o
ToList00o u
(00u v
)00v w
}11 
)11 
;11 
}22 
catch33 
(33 
	Exception33 
e33 
)33 
{44 
return55 
HandleException55 &
(55& '
e55' (
,55( )
nameof55* 0
(550 1
FindAll551 8
)558 9
)559 :
;55: ;
}66 
}77 	
}88 
}99 ∫Y
SC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\HomologacionController.cs
	namespace 	
WebApp
 
. 
Controllers 
{ 
[ 
Route 

(
 
Routes 
. 
HOMOLOGACION 
) 
]  
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class "
HomologacionController '
:( )
BaseController* 8
{ 
private 
readonly  
IHomologacionService -!
_iHomologacionService. C
;C D
public "
HomologacionController %
(% & 
IHomologacionService& : 
iHomologacionService; O
,O P
ILoggerQ X
<X Y"
HomologacionControllerY o
>o p
loggerq w
)w x
:y z
base{ 
(	 Ä
logger
Ä Ü
)
Ü á
{ 	
this 
. !
_iHomologacionService &
=' ( 
iHomologacionService) =
;= >
} 	
[## 	
HttpGet##	 
(## 
Routes## 
.## 
FIND_BY_PARENT## &
)##& '
]##' (
public$$ 
IActionResult$$ 
FindByParent$$ )
($$) *
)$$* +
{%% 	
try&& 
{'' 
return(( 
Ok(( 
((( 
new(( 
RespuestasAPI(( +
<((+ ,
List((, 0
<((0 1
HomologacionDto((1 @
>((@ A
>((A B
{)) 
Result** 
=** !
_iHomologacionService** 2
.**2 3
FindByParent**3 ?
(**? @
)**@ A
}++ 
)++ 
;++ 
},, 
catch-- 
(-- 
	Exception-- 
e-- 
)-- 
{.. 
return// 
HandleException// &
(//& '
e//' (
,//( )
nameof//* 0
(//0 1
FindByParent//1 =
)//= >
)//> ?
;//? @
}00 
}11 	
[;; 	
	Authorize;;	 
];; 
[<< 	
HttpGet<<	 
(<< 
$str<< 
)<< 
]<< 
public== 
IActionResult== 
FindById== %
(==% &
int==& )
id==* ,
)==, -
{>> 	
try?? 
{@@ 
varAA 
recordAA 
=AA !
_iHomologacionServiceAA 2
.AA2 3
FindByIdAA3 ;
(AA; <
idAA< >
)AA> ?
;AA? @
ifCC 
(CC 
recordCC 
==CC 
nullCC "
)CC" #
{DD 
returnEE 
NotFoundResponseEE +
(EE+ ,

ConstantesEE, 6
.EE6 7)
MESAGGE_REGISTRO_NO_ENCOTRADOEE7 T
)EET U
;EEU V
}FF 
returnHH 
OkHH 
(HH 
newHH 
RespuestasAPIHH +
<HH+ ,
HomologacionDtoHH, ;
>HH; <
{II 
ResultJJ 
=JJ 
recordJJ #
}KK 
)KK 
;KK 
}LL 
catchMM 
(MM 
	ExceptionMM 
eMM 
)MM 
{NN 
returnOO 
HandleExceptionOO &
(OO& '
eOO' (
,OO( )
nameofOO* 0
(OO0 1
FindByIdOO1 9
)OO9 :
)OO: ;
;OO; <
}PP 
}QQ 	
[[[ 	
	Authorize[[	 
][[ 
[\\ 	
HttpPut\\	 
(\\ 
$str\\ 
)\\ 
]\\ 
public]] 
IActionResult]] 
Update]] #
(]]# $
int]]$ '
id]]( *
,]]* +
[]], -
FromBody]]- 5
]]]5 6
HomologacionDto]]7 F
dto]]G J
)]]J K
{^^ 	
try__ 
{`` 
dtoaa 
.aa 
IdHomologacionaa "
=aa# $
idaa% '
;aa' (
dtobb 
.bb 
Estadobb 
=bb 

Constantesbb '
.bb' (
ESTADO_USUARIO_Abb( 8
;bb8 9
returndd 
Okdd 
(dd 
newdd 
RespuestasAPIdd +
<dd+ ,
booldd, 0
>dd0 1
{ee 
	IsSuccessff 
=ff !
_iHomologacionServiceff  5
.ff5 6
Updateff6 <
(ff< =
dtoff= @
)ff@ A
}gg 
)gg 
;gg 
}hh 
catchii 
(ii 
	Exceptionii 
eii 
)ii 
{jj 
returnkk 
HandleExceptionkk &
(kk& '
ekk' (
,kk( )
nameofkk* 0
(kk0 1
Updatekk1 7
)kk7 8
)kk8 9
;kk9 :
}ll 
}mm 	
[vv 	
	Authorizevv	 
]vv 
[ww 	
HttpPostww	 
]ww 
publicxx 
IActionResultxx 
Createxx #
(xx# $
[xx$ %
FromBodyxx% -
]xx- .
HomologacionDtoxx/ >
dtoxx? B
)xxB C
{yy 	
tryzz 
{{{ 
return|| 
Ok|| 
(|| 
new|| 
RespuestasAPI|| +
<||+ ,
bool||, 0
>||0 1
{}} 
	IsSuccess~~ 
=~~ !
_iHomologacionService~~  5
.~~5 6
Create~~6 <
(~~< =
dto~~= @
)~~@ A
} 
) 
; 
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
	Exception
ÅÅ 
e
ÅÅ 
)
ÅÅ 
{
ÇÇ 
return
ÉÉ 
HandleException
ÉÉ &
(
ÉÉ& '
e
ÉÉ' (
,
ÉÉ( )
nameof
ÉÉ* 0
(
ÉÉ0 1
Create
ÉÉ1 7
)
ÉÉ7 8
)
ÉÉ8 9
;
ÉÉ9 :
}
ÑÑ 
}
ÖÖ 	
[
éé 	
	Authorize
éé	 
]
éé 
[
èè 	

HttpDelete
èè	 
(
èè 
$str
èè 
)
èè 
]
èè  
public
êê 
IActionResult
êê 
Deactive
êê %
(
êê% &
int
êê& )
id
êê* ,
)
êê, -
{
ëë 	
try
íí 
{
ìì 
var
îî 
record
îî 
=
îî #
_iHomologacionService
îî 2
.
îî2 3
FindById
îî3 ;
(
îî; <
id
îî< >
)
îî> ?
;
îî? @
if
ññ 
(
ññ 
record
ññ 
==
ññ 
null
ññ "
)
ññ" #
{
óó 
return
òò 
NotFoundResponse
òò +
(
òò+ ,

Constantes
òò, 6
.
òò6 7+
MESAGGE_REGISTRO_NO_ENCOTRADO
òò7 T
)
òòT U
;
òòU V
}
ôô 
record
õõ 
.
õõ 
Estado
õõ 
=
õõ 

Constantes
õõ  *
.
õõ* +
ESTADO_USUARIO_X
õõ+ ;
;
õõ; <
return
ùù 
Ok
ùù 
(
ùù 
new
ùù 
RespuestasAPI
ùù +
<
ùù+ ,
bool
ùù, 0
>
ùù0 1
{
ûû 
	IsSuccess
üü 
=
üü #
_iHomologacionService
üü  5
.
üü5 6
Update
üü6 <
(
üü< =
record
üü= C
)
üüC D
}
†† 
)
†† 
;
†† 
}
°° 
catch
¢¢ 
(
¢¢ 
	Exception
¢¢ 
e
¢¢ 
)
¢¢ 
{
££ 
return
§§ 
HandleException
§§ &
(
§§& '
e
§§' (
,
§§( )
nameof
§§* 0
(
§§0 1
Deactive
§§1 9
)
§§9 :
)
§§: ;
;
§§; <
}
•• 
}
¶¶ 	
[
ØØ 	
	Authorize
ØØ	 
]
ØØ 
[
∞∞ 	
HttpGet
∞∞	 
(
∞∞ 
Routes
∞∞ 
.
∞∞ )
FIND_BY_CODIGO_HOMOLOGACION
∞∞ 3
)
∞∞3 4
]
∞∞4 5
public
±± 
IActionResult
±± &
FindByCodigoHomologacion
±± 5
(
±±5 6
string
±±6 < 
codigoHomologacion
±±= O
)
±±O P
{
≤≤ 	
try
≥≥ 
{
¥¥ 
return
µµ 
Ok
µµ 
(
µµ 
new
µµ 
RespuestasAPI
µµ +
<
µµ+ ,
List
µµ, 0
<
µµ0 1
VwHomologacionDto
µµ1 B
>
µµB C
>
µµC D
{
∂∂ 
Result
∑∑ 
=
∑∑ #
_iHomologacionService
∑∑ 2
.
∑∑2 3,
ObtenerVwHomologacionPorCodigo
∑∑3 Q
(
∑∑Q R 
codigoHomologacion
∑∑R d
)
∑∑d e
}
∏∏ 
)
∏∏ 
;
∏∏ 
}
ππ 
catch
∫∫ 
(
∫∫ 
	Exception
∫∫ 
e
∫∫ 
)
∫∫ 
{
ªª 
return
ºº 
HandleException
ºº &
(
ºº& '
e
ºº' (
,
ºº( )
nameof
ºº* 0
(
ºº0 1&
FindByCodigoHomologacion
ºº1 I
)
ººI J
)
ººJ K
;
ººK L
}
ΩΩ 
}
ææ 	
[
∆∆ 	
	Authorize
∆∆	 
]
∆∆ 
[
«« 	
HttpGet
««	 
(
«« 
Routes
«« 
.
«« &
FIND_BY_ALL_HOMOLOGACION
«« 0
)
««0 1
]
««1 2
public
»» 
IActionResult
»» 
	FindByAll
»» &
(
»»& '
)
»»' (
{
…… 	
try
   
{
ÀÀ 
return
ÃÃ 
Ok
ÃÃ 
(
ÃÃ 
new
ÃÃ 
RespuestasAPI
ÃÃ +
<
ÃÃ+ ,
List
ÃÃ, 0
<
ÃÃ0 1
HomologacionDto
ÃÃ1 @
>
ÃÃ@ A
>
ÃÃA B
{
ÕÕ 
Result
ŒŒ 
=
ŒŒ #
_iHomologacionService
ŒŒ 2
.
ŒŒ2 3
	FindByAll
ŒŒ3 <
(
ŒŒ< =
)
ŒŒ= >
}
œœ 
)
œœ 
;
œœ 
}
–– 
catch
—— 
(
—— 
	Exception
—— 
e
—— 
)
—— 
{
““ 
return
”” 
HandleException
”” &
(
””& '
e
””' (
,
””( )
nameof
””* 0
(
””0 1
	FindByAll
””1 :
)
””: ;
)
””; <
;
””< =
}
‘‘ 
}
’’ 	
}
÷÷ 
}◊◊ ≤v
TC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\EventTrackingController.cs
	namespace		 	
WebApp		
 
.		 
Controllers		 
{

 
[ 
	Authorize 
] 
[ 
Route 

(
 
Routes 
. 
EVENT_TRACKING  
)  !
]! "
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class #
EventTrackingController (
:) *
BaseController+ 9
{ 
private 
readonly !
IEventTrackingService ."
_iEventTrackingService/ E
;E F
private 
readonly 
IMapper  
_mapper! (
;( )
private 
readonly !
IIpCoordinatesService ."
_iIpCoordinatesService/ E
;E F
public #
EventTrackingController &
(& '!
IEventTrackingService' <!
iEventTrackingService= R
,R S
IMapper' .
mapper/ 5
,5 6!
IIpCoordinatesService' <!
iIpCoordinatesService= R
,R S
ILogger' .
<. /
BaseController/ =
>= >
logger? E
)E F
:G H
baseI M
(M N
loggerN T
)T U
{ 	
this 
. "
_iEventTrackingService '
=( )!
iEventTrackingService* ?
;? @
this 
. 
_mapper 
= 
mapper !
;! "
this   
.   "
_iIpCoordinatesService   '
=  ( )!
iIpCoordinatesService  * ?
;  ? @
}!! 	
[,, 	
HttpGet,,	 
(,, 
$str,, -
),,- .
],,. /
public-- 
IActionResult-- 
FindById-- %
(--% &
int--& )
idHRol--* 0
,--0 1
int--2 5
idHMenu--6 =
)--= >
{.. 	
try// 
{00 
var11 
record11 
=11 "
_iEventTrackingService11 3
.113 4
FindDataById114 @
(11@ A
idHRol11A G
,11G H
idHMenu11I P
)11P Q
;11Q R
if22 
(22 
record22 
==22 
null22 "
)22" #
{33 
return44 
NotFoundResponse44 +
(44+ ,

Constantes44, 6
.446 7)
MESAGGE_REGISTRO_NO_ENCOTRADO447 T
)44T U
;44U V
}55 
return66 
Ok66 
(66 
new66 
RespuestasAPI66 +
<66+ ,

MenuRolDto66, 6
>666 7
{77 
Result88 
=88 
_mapper88 $
.88$ %
Map88% (
<88( )

MenuRolDto88) 3
>883 4
(884 5
record885 ;
)88; <
}99 
)99 
;99 
}:: 
catch;; 
(;; 
	Exception;; 
e;; 
);; 
{<< 
return== 
HandleException== &
(==& '
e==' (
,==( )
nameof==* 0
(==0 1
FindById==1 9
)==9 :
)==: ;
;==; <
}>> 
}?? 	
[EE 	
HttpGetEE	 
(EE 
RoutesEE 
.EE 
EVENT_USER_ALLEE &
)EE& '
]EE' (
publicFF 
IActionResultFF 
GetEventUserAllFF ,
(FF, -
)FF- .
{GG 	
tryHH 
{II 
returnJJ 
OkJJ 
(JJ 
newJJ 
RespuestasAPIJJ +
<JJ+ ,
ListJJ, 0
<JJ0 1
VwEventUserAllDtoJJ1 B
>JJB C
>JJC D
{KK 
ResultLL 
=LL "
_iEventTrackingServiceLL 3
.LL3 4
GetEventUserAllLL4 C
(LLC D
)LLD E
.LLE F
SelectLLF L
(LLL M
itemLLM Q
=>LLR T
_mapperLLU \
.LL\ ]
MapLL] `
<LL` a
VwEventUserAllDtoLLa r
>LLr s
(LLs t
itemLLt x
)LLx y
)LLy z
.LLz {
ToList	LL{ Å
(
LLÅ Ç
)
LLÇ É
}MM 
)MM 
;MM 
}NN 
catchOO 
(OO 
	ExceptionOO 
eOO 
)OO 
{PP 
returnQQ 
HandleExceptionQQ &
(QQ& '
eQQ' (
,QQ( )
nameofQQ* 0
(QQ0 1
GetEventUserAllQQ1 @
)QQ@ A
)QQA B
;QQB C
}RR 
}SS 	
[\\ 	
HttpGet\\	 
(\\ 
Routes\\ 
.\\ 
EVENT\\ 
)\\ 
]\\ 
public]] 
IActionResult]] 
GetEventAll]] (
(]]( )
[]]) *
	FromQuery]]* 3
]]]3 4
string]]5 ;
report]]< B
,]]B C
[]]D E
	FromQuery]]E N
]]]N O
DateOnly]]P X
fini]]Y ]
,]]] ^
[]]_ `
	FromQuery]]` i
]]]i j
DateOnly]]k s
ffin]]t x
)]]x y
{^^ 	
try__ 
{`` 
returnaa 
Okaa 
(aa 
newaa 
RespuestasAPIaa +
<aa+ ,
Listaa, 0
<aa0 1
EventUserDtoaa1 =
>aa= >
>aa> ?
{bb 
Resultcc 
=cc "
_iEventTrackingServicecc 3
.cc3 4
GetEventAllcc4 ?
(cc? @
reportcc@ F
,ccF G
finiccH L
,ccL M
ffinccN R
)ccR S
.ccS T
SelectccT Z
(ccZ [
itemcc[ _
=>cc` b
_mapperccc j
.ccj k
Mapcck n
<ccn o
EventUserDtocco {
>cc{ |
(cc| }
item	cc} Å
)
ccÅ Ç
)
ccÇ É
.
ccÉ Ñ
ToList
ccÑ ä
(
ccä ã
)
ccã å
}dd 
)dd 
;dd 
}ee 
catchff 
(ff 
	Exceptionff 
eff 
)ff 
{gg 
returnhh 
HandleExceptionhh &
(hh& '
ehh' (
,hh( )
nameofhh* 0
(hh0 1
GetEventUserAllhh1 @
)hh@ A
)hhA B
;hhB C
}ii 
}jj 	
[rr 	

HttpDeleterr	 
(rr 
Routesrr 
.rr 
EVENT_DELETErr '
)rr' (
]rr( )
publicss 
IActionResultss 
DeleteEventAllss +
(ss+ ,
DateOnlyss, 4
finiss5 9
,ss9 :
DateOnlyss; C
ffinssD H
)ssH I
{tt 	
tryuu 
{vv 
returnww 
Okww 
(ww 
newww 
RespuestasAPIww +
<ww+ ,
boolww, 0
>ww0 1
{xx 
Resultyy 
=yy "
_iEventTrackingServiceyy 3
.yy3 4
DeleteEventAllyy4 B
(yyB C
finiyyC G
,yyG H
ffinyyI M
)yyM N
}zz 
)zz 
;zz 
}{{ 
catch|| 
(|| 
	Exception|| 
e|| 
)|| 
{}} 
return~~ 
HandleException~~ &
(~~& '
e~~' (
,~~( )
nameof~~* 0
(~~0 1
GetEventUserAll~~1 @
)~~@ A
)~~A B
;~~B C
} 
}
ÄÄ 	
[
áá 	

HttpDelete
áá	 
(
áá 
Routes
áá 
.
áá 
EVENT_DELETE_ID
áá *
)
áá* +
]
áá+ ,
public
àà 
IActionResult
àà 
DeleteEventById
àà ,
(
àà, -
int
àà- 0
codigoEvento
àà1 =
)
àà= >
{
ââ 	
try
ää 
{
ãã 
return
åå 
Ok
åå 
(
åå 
new
åå 
RespuestasAPI
åå +
<
åå+ ,
bool
åå, 0
>
åå0 1
{
çç 
Result
éé 
=
éé $
_iEventTrackingService
éé 3
.
éé3 4
DeleteEventById
éé4 C
(
ééC D
codigoEvento
ééD P
)
ééP Q
}
èè 
)
èè 
;
èè 
}
êê 
catch
ëë 
(
ëë 
	Exception
ëë 
e
ëë 
)
ëë 
{
íí 
return
ìì 
HandleException
ìì &
(
ìì& '
e
ìì' (
,
ìì( )
nameof
ìì* 0
(
ìì0 1
GetEventUserAll
ìì1 @
)
ìì@ A
)
ììA B
;
ììB C
}
îî 
}
ïï 	
[
úú 	
HttpGet
úú	 
(
úú 
Routes
úú 
.
úú 
EVENT_SESSION
úú %
)
úú% &
]
úú& '
public
ùù 
IActionResult
ùù 
GetEventSession
ùù ,
(
ùù, -
)
ùù- .
{
ûû 	
try
üü 
{
†† 
return
°° 
Ok
°° 
(
°° 
new
°° 
RespuestasAPI
°° +
<
°°+ ,
List
°°, 0
<
°°0 1'
VwEventTrackingSessionDto
°°1 J
>
°°J K
>
°°K L
{
¢¢ 
Result
££ 
=
££ $
_iEventTrackingService
££ 3
.
££3 4
GetEventSession
££4 C
(
££C D
)
££D E
.
££E F
ToList
££F L
(
££L M
)
££M N
}
§§ 
)
§§ 
;
§§ 
}
•• 
catch
¶¶ 
(
¶¶ 
	Exception
¶¶ 
e
¶¶ 
)
¶¶ 
{
ßß 
return
®® 
HandleException
®® &
(
®®& '
e
®®' (
,
®®( )
nameof
®®* 0
(
®®0 1
GetEventSession
®®1 @
)
®®@ A
)
®®A B
;
®®B C
}
©© 
}
™™ 	
[
≤≤ 	
HttpGet
≤≤	 
(
≤≤ 
Routes
≤≤ 
.
≤≤ 
COORDINATES
≤≤ #
)
≤≤# $
]
≤≤$ %
public
≥≥ 
async
≥≥ 
Task
≥≥ 
<
≥≥ 
IActionResult
≥≥ '
>
≥≥' (
GetCoordinates
≥≥) 7
(
≥≥7 8
string
≥≥8 >
ip
≥≥? A
)
≥≥A B
{
¥¥ 	
try
µµ 
{
∂∂ 
var
∑∑ 
result
∑∑ 
=
∑∑ 
await
∑∑ "$
_iIpCoordinatesService
∑∑# 9
.
∑∑9 :
GetCoordinates
∑∑: H
(
∑∑H I
ip
∑∑I K
)
∑∑K L
;
∑∑L M
if
ππ 
(
ππ 
result
ππ 
==
ππ 
null
ππ "
)
ππ" #
return
∫∫ 
NotFound
∫∫ #
(
∫∫# $
new
∫∫$ '
RespuestasAPI
∫∫( 5
<
∫∫5 6
string
∫∫6 <
>
∫∫< =
{
ªª 
Result
ºº 
=
ºº  
null
ºº! %
}
ΩΩ 
)
ΩΩ 
;
ΩΩ 
return
øø 
Ok
øø 
(
øø 
result
øø  
)
øø  !
;
øø! "
}
¿¿ 
catch
¡¡ 
(
¡¡ 
	Exception
¡¡ 
e
¡¡ 
)
¡¡ 
{
¬¬ 
return
√√ 
HandleException
√√ &
(
√√& '
e
√√' (
,
√√( )
nameof
√√* 0
(
√√0 1
GetCoordinates
√√1 ?
)
√√? @
)
√√@ A
;
√√A B
}
ƒƒ 
}
≈≈ 	
[
ÀÀ 	
HttpGet
ÀÀ	 
(
ÀÀ 
Routes
ÀÀ 
.
ÀÀ !
EVENT_PAG_MAS_VISIT
ÀÀ +
)
ÀÀ+ ,
]
ÀÀ, -
public
ÃÃ 
IActionResult
ÃÃ !
GetEventPagMasVisit
ÃÃ 0
(
ÃÃ0 1
)
ÃÃ1 2
{
ÕÕ 	
try
ŒŒ 
{
œœ 
return
–– 
Ok
–– 
(
–– 
new
–– 
RespuestasAPI
–– +
<
––+ ,
List
––, 0
<
––0 1#
PaginasMasVisitadaDto
––1 F
>
––F G
>
––G H
{
—— 
Result
““ 
=
““ $
_iEventTrackingService
““ 3
.
““3 4!
GetEventPagMasVisit
““4 G
(
““G H
)
““H I
.
““I J
ToList
““J P
(
““P Q
)
““Q R
}
”” 
)
”” 
;
”” 
}
‘‘ 
catch
’’ 
(
’’ 
	Exception
’’ 
e
’’ 
)
’’ 
{
÷÷ 
return
◊◊ 
HandleException
◊◊ &
(
◊◊& '
e
◊◊' (
,
◊◊( )
nameof
◊◊* 0
(
◊◊0 1!
GetEventPagMasVisit
◊◊1 D
)
◊◊D E
)
◊◊E F
;
◊◊F G
}
ÿÿ 
}
ŸŸ 	
[
€€ 	
HttpGet
€€	 
(
€€ 
Routes
€€ 
.
€€ $
EVENT_FILTRO_MAS_USADO
€€ .
)
€€. /
]
€€/ 0
public
‹‹ 
IActionResult
‹‹ $
GetEventFiltroMasUsado
‹‹ 3
(
‹‹3 4
)
‹‹4 5
{
›› 	
try
ﬁﬁ 
{
ﬂﬂ 
return
‡‡ 
Ok
‡‡ 
(
‡‡ 
new
‡‡ 
RespuestasAPI
‡‡ +
<
‡‡+ ,
List
‡‡, 0
<
‡‡0 1 
FiltrosMasUsadoDto
‡‡1 C
>
‡‡C D
>
‡‡D E
{
·· 
Result
‚‚ 
=
‚‚ $
_iEventTrackingService
‚‚ 3
.
‚‚3 4"
GetEventFiltroMasUsa
‚‚4 H
(
‚‚H I
)
‚‚I J
.
‚‚J K
ToList
‚‚K Q
(
‚‚Q R
)
‚‚R S
}
„„ 
)
„„ 
;
„„ 
}
‰‰ 
catch
ÂÂ 
(
ÂÂ 
	Exception
ÂÂ 
e
ÂÂ 
)
ÂÂ 
{
ÊÊ 
return
ÁÁ 
HandleException
ÁÁ &
(
ÁÁ& '
e
ÁÁ' (
,
ÁÁ( )
nameof
ÁÁ* 0
(
ÁÁ0 1$
GetEventFiltroMasUsado
ÁÁ1 G
)
ÁÁG H
)
ÁÁH I
;
ÁÁI J
}
ËË 
}
ÈÈ 	
}
ÎÎ 
}ÏÏ ØI
QC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\GoogleAuthController.cs
	namespace 	
WebApp
 
. 
Controllers 
{		 
[ 
Route 

(
 
Routes 
. 
GOOGLE 
) 
] 
[ 
ApiController 
] 
public 

class  
GoogleAuthController %
:& '
ControllerBase( 6
{ 
private 
readonly 
IConfiguration '
_configuration( 6
;6 7
private 
readonly 
ILogger  
<  ! 
GoogleAuthController! 5
>5 6
_logger7 >
;> ?
public    
GoogleAuthController   #
(  # $
IConfiguration  $ 2
configuration  3 @
,  @ A
ILogger  B I
<  I J 
GoogleAuthController  J ^
>  ^ _
logger  ` f
)  f g
{!! 	
_configuration"" 
="" 
configuration"" *
;""* +
_logger## 
=## 
logger## 
;## 
}$$ 	
[)) 	
HttpGet))	 
()) 
Routes)) 
.)) 
	AUTHORIZE)) !
)))! "
]))" #
public** 
IActionResult** 
	Authorize** &
(**& '
)**' (
{++ 	
if-- 
(-- 
	Directory-- 
.-- 
Exists--  
(--  !
_configuration--! /
[--/ 0
$str--0 D
]--D E
)--E F
)--F G
{.. 
var00 

tokenFiles00 
=00  
	Directory00! *
.00* +
GetFiles00+ 3
(003 4
_configuration004 B
[00B C
$str00C W
]00W X
)00X Y
;00Y Z
if22 
(22 

tokenFiles22 
.22 
Length22 %
>22& '
$num22( )
)22) *
{33 
_logger44 
.44 
LogInformation44 *
(44* +
$str44+ [
)44[ \
;44\ ]
return55 
Ok55 
(55 
new55 !
{55" #
message55$ +
=55, -
$str55. s
}55t u
)55u v
;55v w
}66 
}77 
else88 
{99 
	Directory;; 
.;; 
CreateDirectory;; )
(;;) *
_configuration;;* 8
[;;8 9
$str;;9 M
];;M N
);;N O
;;;O P
}<< 
try>> 
{?? 
varAA 
clientIdAA 
=AA 
_configurationAA -
[AA- .
$strAA. D
]AAD E
;AAE F
varBB 
clientSecretBB  
=BB! "
_configurationBB# 1
[BB1 2
$strBB2 L
]BBL M
;BBM N
varCC 
redirectUriCC 
=CC  !
_configurationCC" 0
[CC0 1
$strCC1 J
]CCJ K
;CCK L
varEE 
clientSecretsEE !
=EE" #
newEE$ '
ClientSecretsEE( 5
{FF 
ClientIdGG 
=GG 
clientIdGG '
,GG' (
ClientSecretHH  
=HH! "
clientSecretHH# /
}II 
;II 
varKK 
flowKK 
=KK 
newKK '
GoogleAuthorizationCodeFlowKK :
(KK: ;
newKK; >'
GoogleAuthorizationCodeFlowKK? Z
.KKZ [
InitializerKK[ f
{LL 
ClientSecretsMM !
=MM" #
clientSecretsMM$ 1
,MM1 2
ScopesNN 
=NN 
newNN  
[NN  !
]NN! "
{NN# $
_configurationNN% 3
[NN3 4
$strNN4 M
]NNM N
}NNO P
,NNP Q
	DataStoreOO 
=OO 
newOO  #
FileDataStoreOO$ 1
(OO1 2
_configurationOO2 @
[OO@ A
$strOOA U
]OOU V
,OOV W
trueOOX \
)OO\ ]
}PP 
)PP 
;PP 
stringSS 
authorizationUrlSS '
=SS( )
flowSS* .
.SS. /*
CreateAuthorizationCodeRequestSS/ M
(SSM N
redirectUriSSN Y
)SSY Z
.SSZ [
BuildSS[ `
(SS` a
)SSa b
.SSb c
ToStringSSc k
(SSk l
)SSl m
;SSm n
_loggerUU 
.UU 
LogInformationUU &
(UU& '
$strUU' R
)UUR S
;UUS T
returnVV 
RedirectVV 
(VV  
authorizationUrlVV  0
)VV0 1
;VV1 2
}WW 
catchXX 
(XX 
	ExceptionXX 
exXX 
)XX  
{YY 
_loggerZZ 
.ZZ 
LogErrorZZ  
(ZZ  !
$"ZZ! #
$strZZ# J
{ZZJ K
exZZK M
.ZZM N
MessageZZN U
}ZZU V
"ZZV W
)ZZW X
;ZZX Y
return[[ 

BadRequest[[ !
([[! "
$str[[" W
)[[W X
;[[X Y
}\\ 
}]] 	
[bb 	
HttpGetbb	 
(bb 
Routesbb 
.bb 
CALLBACKbb  
)bb  !
]bb! "
publiccc 
asynccc 
Taskcc 
<cc 
IActionResultcc '
>cc' (
Callbackcc) 1
(cc1 2
stringcc2 8
codecc9 =
)cc= >
{dd 	
ifee 
(ee 
stringee 
.ee 
IsNullOrEmptyee $
(ee$ %
codeee% )
)ee) *
)ee* +
{ff 
returngg 

BadRequestgg !
(gg! "
$strgg" N
)ggN O
;ggO P
}hh 
tryjj 
{kk 
varmm 
clientIdmm 
=mm 
_configurationmm -
[mm- .
$strmm. D
]mmD E
;mmE F
varnn 
clientSecretnn  
=nn! "
_configurationnn# 1
[nn1 2
$strnn2 L
]nnL M
;nnM N
varoo 
redirectUrioo 
=oo  !
_configurationoo" 0
[oo0 1
$stroo1 J
]ooJ K
;ooK L
varpp 
	userEmailpp 
=pp 
_configurationpp  .
[pp. /
$strpp/ E
]ppE F
;ppF G
varrr 
clientSecretsrr !
=rr" #
newrr$ '
ClientSecretsrr( 5
{ss 
ClientIdtt 
=tt 
clientIdtt '
,tt' (
ClientSecretuu  
=uu! "
clientSecretuu# /
}vv 
;vv 
varxx 
flowxx 
=xx 
newxx '
GoogleAuthorizationCodeFlowxx :
(xx: ;
newxx; >'
GoogleAuthorizationCodeFlowxx? Z
.xxZ [
Initializerxx[ f
{yy 
ClientSecretszz !
=zz" #
clientSecretszz$ 1
,zz1 2
Scopes{{ 
={{ 
new{{  
[{{  !
]{{! "
{{{# $
_configuration{{% 3
[{{3 4
$str{{4 P
]{{P Q
}{{R S
,{{S T
	DataStore|| 
=|| 
new||  #
FileDataStore||$ 1
(||1 2
_configuration||2 @
[||@ A
$str||A U
]||U V
,||V W
true||X \
)||\ ]
}}} 
)}} 
;}} 
TokenResponse
ÄÄ 
token
ÄÄ #
=
ÄÄ$ %
await
ÄÄ& +
flow
ÄÄ, 0
.
ÄÄ0 1'
ExchangeCodeForTokenAsync
ÄÄ1 J
(
ÄÄJ K
	userEmail
ÅÅ 
,
ÅÅ 
code
ÅÅ #
,
ÅÅ# $
redirectUri
ÅÅ% 0
,
ÅÅ0 1
CancellationToken
ÅÅ2 C
.
ÅÅC D
None
ÅÅD H
)
ÅÅH I
;
ÅÅI J
_logger
ÑÑ 
.
ÑÑ 
LogInformation
ÑÑ &
(
ÑÑ& '
$str
ÑÑ' @
,
ÑÑ@ A
JsonConvert
ÑÑB M
.
ÑÑM N
SerializeObject
ÑÑN ]
(
ÑÑ] ^
token
ÑÑ^ c
)
ÑÑc d
)
ÑÑd e
;
ÑÑe f
_logger
ÜÜ 
.
ÜÜ 
LogInformation
ÜÜ &
(
ÜÜ& '
$str
ÜÜ' O
)
ÜÜO P
;
ÜÜP Q
return
áá 
Ok
áá 
(
áá 
new
áá 
{
áá 
message
áá  '
=
áá( )
$str
áá* R
}
ááS T
)
ááT U
;
ááU V
}
àà 
catch
ââ 
(
ââ 
	Exception
ââ 
ex
ââ 
)
ââ  
{
ää 
_logger
ãã 
.
ãã 
LogError
ãã  
(
ãã  !
$"
ãã! #
$str
ãã# >
{
ãã> ?
ex
ãã? A
.
ããA B
Message
ããB I
}
ããI J
"
ããJ K
)
ããK L
;
ããL M
return
åå 

BadRequest
åå !
(
åå! "
$"
åå" $
$str
åå$ ?
{
åå? @
ex
åå@ B
.
ååB C
Message
ååC J
}
ååJ K
"
ååK L
)
ååL M
;
ååM N
}
çç 
}
éé 	
}
èè 
}êê ˙î
NC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\EsquemaController.cs
	namespace 	
WebApp
 
. 
Controllers 
{ 
[ 
Route 

(
 
Routes 
. 
ESQUEMA 
) 
] 
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class 
EsquemaController "
:# $
BaseController% 3
{ 
private 
readonly 
IEsquemaService (
_iEsquemaService) 9
;9 :
private 
readonly 
IMapper  
_mapper! (
;( )
public 
EsquemaController  
(  !
IEsquemaService! 0
iEsquemaService1 @
,@ A
IMapper! (
mapper) /
,/ 0
ILogger1 8
<8 9
BaseController9 G
>G H
loggerI O
)O P
:Q R
baseS W
(W X
loggerX ^
)^ _
{ 	
this 
. 
_iEsquemaService !
=" #
iEsquemaService$ 3
;3 4
this 
. 
_mapper 
= 
mapper !
;! "
} 	
[(( 	
	Authorize((	 
](( 
[)) 	
HttpGet))	 
])) 
public** 
IActionResult** 
FindAll** $
(**$ %
)**% &
{++ 	
try,, 
{-- 
return.. 
Ok.. 
(.. 
new.. 
RespuestasAPI.. +
<..+ ,
List.., 0
<..0 1

EsquemaDto..1 ;
>..; <
>..< =
{// 
Result00 
=00 
_iEsquemaService00 -
.00- .
FindAll00. 5
(005 6
)006 7
.007 8
Select008 >
(00> ?
item00? C
=>00D F
_mapper00G N
.00N O
Map00O R
<00R S

EsquemaDto00S ]
>00] ^
(00^ _
item00_ c
)00c d
)00d e
.00e f
ToList00f l
(00l m
)00m n
}11 
)11 
;11 
}22 
catch33 
(33 
	Exception33 
e33 
)33 
{44 
return55 
HandleException55 &
(55& '
e55' (
,55( )
nameof55* 0
(550 1
FindAll551 8
)558 9
)559 :
;55: ;
}66 
}77 	
[AA 	
	AuthorizeAA	 
]AA 
[BB 	
HttpGetBB	 
(BB 
$strBB 
)BB 
]BB 
publicCC 
IActionResultCC 
FindByIdCC %
(CC% &
intCC& )
idCC* ,
)CC, -
{DD 	
tryEE 
{FF 
varGG 
recordGG 
=GG 
_iEsquemaServiceGG -
.GG- .
FindByIdGG. 6
(GG6 7
idGG7 9
)GG9 :
;GG: ;
ifII 
(II 
recordII 
==II 
nullII "
)II" #
{JJ 
returnKK 
NotFoundResponseKK +
(KK+ ,

ConstantesKK, 6
.KK6 7)
MESAGGE_REGISTRO_NO_ENCOTRADOKK7 T
)KKT U
;KKU V
}LL 
returnNN 
OkNN 
(NN 
newNN 
RespuestasAPINN +
<NN+ ,

EsquemaDtoNN, 6
>NN6 7
{OO 
ResultPP 
=PP 
_mapperPP $
.PP$ %
MapPP% (
<PP( )

EsquemaDtoPP) 3
>PP3 4
(PP4 5
recordPP5 ;
)PP; <
}QQ 
)QQ 
;QQ 
}RR 
catchSS 
(SS 
	ExceptionSS 
eSS 
)SS 
{TT 
returnUU 
HandleExceptionUU &
(UU& '
eUU' (
,UU( )
nameofUU* 0
(UU0 1
FindByIdUU1 9
)UU9 :
)UU: ;
;UU; <
}VV 
}WW 	
[aa 	
	Authorizeaa	 
]aa 
[bb 	
HttpPutbb	 
(bb 
$strbb 
)bb 
]bb 
publiccc 
IActionResultcc 
Updatecc #
(cc# $
intcc$ '
idcc( *
,cc* +
[cc, -
FromBodycc- 5
]cc5 6

EsquemaDtocc7 A
dtoccB E
)ccE F
{dd 	
tryee 
{ff 
dtogg 
.gg 
	IdEsquemagg 
=gg 
idgg  "
;gg" #
varhh 
recordhh 
=hh 
_mapperhh $
.hh$ %
Maphh% (
<hh( )
Esquemahh) 0
>hh0 1
(hh1 2
dtohh2 5
)hh5 6
;hh6 7
returnjj 
Okjj 
(jj 
newjj 
RespuestasAPIjj +
<jj+ ,
booljj, 0
>jj0 1
{kk 
	IsSuccessll 
=ll 
_iEsquemaServicell  0
.ll0 1
Updatell1 7
(ll7 8
recordll8 >
)ll> ?
}mm 
)mm 
;mm 
}nn 
catchoo 
(oo 
	Exceptionoo 
eoo 
)oo 
{pp 
returnqq 
HandleExceptionqq &
(qq& '
eqq' (
,qq( )
nameofqq* 0
(qq0 1
Updateqq1 7
)qq7 8
)qq8 9
;qq9 :
}rr 
}ss 	
[|| 	
	Authorize||	 
]|| 
[}} 	
HttpPost}}	 
]}} 
public~~ 
IActionResult~~ 
Create~~ #
(~~# $
[~~$ %
FromBody~~% -
]~~- .

EsquemaDto~~/ 9
dto~~: =
)~~= >
{ 	
try
ÄÄ 
{
ÅÅ 
var
ÇÇ 
record
ÇÇ 
=
ÇÇ 
_mapper
ÇÇ $
.
ÇÇ$ %
Map
ÇÇ% (
<
ÇÇ( )
Esquema
ÇÇ) 0
>
ÇÇ0 1
(
ÇÇ1 2
dto
ÇÇ2 5
)
ÇÇ5 6
;
ÇÇ6 7
return
ÑÑ 
Ok
ÑÑ 
(
ÑÑ 
new
ÑÑ 
RespuestasAPI
ÑÑ +
<
ÑÑ+ ,
bool
ÑÑ, 0
>
ÑÑ0 1
{
ÖÖ 
	IsSuccess
ÜÜ 
=
ÜÜ 
_iEsquemaService
ÜÜ  0
.
ÜÜ0 1
Create
ÜÜ1 7
(
ÜÜ7 8
record
ÜÜ8 >
)
ÜÜ> ?
}
áá 
)
áá 
;
áá 
}
àà 
catch
ââ 
(
ââ 
	Exception
ââ 
e
ââ 
)
ââ 
{
ää 
return
ãã 
HandleException
ãã &
(
ãã& '
e
ãã' (
,
ãã( )
nameof
ãã* 0
(
ãã0 1
Create
ãã1 7
)
ãã7 8
)
ãã8 9
;
ãã9 :
}
åå 
}
çç 	
[
ññ 	
	Authorize
ññ	 
]
ññ 
[
óó 	

HttpDelete
óó	 
(
óó 
$str
óó 
)
óó 
]
óó  
public
òò 
IActionResult
òò 
Deactive
òò %
(
òò% &
int
òò& )
id
òò* ,
)
òò, -
{
ôô 	
try
öö 
{
õõ 
var
úú 
record
úú 
=
úú 
_iEsquemaService
úú -
.
úú- .
FindById
úú. 6
(
úú6 7
id
úú7 9
)
úú9 :
;
úú: ;
if
ûû 
(
ûû 
record
ûû 
==
ûû 
null
ûû "
)
ûû" #
{
üü 
return
†† 
NotFoundResponse
†† +
(
††+ ,

Constantes
††, 6
.
††6 7+
MESAGGE_REGISTRO_NO_ENCOTRADO
††7 T
)
††T U
;
††U V
}
°° 
record
££ 
.
££ 
Estado
££ 
=
££ 

Constantes
££  *
.
££* +
ESTADO_USUARIO_X
££+ ;
;
££; <
return
•• 
Ok
•• 
(
•• 
new
•• 
RespuestasAPI
•• +
<
••+ ,
bool
••, 0
>
••0 1
{
¶¶ 
	IsSuccess
ßß 
=
ßß 
_iEsquemaService
ßß  0
.
ßß0 1
Update
ßß1 7
(
ßß7 8
record
ßß8 >
)
ßß> ?
}
®® 
)
®® 
;
®® 
}
©© 
catch
™™ 
(
™™ 
	Exception
™™ 
e
™™ 
)
™™ 
{
´´ 
return
¨¨ 
HandleException
¨¨ &
(
¨¨& '
e
¨¨' (
,
¨¨( )
nameof
¨¨* 0
(
¨¨0 1
Deactive
¨¨1 9
)
¨¨9 :
)
¨¨: ;
;
¨¨; <
}
≠≠ 
}
ÆÆ 	
[
∑∑ 	
	Authorize
∑∑	 
]
∑∑ 
[
∏∏ 	

HttpDelete
∏∏	 
(
∏∏ 
Routes
∏∏ 
.
∏∏ 

VALIDACION
∏∏ %
)
∏∏% &
]
∏∏& '
public
ππ 
IActionResult
ππ =
/EliminarEsquemaVistaColumnaByIdEquemaVistaAsync
ππ L
(
ππL M
[
ππM N
FromBody
ππN V
]
ππV W'
EsquemaVistaValidacionDto
ππX q
esquemaRegistroππr Å
)ππÅ Ç
{
∫∫ 	
try
ªª 
{
ºº 
var
ΩΩ 
record
ΩΩ 
=
ΩΩ 
_iEsquemaService
ΩΩ -
.
ΩΩ- .8
*GetEsquemaVistaColumnaByIdEquemaVistaAsync
ΩΩ. X
(
ΩΩX Y
esquemaRegistro
ΩΩY h
.
ΩΩh i
IdOna
ΩΩi n
,
ΩΩn o
esquemaRegistro
ΩΩp 
.ΩΩ Ä
	IdEsquemaΩΩÄ â
)ΩΩâ ä
;ΩΩä ã
if
øø 
(
øø 
record
øø 
==
øø 
null
øø "
)
øø" #
{
¿¿ 
return
¡¡ 
NotFoundResponse
¡¡ +
(
¡¡+ ,

Constantes
¡¡, 6
.
¡¡6 7+
MESAGGE_REGISTRO_NO_ENCOTRADO
¡¡7 T
)
¡¡T U
;
¡¡U V
}
¬¬ 
record
ƒƒ 
.
ƒƒ 
Estado
ƒƒ 
=
ƒƒ 

Constantes
ƒƒ  *
.
ƒƒ* +
ESTADO_USUARIO_X
ƒƒ+ ;
;
ƒƒ; <
var
∆∆ 
	isDeleted
∆∆ 
=
∆∆ 
_iEsquemaService
∆∆  0
.
∆∆0 1=
/EliminarEsquemaVistaColumnaByIdEquemaVistaAsync
∆∆1 `
(
∆∆` a
record
∆∆a g
.
∆∆g h
IdEsquemaVista
∆∆h v
)
∆∆v w
;
∆∆w x
return
»» 
Ok
»» 
(
»» 
new
»» 
RespuestasAPI
»» +
<
»»+ ,
bool
»», 0
>
»»0 1
{
…… 
	IsSuccess
   
=
   
	isDeleted
    )
}
ÀÀ 
)
ÀÀ 
;
ÀÀ 
}
ÃÃ 
catch
ÕÕ 
(
ÕÕ 
	Exception
ÕÕ 
e
ÕÕ 
)
ÕÕ 
{
ŒŒ 
return
œœ 
HandleException
œœ &
(
œœ& '
e
œœ' (
,
œœ( )
nameof
œœ* 0
(
œœ0 1=
/EliminarEsquemaVistaColumnaByIdEquemaVistaAsync
œœ1 `
)
œœ` a
)
œœa b
;
œœb c
}
–– 
}
—— 	
[
⁄⁄ 	
	Authorize
⁄⁄	 
]
⁄⁄ 
[
€€ 	
Route
€€	 
(
€€ 
Routes
€€ 
.
€€ &
VALIDACION_ACTUALIZACION
€€ .
)
€€. /
]
€€/ 0
[
‹‹ 	
HttpPut
‹‹	 
]
‹‹ 
public
›› 
IActionResult
›› %
UpdateEsquemaValidacion
›› 4
(
››4 5
[
››5 6
FromBody
››6 >
]
››> ?'
EsquemaVistaValidacionDto
››@ Y
dto
››Z ]
)
››] ^
{
ﬁﬁ 	
try
ﬂﬂ 
{
‡‡ 
var
·· 
record
·· 
=
·· 
_mapper
·· $
.
··$ %
Map
··% (
<
··( )
EsquemaVista
··) 5
>
··5 6
(
··6 7
dto
··7 :
)
··: ;
;
··; <
return
„„ 
Ok
„„ 
(
„„ 
new
„„ 
RespuestasAPI
„„ +
<
„„+ ,
bool
„„, 0
>
„„0 1
{
‰‰ 
	IsSuccess
ÂÂ 
=
ÂÂ 
_iEsquemaService
ÂÂ  0
.
ÂÂ0 1%
UpdateEsquemaValidacion
ÂÂ1 H
(
ÂÂH I
record
ÂÂI O
)
ÂÂO P
}
ÊÊ 
)
ÊÊ 
;
ÊÊ 
}
ÁÁ 
catch
ËË 
(
ËË 
	Exception
ËË 
e
ËË 
)
ËË 
{
ÈÈ 
return
ÍÍ 
HandleException
ÍÍ &
(
ÍÍ& '
e
ÍÍ' (
,
ÍÍ( )
nameof
ÍÍ* 0
(
ÍÍ0 1%
UpdateEsquemaValidacion
ÍÍ1 H
)
ÍÍH I
)
ÍÍI J
;
ÍÍJ K
}
ÎÎ 
}
ÏÏ 	
[
ıı 	
	Authorize
ıı	 
]
ıı 
[
ˆˆ 	
Route
ˆˆ	 
(
ˆˆ 
Routes
ˆˆ 
.
ˆˆ 

VALIDACION
ˆˆ  
)
ˆˆ  !
]
ˆˆ! "
[
˜˜ 	
HttpPost
˜˜	 
]
˜˜ 
public
¯¯ 
IActionResult
¯¯ %
CreateEsquemaValidacion
¯¯ 4
(
¯¯4 5
[
¯¯5 6
FromBody
¯¯6 >
]
¯¯> ?'
EsquemaVistaValidacionDto
¯¯@ Y
dto
¯¯Z ]
)
¯¯] ^
{
˘˘ 	
try
˙˙ 
{
˚˚ 
var
¸¸ 
record
¸¸ 
=
¸¸ 
_mapper
¸¸ $
.
¸¸$ %
Map
¸¸% (
<
¸¸( )
EsquemaVista
¸¸) 5
>
¸¸5 6
(
¸¸6 7
dto
¸¸7 :
)
¸¸: ;
;
¸¸; <
return
˛˛ 
Ok
˛˛ 
(
˛˛ 
new
˛˛ 
RespuestasAPI
˛˛ +
<
˛˛+ ,
bool
˛˛, 0
>
˛˛0 1
{
ˇˇ 
	IsSuccess
ÄÄ 
=
ÄÄ 
_iEsquemaService
ÄÄ  0
.
ÄÄ0 1%
CreateEsquemaValidacion
ÄÄ1 H
(
ÄÄH I
record
ÄÄI O
)
ÄÄO P
}
ÅÅ 
)
ÅÅ 
;
ÅÅ 
}
ÇÇ 
catch
ÉÉ 
(
ÉÉ 
	Exception
ÉÉ 
e
ÉÉ 
)
ÉÉ 
{
ÑÑ 
return
ÖÖ 
HandleException
ÖÖ &
(
ÖÖ& '
e
ÖÖ' (
,
ÖÖ( )
nameof
ÖÖ* 0
(
ÖÖ0 1%
CreateEsquemaValidacion
ÖÖ1 H
)
ÖÖH I
)
ÖÖI J
;
ÖÖJ K
}
ÜÜ 
}
áá 	
[
ìì 	
	Authorize
ìì	 
]
ìì 
[
îî 	
Route
îî	 
(
îî 
Routes
îî 
.
îî 
VISTA_COLUMNA
îî #
)
îî# $
]
îî$ %
[
ïï 	
HttpPost
ïï	 
]
ïï 
public
ññ 
IActionResult
ññ -
GuardarListaEsquemaVistaColumna
ññ <
(
ññ< =
[
óó 
FromBody
óó 
]
óó 
List
óó 
<
óó $
EsquemaVistaColumnaDto
óó 2
>
óó2 3&
listaEsquemaVistaColumna
óó4 L
,
óóL M
[
òò 
	FromQuery
òò 
]
òò 
int
òò 
idOna
òò !
,
òò! "
[
ôô 
	FromQuery
ôô 
]
ôô 
int
ôô 
	idEsquema
ôô %
)
ôô% &
{
öö 	
try
õõ 
{
úú 
var
ùù 
record
ùù 
=
ùù 
_mapper
ùù $
.
ùù$ %
Map
ùù% (
<
ùù( )
List
ùù) -
<
ùù- .!
EsquemaVistaColumna
ùù. A
>
ùùA B
>
ùùB C
(
ùùC D&
listaEsquemaVistaColumna
ùùD \
)
ùù\ ]
;
ùù] ^
return
üü 
Ok
üü 
(
üü 
new
üü 
RespuestasAPI
üü +
<
üü+ ,
bool
üü, 0
>
üü0 1
{
†† 
	IsSuccess
°° 
=
°° 
_iEsquemaService
°°  0
.
°°0 1-
GuardarListaEsquemaVistaColumna
°°1 P
(
°°P Q
record
°°Q W
,
°°W X
idOna
°°Y ^
,
°°^ _
	idEsquema
°°` i
)
°°i j
}
¢¢ 
)
¢¢ 
;
¢¢ 
}
££ 
catch
§§ 
(
§§ 
	Exception
§§ 
e
§§ 
)
§§ 
{
•• 
return
¶¶ 
HandleException
¶¶ &
(
¶¶& '
e
¶¶' (
,
¶¶( )
nameof
¶¶* 0
(
¶¶0 1-
GuardarListaEsquemaVistaColumna
¶¶1 P
)
¶¶P Q
)
¶¶Q R
;
¶¶R S
}
ßß 
}
®® 	
[
≤≤ 	
	Authorize
≤≤	 
]
≤≤ 
[
≥≥ 	
HttpGet
≥≥	 
(
≥≥ 
Routes
≥≥ 
.
≥≥ 

ESQUEMA_ID
≥≥ "
,
≥≥" #
Name
≥≥$ (
=
≥≥) *
$str
≥≥+ A
)
≥≥A B
]
≥≥B C
public
¥¥ 
IActionResult
¥¥ "
GetListaEsquemaByOna
¥¥ 1
(
¥¥1 2
int
¥¥2 5
idOna
¥¥6 ;
)
¥¥; <
{
µµ 	
try
∂∂ 
{
∑∑ 
var
∏∏ 
result
∏∏ 
=
∏∏ 
_iEsquemaService
∏∏ -
.
∏∏- ."
GetListaEsquemaByOna
∏∏. B
(
∏∏B C
idOna
∏∏C H
)
∏∏H I
;
∏∏I J
return
ππ 
Ok
ππ 
(
ππ 
new
ππ 
RespuestasAPI
ππ +
<
ππ+ ,
List
ππ, 0
<
ππ0 1
Esquema
ππ1 8
>
ππ8 9
>
ππ9 :
{
ππ; <
Result
ππ= C
=
ππD E
result
ππF L
}
ππM N
)
ππN O
;
ππO P
}
∫∫ 
catch
ªª 
(
ªª 
	Exception
ªª 
e
ªª 
)
ªª 
{
ºº 
return
ΩΩ 
HandleException
ΩΩ &
(
ΩΩ& '
e
ΩΩ' (
,
ΩΩ( )
nameof
ΩΩ* 0
(
ΩΩ0 1"
GetListaEsquemaByOna
ΩΩ1 E
)
ΩΩE F
)
ΩΩF G
;
ΩΩG H
}
ææ 
}
øø 	
}
¬¬ 
}√√ Û
LC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\EmailController.cs
	namespace 	
WebApp
 
. 
Controllers 
{		 
[

 
	Authorize

 
]

 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class 
EmailController  
:! "
BaseController# 1
{ 
private 
readonly 
IEmailService &
_emailService' 4
;4 5
public 
EmailController 
( 
IEmailService ,
emailService- 9
,9 :
ILogger &
<& '
BaseController' 5
>5 6
logger7 =
)= >
:> ?
base@ D
(D E
loggerE K
)K L
{ 	
this 
. 
_emailService 
=  
emailService! -
;- .
} 	
[ 	
HttpPost	 
( 
Routes 
. 
ENVIAR 
)  
]  !
public 
async 
Task 
< 
IActionResult '
>' (
EnviarCorreoRol) 8
(8 9
[9 :
FromBody: B
]B C
EmailDtoD L
emailM R
)R S
{T U
try 
{ 
var   
result   
=   
await   "
_emailService  # 0
.  0 1
SendEmailAsync  1 ?
(  ? @
$str  @ B
,  B C
$str  D F
,  F G
$str  H J
)  J K
;  K L
return!! 
Ok!! 
(!! 
new!! 
RespuestasAPI!! +
<!!+ ,
bool!!, 0
>!!0 1
(!!1 2
)!!2 3
{!!4 5
Result!!6 <
=!!= >
result!!? E
}!!F G
)!!G H
;!!H I
}"" 
catch## 
(## 
	Exception## 
e## 
)## 
{$$ 
return%% 
HandleException%% &
(%%& '
e%%' (
,%%( )
nameof%%* 0
(%%0 1
EnviarCorreoRol%%1 @
)%%@ A
)%%A B
;%%B C
}&& 
}'' 	
}** 
}++ æV
NC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\DynamicController.cs
	namespace		 	
WebApp		
 
.		 
Controllers		 
{

 
[ 
AllowAnonymous 
] 
[ 
Route 

(
 
Routes 
. 
DYNAMIC 
) 
] 
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class 
DynamicController "
:# $
BaseController% 3
{ 
private 
readonly 
IDynamicService (
_dynamicService) 8
;8 9
public 
DynamicController  
(  !
IDynamicService! 0
dynamicService1 ?
,? @
ILoggerA H
<H I
BaseControllerI W
>W X
loggerY _
)_ `
:a b
basec g
(g h
loggerh n
)n o
{ 	
_dynamicService 
= 
dynamicService ,
;, -
} 	
[%% 	
HttpGet%%	 
(%% 
Routes%% 
.%% 
GETPROPERTIES%% %
,%%% &
Name%%' +
=%%, -
$str%%. =
)%%= >
]%%> ?
public&& 
IActionResult&& 
GetProperties&& *
(&&* +
int&&+ .
idOna&&/ 4
,&&4 5
string&&6 <
viewName&&= E
)&&E F
{'' 	
try(( 
{)) 
var** 
result** 
=** 
_dynamicService** ,
.**, -
GetProperties**- :
(**: ;
idOna**; @
,**@ A
viewName**B J
)**J K
;**K L
return++ 
Ok++ 
(++ 
new++ 
RespuestasAPI++ +
<+++ ,
List++, 0
<++0 1
PropiedadesTablaDto++1 D
>++D E
>++E F
{++G H
Result++I O
=++P Q
result++R X
}++Y Z
)++Z [
;++[ \
},, 
catch-- 
(-- 
	Exception-- 
e-- 
)-- 
{.. 
return// 
HandleException// &
(//& '
e//' (
,//( )
nameof//* 0
(//0 1
GetProperties//1 >
)//> ?
)//? @
;//@ A
}00 
}11 	
[?? 	
HttpGet??	 
(?? 
Routes?? 
.?? 
GETVALUECOLUMNA?? '
,??' (
Name??) -
=??. /
$str??0 A
)??A B
]??B C
public@@ 
IActionResult@@ 
GetValueColumna@@ ,
(@@, -
int@@- 0
idONA@@1 6
,@@6 7
string@@8 >
valueColumn@@? J
,@@J K
string@@L R
viewName@@S [
)@@[ \
{AA 	
tryBB 
{CC 
varDD 
resultDD 
=DD 
_dynamicServiceDD ,
.DD, -
GetValueColumnaDD- <
(DD< =
idONADD= B
,DDB C
valueColumnDDD O
,DDO P
viewNameDDQ Y
)DDY Z
;DDZ [
returnEE 
OkEE 
(EE 
newEE 
RespuestasAPIEE +
<EE+ ,
ListEE, 0
<EE0 1
PropiedadesTablaDtoEE1 D
>EED E
>EEE F
{EEG H
ResultEEI O
=EEP Q
resultEER X
}EEY Z
)EEZ [
;EE[ \
}FF 
catchGG 
(GG 
	ExceptionGG 
eGG 
)GG 
{HH 
returnII 
HandleExceptionII &
(II& '
eII' (
,II( )
nameofII* 0
(II0 1
GetValueColumnaII1 @
)II@ A
)IIA B
;IIB C
}JJ 
}KK 	
[UU 	
HttpGetUU	 
(UU 
$strUU 
,UU 
NameUU  
=UU! "
$strUU# 1
)UU1 2
]UU2 3
publicVV 
IActionResultVV 
GetViewNamesVV )
(VV) *
intVV* -
idOnaVV. 3
)VV3 4
{WW 	
tryXX 
{YY 
varZZ 
resultZZ 
=ZZ 
_dynamicServiceZZ ,
.ZZ, -
GetViewNamesZZ- 9
(ZZ9 :
idOnaZZ: ?
)ZZ? @
;ZZ@ A
return[[ 
Ok[[ 
([[ 
new[[ 
RespuestasAPI[[ +
<[[+ ,
List[[, 0
<[[0 1
string[[1 7
>[[7 8
>[[8 9
{[[: ;
Result[[< B
=[[C D
result[[E K
}[[L M
)[[M N
;[[N O
}\\ 
catch]] 
(]] 
	Exception]] 
e]] 
)]] 
{^^ 
return__ 
HandleException__ &
(__& '
e__' (
,__( )
nameof__* 0
(__0 1
GetViewNames__1 =
)__= >
)__> ?
;__? @
}`` 
}aa 	
[ll 	
HttpGetll	 
(ll 
Routesll 
.ll %
GETLISTAVALIDACIONESQUEMAll 1
,ll1 2
Namell3 7
=ll8 9
$strll: U
)llU V
]llV W
publicmm 
IActionResultmm %
GetListaValidacionEsquemamm 6
(mm6 7
intmm7 :
idOnamm; @
,mm@ A
intmmB E
	idEsquemammF O
)mmO P
{nn 	
tryoo 
{pp 
varqq 
resultqq 
=qq 
_dynamicServiceqq ,
.qq, -%
GetListaValidacionEsquemaqq- F
(qqF G
idOnaqqG L
,qqL M
	idEsquemaqqN W
)qqW X
;qqX Y
returnrr 
Okrr 
(rr 
newrr 
RespuestasAPIrr +
<rr+ ,
Listrr, 0
<rr0 1
EsquemaVistaDtorr1 @
>rr@ A
>rrA B
{rrC D
ResultrrE K
=rrL M
resultrrN T
}rrU V
)rrV W
;rrW X
}ss 
catchtt 
(tt 
	Exceptiontt 
ett 
)tt 
{uu 
returnvv 
HandleExceptionvv &
(vv& '
evv' (
,vv( )
nameofvv* 0
(vv0 1%
GetListaValidacionEsquemavv1 J
)vvJ K
)vvK L
;vvL M
}ww 
}xx 	
[
ÇÇ 	
HttpGet
ÇÇ	 
(
ÇÇ 
Routes
ÇÇ 
.
ÇÇ 
TEST
ÇÇ 
)
ÇÇ 
]
ÇÇ 
public
ÉÉ 
IActionResult
ÉÉ 
TestConnection
ÉÉ +
(
ÉÉ+ ,
int
ÉÉ, /
idOna
ÉÉ0 5
)
ÉÉ5 6
{
ÑÑ 	
try
ÖÖ 
{
ÜÜ 
var
áá 
conexion
áá 
=
áá 
_dynamicService
áá .
.
áá. /
GetConexion
áá/ :
(
áá: ;
idOna
áá; @
)
áá@ A
;
ááA B
if
àà 
(
àà 
conexion
àà 
==
àà 
null
àà  $
)
àà$ %
{
ââ 
return
ää 
NotFound
ää #
(
ää# $
new
ää$ '
{
ää( )
Message
ää* 1
=
ää2 3
$str
ää4 M
}
ääN O
)
ääO P
;
ääP Q
}
ãã 
var
çç 
isConnected
çç 
=
çç  !
_dynamicService
çç" 1
.
çç1 2$
TestDatabaseConnection
çç2 H
(
ççH I
conexion
ççI Q
)
ççQ R
;
ççR S
return
èè 
Ok
èè 
(
èè 
new
èè 
{
êê 
	IsSuccess
ëë 
=
ëë 
isConnected
ëë  +
,
ëë+ ,
Message
íí 
=
íí 
isConnected
íí )
?
íí* +
$str
íí, Q
:
ííR S
$str
ííT x
}
ìì 
)
ìì 
;
ìì 
}
îî 
catch
ïï 
(
ïï 
	Exception
ïï 
ex
ïï 
)
ïï  
{
ññ 
return
óó 

StatusCode
óó !
(
óó! "
$num
óó" %
,
óó% &
new
óó' *
{
óó+ ,
Message
óó- 4
=
óó5 6
$"
óó7 9
$str
óó9 @
{
óó@ A
ex
óóA C
.
óóC D
Message
óóD K
}
óóK L
"
óóL M
}
óóN O
)
óóO P
;
óóP Q
}
òò 
}
ôô 	
[
££ 	
HttpPost
££	 
(
££ 
Routes
££ 
.
££ 
MIGRAR
££ 
)
££  
]
££  !
public
§§ 
async
§§ 
Task
§§ 
<
§§ 
IActionResult
§§ '
>
§§' (
MigrarConexion
§§) 7
(
§§7 8
int
§§8 ;
idOna
§§< A
)
§§A B
{
•• 	
try
¶¶ 
{
ßß 
bool
®® 
	resultado
®® 
=
®®  
await
®®! &
_dynamicService
®®' 6
.
®®6 7!
MigrarConexionAsync
®®7 J
(
®®J K
idOna
®®K P
)
®®P Q
;
®®Q R
return
™™ 
Ok
™™ 
(
™™ 
new
™™ 
{
´´ 
	IsSuccess
¨¨ 
=
¨¨ 
	resultado
¨¨  )
,
¨¨) *
Message
≠≠ 
=
≠≠ 
	resultado
≠≠ '
?
≠≠( )
$str
≠≠* K
:
≠≠L M
$str
≠≠N n
}
ÆÆ 
)
ÆÆ 
;
ÆÆ 
}
ØØ 
catch
∞∞ 
(
∞∞ 
	Exception
∞∞ 
ex
∞∞ 
)
∞∞  
{
±± 
return
≤≤ 

StatusCode
≤≤ !
(
≤≤! "
StatusCodes
≤≤" -
.
≤≤- .*
Status500InternalServerError
≤≤. J
,
≤≤J K
new
≤≤L O
{
≤≤P Q
Success
≤≤R Y
=
≤≤Z [
false
≤≤\ a
,
≤≤a b
Message
≤≤c j
=
≤≤k l
ex
≤≤m o
.
≤≤o p
Message
≤≤p w
}
≤≤x y
)
≤≤y z
;
≤≤z {
}
≥≥ 
}
¥¥ 	
}
∑∑ 
}∏∏ òÇ
PC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\CatalogosController.cs
	namespace

 	
WebApp


 
.

 
Controllers

 
{ 
[ 
AllowAnonymous 
] 
[ 
Route 

(
 
Routes 
. 
	CATALOGOS 
) 
] 
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
public 

class 
CatalogosController $
:% &
BaseController' 5
{ 
private 
readonly 
ICatalogosService *
_iCatalogosService+ =
;= >
public 
CatalogosController "
(" #
ICatalogosService# 4
iCatalogosService5 F
,F G
ILoggerH O
<O P
CatalogosControllerP c
>c d
loggere k
)k l
:m n
baseo s
(s t
loggert z
)z {
{ 	
this 
. 
_iCatalogosService #
=$ %
iCatalogosService& 7
;7 8
} 	
[%% 	
HttpGet%%	 
(%% 
Routes%% 
.%% 
GRID_SCHEMA%% #
)%%# $
]%%$ %
public&& 
IActionResult&& 
ObtenerVwGrilla&& ,
(&&, -
)&&- .
{'' 	
try(( 
{)) 
return** 
Ok** 
(** 
new** 
RespuestasAPI** +
<**+ ,
List**, 0
<**0 1
VwGrillaDto**1 <
>**< =
>**= >
{++ 
Result,, 
=,, 
_iCatalogosService,, /
.,,/ 0
ObtenerVwGrilla,,0 ?
(,,? @
),,@ A
}-- 
)-- 
;-- 
}.. 
catch// 
(// 
	Exception// 
e// 
)// 
{00 
return11 

StatusCode11 !
(11! "
$num11" %
,11% &
new11' *
{11+ ,
mensaje11- 4
=115 6
$str117 F
,11F G
detalle11H O
=11P Q
e11R S
.11S T
Message11T [
}11\ ]
)11] ^
;11^ _
}22 
}33 	
[<< 	
HttpGet<<	 
(<< 
Routes<< 
.<< 
FILTERS_SCHEMA<< &
)<<& '
]<<' (
public== 
IActionResult== 
ObtenerVwFiltro== ,
(==, -
)==- .
{>> 	
try?? 
{@@ 
returnAA 
OkAA 
(AA 
newAA 
RespuestasAPIAA +
<AA+ ,
ListAA, 0
<AA0 1
VwFiltroDtoAA1 <
>AA< =
>AA= >
{BB 
ResultCC 
=CC 
_iCatalogosServiceCC /
.CC/ 0
ObtenerVwFiltroCC0 ?
(CC? @
)CC@ A
}DD 
)DD 
;DD 
}EE 
catchFF 
(FF 
	ExceptionFF 
eFF 
)FF 
{GG 
returnHH 
HandleExceptionHH &
(HH& '
eHH' (
,HH( )
nameofHH* 0
(HH0 1
ObtenerVwFiltroHH1 @
)HH@ A
)HHA B
;HHB C
}II 
}JJ 	
[TT 	
HttpGetTT	 
(TT 
$"TT 
{TT 
RoutesTT 
.TT 
FILTERS_DATATT '
}TT' (
$strTT( 3
"TT3 4
)TT4 5
]TT5 6
publicUU 
IActionResultUU !
ObtenerFiltroDetallesUU 2
(UU2 3
stringUU3 9
codigoUU: @
)UU@ A
{VV 	
tryWW 
{XX 
returnYY 
OkYY 
(YY 
newYY 
RespuestasAPIYY +
<YY+ ,
ListYY, 0
<YY0 1
vwFiltroDetalleDtoYY1 C
>YYC D
>YYD E
{ZZ 
Result[[ 
=[[ 
_iCatalogosService[[ /
.[[/ 0!
ObtenerFiltroDetalles[[0 E
([[E F
codigo[[F L
)[[L M
}\\ 
)\\ 
;\\ 
}]] 
catch^^ 
(^^ 
	Exception^^ 
e^^ 
)^^ 
{__ 
return`` 
HandleException`` &
(``& '
e``' (
,``( )
nameof``* 0
(``0 1!
ObtenerFiltroDetalles``1 F
)``F G
)``G H
;``H I
}aa 
}bb 	
[kk 	
HttpGetkk	 
(kk 
Routeskk 
.kk 
DIMENSION_SCHEMAkk (
)kk( )
]kk) *
publicll 
IActionResultll 
ObtenerVwDimensionll /
(ll/ 0
)ll0 1
{mm 	
trynn 
{oo 
returnpp 
Okpp 
(pp 
newpp 
RespuestasAPIpp +
<pp+ ,
Listpp, 0
<pp0 1
VwDimensionDtopp1 ?
>pp? @
>pp@ A
{qq 
Resultrr 
=rr 
_iCatalogosServicerr /
.rr/ 0
ObtenerVwDimensionrr0 B
(rrB C
)rrC D
}ss 
)ss 
;ss 
}tt 
catchuu 
(uu 
	Exceptionuu 
euu 
)uu 
{vv 
returnww 
HandleExceptionww &
(ww& '
eww' (
,ww( )
nameofww* 0
(ww0 1
ObtenerVwDimensionww1 C
)wwC D
)wwD E
;wwE F
}xx 
}yy 	
[
ÇÇ 	
HttpGet
ÇÇ	 
(
ÇÇ 
Routes
ÇÇ 
.
ÇÇ 
GRUPOS
ÇÇ 
)
ÇÇ 
]
ÇÇ  
public
ÉÉ 
IActionResult
ÉÉ 
ObtenerGrupos
ÉÉ *
(
ÉÉ* +
)
ÉÉ+ ,
{
ÑÑ 	
try
ÖÖ 
{
ÜÜ 
return
áá 
Ok
áá 
(
áá 
new
áá 
RespuestasAPI
áá +
<
áá+ ,
List
áá, 0
<
áá0 1$
VwHomologacionGrupoDto
áá1 G
>
ááG H
>
ááH I
{
àà 
Result
ââ 
=
ââ  
_iCatalogosService
ââ /
.
ââ/ 0(
ObtenerVwHomologacionGrupo
ââ0 J
(
ââJ K
)
ââK L
}
ää 
)
ää 
;
ää 
}
ãã 
catch
åå 
(
åå 
	Exception
åå 
e
åå 
)
åå 
{
çç 
return
éé 
HandleException
éé &
(
éé& '
e
éé' (
,
éé( )
nameof
éé* 0
(
éé0 1
ObtenerGrupos
éé1 >
)
éé> ?
)
éé? @
;
éé@ A
}
èè 
}
êê 	
[
öö 	
HttpGet
öö	 
(
öö 
Routes
öö 
.
öö 
ROLES
öö 
)
öö 
]
öö 
public
õõ 
IActionResult
õõ 
ObtenerVwRol
õõ )
(
õõ) *
)
õõ* +
{
úú 	
try
ùù 
{
ûû 
return
üü 
Ok
üü 
(
üü 
new
üü 
RespuestasAPI
üü +
<
üü+ ,
List
üü, 0
<
üü0 1
VwRolDto
üü1 9
>
üü9 :
>
üü: ;
{
†† 
Result
°° 
=
°°  
_iCatalogosService
°° /
.
°°/ 0
ObtenerVwRol
°°0 <
(
°°< =
)
°°= >
}
¢¢ 
)
¢¢ 
;
¢¢ 
}
££ 
catch
§§ 
(
§§ 
	Exception
§§ 
e
§§ 
)
§§ 
{
•• 
return
¶¶ 
HandleException
¶¶ &
(
¶¶& '
e
¶¶' (
,
¶¶( )
nameof
¶¶* 0
(
¶¶0 1
ObtenerVwRol
¶¶1 =
)
¶¶= >
)
¶¶> ?
;
¶¶? @
}
ßß 
}
®® 	
[
±± 	
HttpGet
±±	 
(
±± 
Routes
±± 
.
±± 
ONAS
±± 
)
±± 
]
±± 
public
≤≤ 
IActionResult
≤≤ 

ObtenerOna
≤≤ '
(
≤≤' (
)
≤≤( )
{
≥≥ 	
try
¥¥ 
{
µµ 
return
∂∂ 
Ok
∂∂ 
(
∂∂ 
new
∂∂ 
RespuestasAPI
∂∂ +
<
∂∂+ ,
List
∂∂, 0
<
∂∂0 1
OnaDto
∂∂1 7
>
∂∂7 8
>
∂∂8 9
{
∑∑ 
Result
∏∏ 
=
∏∏  
_iCatalogosService
∏∏ /
.
∏∏/ 0

ObtenerOna
∏∏0 :
(
∏∏: ;
)
∏∏; <
}
ππ 
)
ππ 
;
ππ 
}
∫∫ 
catch
ªª 
(
ªª 
	Exception
ªª 
e
ªª 
)
ªª 
{
ºº 
return
ΩΩ 
HandleException
ΩΩ &
(
ΩΩ& '
e
ΩΩ' (
,
ΩΩ( )
nameof
ΩΩ* 0
(
ΩΩ0 1

ObtenerOna
ΩΩ1 ;
)
ΩΩ; <
)
ΩΩ< =
;
ΩΩ= >
}
ææ 
}
øø 	
[
   	
HttpGet
  	 
(
   
Routes
   
.
   
MENU_CATALOGO
   %
)
  % &
]
  & '
public
ÀÀ 
IActionResult
ÀÀ 
ObtenerVwMenu
ÀÀ *
(
ÀÀ* +
)
ÀÀ+ ,
{
ÃÃ 	
try
ÕÕ 
{
ŒŒ 
return
œœ 
Ok
œœ 
(
œœ 
new
œœ 
RespuestasAPI
œœ +
<
œœ+ ,
List
œœ, 0
<
œœ0 1
	VwMenuDto
œœ1 :
>
œœ: ;
>
œœ; <
{
–– 
Result
—— 
=
——  
_iCatalogosService
—— /
.
——/ 0
ObtenerVwMenu
——0 =
(
——= >
)
——> ?
}
““ 
)
““ 
;
““ 
}
”” 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘ 
e
‘‘ 
)
‘‘ 
{
’’ 
return
÷÷ 
HandleException
÷÷ &
(
÷÷& '
e
÷÷' (
,
÷÷( )
nameof
÷÷* 0
(
÷÷0 1
ObtenerVwMenu
÷÷1 >
)
÷÷> ?
)
÷÷? @
;
÷÷@ A
}
◊◊ 
}
ÿÿ 	
[
·· 	
HttpGet
··	 
(
·· 
Routes
·· 
.
·· 
PANEL
·· 
)
·· 
]
·· 
public
‚‚ 
IActionResult
‚‚ 
ObtenerPanelOna
‚‚ ,
(
‚‚, -
)
‚‚- .
{
„„ 	
try
‰‰ 
{
ÂÂ 
return
ÊÊ 
Ok
ÊÊ 
(
ÊÊ 
new
ÊÊ 
RespuestasAPI
ÊÊ +
<
ÊÊ+ ,
List
ÊÊ, 0
<
ÊÊ0 1
vwPanelONADto
ÊÊ1 >
>
ÊÊ> ?
>
ÊÊ? @
{
ÁÁ 
Result
ËË 
=
ËË  
_iCatalogosService
ËË /
.
ËË/ 0
ObtenerVwPanelOna
ËË0 A
(
ËËA B
)
ËËB C
}
ÈÈ 
)
ÈÈ 
;
ÈÈ 
}
ÍÍ 
catch
ÎÎ 
(
ÎÎ 
	Exception
ÎÎ 
e
ÎÎ 
)
ÎÎ 
{
ÏÏ 
return
ÌÌ 
HandleException
ÌÌ &
(
ÌÌ& '
e
ÌÌ' (
,
ÌÌ( )
nameof
ÌÌ* 0
(
ÌÌ0 1
ObtenerPanelOna
ÌÌ1 @
)
ÌÌ@ A
)
ÌÌA B
;
ÌÌB C
}
ÓÓ 
}
ÔÔ 	
[
¯¯ 	
HttpGet
¯¯	 
(
¯¯ 
Routes
¯¯ 
.
¯¯ "
ESQUEMA_ORGANIZACION
¯¯ ,
)
¯¯, -
]
¯¯- .
public
˘˘ 
IActionResult
˘˘ $
ObtenerEsquemaOrganiza
˘˘ 3
(
˘˘3 4
)
˘˘4 5
{
˙˙ 	
try
˚˚ 
{
¸¸ 
return
˝˝ 
Ok
˝˝ 
(
˝˝ 
new
˝˝ 
RespuestasAPI
˝˝ +
<
˝˝+ ,
List
˝˝, 0
<
˝˝0 1"
vwEsquemaOrganizaDto
˝˝1 E
>
˝˝E F
>
˝˝F G
{
˛˛ 
Result
ˇˇ 
=
ˇˇ  
_iCatalogosService
ˇˇ /
.
ˇˇ/ 0&
ObtenervwEsquemaOrganiza
ˇˇ0 H
(
ˇˇH I
)
ˇˇI J
}
ÄÄ 
)
ÄÄ 
;
ÄÄ 
}
ÅÅ 
catch
ÇÇ 
(
ÇÇ 
	Exception
ÇÇ 
e
ÇÇ 
)
ÇÇ 
{
ÉÉ 
return
ÑÑ 
HandleException
ÑÑ &
(
ÑÑ& '
e
ÑÑ' (
,
ÑÑ( )
nameof
ÑÑ* 0
(
ÑÑ0 1$
ObtenerEsquemaOrganiza
ÑÑ1 G
)
ÑÑG H
)
ÑÑH I
;
ÑÑI J
}
ÖÖ 
}
ÜÜ 	
[
èè 	
HttpGet
èè	 
(
èè 
Routes
èè 
.
èè 
VW_ONA
èè 
)
èè 
]
èè  
public
êê 
IActionResult
êê 
ObtenerVwOna
êê )
(
êê) *
)
êê* +
{
ëë 	
try
íí 
{
ìì 
return
îî 
Ok
îî 
(
îî 
new
îî 
RespuestasAPI
îî +
<
îî+ ,
List
îî, 0
<
îî0 1
vwONADto
îî1 9
>
îî9 :
>
îî: ;
{
ïï 
Result
ññ 
=
ññ  
_iCatalogosService
ññ /
.
ññ/ 0
ObtenervwOna
ññ0 <
(
ññ< =
)
ññ= >
}
óó 
)
óó 
;
óó 
}
òò 
catch
ôô 
(
ôô 
	Exception
ôô 
e
ôô 
)
ôô 
{
öö 
return
õõ 
HandleException
õõ &
(
õõ& '
e
õõ' (
,
õõ( )
nameof
õõ* 0
(
õõ0 1
ObtenerVwOna
õõ1 =
)
õõ= >
)
õõ> ?
;
õõ? @
}
úú 
}
ùù 	
[
¶¶ 	
HttpPost
¶¶	 
(
¶¶ 
Routes
¶¶ 
.
¶¶ 
FILTERS_ANINADOS
¶¶ )
)
¶¶) *
]
¶¶* +
public
ßß 
IActionResult
ßß $
ObtenerFiltrosAnidados
ßß 3
(
ßß3 4
[
ßß4 5
FromBody
ßß5 =
]
ßß= >
List
ßß? C
<
ßßC D)
FiltrosBusquedaSeleccionDto
ßßD _
>
ßß_ `"
filtrosSeleccionados
ßßa u
)
ßßu v
{
®® 	
try
©© 
{
™™ 
var
´´ 
	resultado
´´ 
=
´´  
_iCatalogosService
´´  2
.
´´2 3$
ObtenerFiltrosAnidados
´´3 I
(
´´I J"
filtrosSeleccionados
´´J ^
)
´´^ _
;
´´_ `
return
¨¨ 
Ok
¨¨ 
(
¨¨ 
	resultado
¨¨ #
)
¨¨# $
;
¨¨$ %
}
≠≠ 
catch
ÆÆ 
(
ÆÆ 
	Exception
ÆÆ 
e
ÆÆ 
)
ÆÆ 
{
ØØ 
return
∞∞ 
HandleException
∞∞ &
(
∞∞& '
e
∞∞' (
,
∞∞( )
nameof
∞∞* 0
(
∞∞0 1$
ObtenerFiltrosAnidados
∞∞1 G
)
∞∞G H
)
∞∞H I
;
∞∞I J
}
±± 
}
≤≤ 	
[
ªª 	
HttpGet
ªª	 
(
ªª 
Routes
ªª 
.
ªª 
ANINADOS
ªª  
)
ªª  !
]
ªª! "
public
ºº 
IActionResult
ºº '
ObtenerFiltrosAnidadosAll
ºº 6
(
ºº6 7
)
ºº7 8
{
ΩΩ 	
try
ææ 
{
øø 
var
¿¿ 
	resultado
¿¿ 
=
¿¿  
_iCatalogosService
¿¿  2
.
¿¿2 3'
ObtenerFiltrosAnidadosAll
¿¿3 L
(
¿¿L M
)
¿¿M N
;
¿¿N O
return
¡¡ 
Ok
¡¡ 
(
¡¡ 
	resultado
¡¡ #
)
¡¡# $
;
¡¡$ %
}
¬¬ 
catch
√√ 
(
√√ 
	Exception
√√ 
e
√√ 
)
√√ 
{
ƒƒ 
return
≈≈ 

StatusCode
≈≈ !
(
≈≈! "
$num
≈≈" %
,
≈≈% &
$"
≈≈' )
$str
≈≈) L
{
≈≈L M
e
≈≈M N
.
≈≈N O
Message
≈≈O V
}
≈≈V W
"
≈≈W X
)
≈≈X Y
;
≈≈Y Z
}
∆∆ 
}
«« 	
}
»» 
}…… ∆Ö
OC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\BuscadorController.cs
	namespace 	
WebApp
 
. 
Controllers 
{		 
[ 
AllowAnonymous 
] 
[ 
ApiController 
] 
[ 
Route 

(
 
Routes 
. 
BUSCADOR 
) 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class 
BuscadorController #
:$ %
BaseController& 4
{ 
private 
readonly 
IBuscadorService )
buscadorService* 9
;9 :
public 
BuscadorController !
(! "
IBuscadorService" 2
buscadorService3 B
,B C
ILoggerD K
<K L
BuscadorControllerL ^
>^ _
logger` f
)f g
:h i
basej n
(n o
loggero u
)u v
{ 	
this   
.   
buscadorService    
=  ! "
buscadorService  # 2
;  2 3
}!! 	
[%% 	
HttpGet%%	 
(%% 
Routes%% 
.%% 
SEARCH_PHRASE%% %
)%%% &
]%%& '
public&& 
IActionResult&& 
PsBuscarPalabra&& ,
(&&, -
string&&- 3
	paramJSON&&4 =
,&&= >
int&&? B

PageNumber&&C M
,&&M N
int&&O R
RowsPerPage&&S ^
)&&^ _
{'' 	
try(( 
{)) 
return** 
Ok** 
(** 
new** 
RespuestasAPI** +
<**+ ,
BuscadorDto**, 7
>**7 8
{++ 
Result,, 
=,, 
buscadorService,, ,
.,,, -
PsBuscarPalabra,,- <
(,,< =
	paramJSON,,= F
,,,F G

PageNumber,,H R
,,,R S
RowsPerPage,,T _
),,_ `
}-- 
)-- 
;-- 
}.. 
catch// 
(// 
	Exception// 
e// 
)// 
{00 
return11 
HandleException11 &
(11& '
e11' (
,11( )
nameof11* 0
(110 1
PsBuscarPalabra111 @
)11@ A
)11A B
;11B C
}22 
}33 	
[55 	
HttpGet55	 
(55 
Routes55 
.55 %
HOMOLOGACION_ESQUEMA_TODO55 1
)551 2
]552 3
public66 
IActionResult66 %
FnHomologacionEsquemaTodo66 6
(666 7
string667 =
VistaFk66> E
,66E F
int66G J
idOna66K P
)66P Q
{77 	
try88 
{99 
return:: 
Ok:: 
(:: 
new:: 
RespuestasAPI:: +
<::+ ,
List::, 0
<::0 1

EsquemaDto::1 ;
>::; <
>::< =
{;; 
Result<< 
=<< 
buscadorService<< ,
.<<, -%
FnHomologacionEsquemaTodo<<- F
(<<F G
VistaFk<<G N
,<<N O
idOna<<P U
)<<U V
}== 
)== 
;== 
}>> 
catch?? 
(?? 
	Exception?? 
e?? 
)?? 
{@@ 
returnAA 
HandleExceptionAA &
(AA& '
eAA' (
,AA( )
nameofAA* 0
(AA0 1%
FnHomologacionEsquemaTodoAA1 J
)AAJ K
)AAK L
;AAL M
}BB 
}CC 	
[EE 	
HttpGetEE	 
(EE 
$"EE 
{EE 
RoutesEE 
.EE #
HOMOLOGACION_ESQUEMA_IDEE 2
}EE2 3
$strEE3 E
"EEE F
)EEF G
]EEG H
publicFF 
IActionResultFF !
FnHomologacionEsquemaFF 2
(FF2 3
intFF3 6
	idEsquemaFF7 @
)FF@ A
{GG 	
tryHH 
{II 
returnJJ 
OkJJ 
(JJ 
newJJ 
RespuestasAPIJJ +
<JJ+ ,
FnEsquemaDtoJJ, 8
>JJ8 9
{KK 
ResultLL 
=LL 
buscadorServiceLL ,
.LL, -!
FnHomologacionEsquemaLL- B
(LLB C
	idEsquemaLLC L
)LLL M
}MM 
)MM 
;MM 
}NN 
catchOO 
(OO 
	ExceptionOO 
eOO 
)OO 
{PP 
returnQQ 
HandleExceptionQQ &
(QQ& '
eQQ' (
,QQ( )
nameofQQ* 0
(QQ0 1!
FnHomologacionEsquemaQQ1 F
)QQF G
)QQG H
;QQH I
}RR 
}SS 	
[UU 	
HttpGetUU	 
(UU 
$"UU 
{UU 
RoutesUU 
.UU "
FN_ESQUEMA_CABECERA_IDUU 1
}UU1 2
$strUU2 H
"UUH I
)UUI J
]UUJ K
publicVV 
IActionResultVV 
FnEsquemaCabeceraVV .
(VV. /
intVV/ 2
IdEsquemadataVV3 @
)VV@ A
{WW 	
tryXX 
{YY 
returnZZ 
OkZZ 
(ZZ 
newZZ 
RespuestasAPIZZ +
<ZZ+ , 
fnEsquemaCabeceraDtoZZ, @
>ZZ@ A
{[[ 
Result\\ 
=\\ 
buscadorService\\ ,
.\\, -
FnEsquemaCabecera\\- >
(\\> ?
IdEsquemadata\\? L
)\\L M
}]] 
)]] 
;]] 
}^^ 
catch__ 
(__ 
	Exception__ 
e__ 
)__ 
{`` 
returnaa 
HandleExceptionaa &
(aa& '
eaa' (
,aa( )
nameofaa* 0
(aa0 1
FnEsquemaCabeceraaa1 B
)aaB C
)aaC D
;aaD E
}bb 
}cc 	
[ee 	
HttpGetee	 
(ee 
$"ee 
{ee 
Routesee 
.ee %
HOMOLOGACION_ESQUEMA_DATOee 4
}ee4 5
$stree5 U
"eeU V
)eeV W
]eeW X
publicff 
IActionResultff %
FnHomologacionEsquemaDatoff 6
(ff6 7
intff7 :
	idEsquemaff; D
,ffD E
stringffF L
VistaFKffM T
,ffT U
intffV Y
idOnaffZ _
)ff_ `
{gg 	
tryhh 
{ii 
returnjj 
Okjj 
(jj 
newjj 
RespuestasAPIjj +
<jj+ ,
Listjj, 0
<jj0 1(
FnHomologacionEsquemaDataDtojj1 M
>jjM N
>jjN O
{kk 
Resultll 
=ll 
buscadorServicell ,
.ll, -%
FnHomologacionEsquemaDatoll- F
(llF G
	idEsquemallG P
,llP Q
VistaFKllR Y
,llY Z
idOnall[ `
)ll` a
}mm 
)mm 
;mm 
}nn 
catchoo 
(oo 
	Exceptionoo 
eoo 
)oo 
{pp 
returnqq 
HandleExceptionqq &
(qq& '
eqq' (
,qq( )
nameofqq* 0
(qq0 1%
FnHomologacionEsquemaDatoqq1 J
)qqJ K
)qqK L
;qqL M
}rr 
}ss 	
[uu 	
HttpGetuu	 
(uu 
Routesuu 
.uu  
ESQUEMA_DATO_BUSCADOuu ,
)uu, -
]uu- .
publicvv 
IActionResultvv 
FnEsquemaDatovv *
(vv* +
intvv+ .
idEsquemaDatavv/ <
,vv< =
stringvv> D
TextoBuscarvvE P
)vvP Q
{ww 	
tryxx 
{yy 
varzz 
resultzz 
=zz 
buscadorServicezz ,
.zz, -
FnEsquemaDatoBuscarzz- @
(zz@ A
idEsquemaDatazzA N
,zzN O
TextoBuscarzzP [
)zz[ \
;zz\ ]
return{{ 
Ok{{ 
({{ 
new{{ 
RespuestasAPI{{ +
<{{+ ,
List{{, 0
<{{0 1#
FnEsquemaDataBuscadoDto{{1 H
>{{H I
>{{I J
{{{K L
Result{{M S
={{T U
result{{V \
}{{] ^
){{^ _
;{{_ `
}|| 
catch}} 
(}} 
	Exception}} 
e}} 
)}} 
{~~ 
return 
HandleException &
(& '
e' (
,( )
nameof* 0
(0 1
FnEsquemaDato1 >
)> ?
)? @
;@ A
}
ÄÄ 
}
ÅÅ 	
[
ÉÉ 	
HttpGet
ÉÉ	 
(
ÉÉ 
Routes
ÉÉ 
.
ÉÉ 
PREDIC_WORDS
ÉÉ $
)
ÉÉ$ %
]
ÉÉ% &
public
ÑÑ 
IActionResult
ÑÑ 
FnPredictWords
ÑÑ +
(
ÑÑ+ ,
string
ÑÑ, 2
word
ÑÑ3 7
)
ÑÑ7 8
{
ÖÖ 	
try
ÜÜ 
{
áá 
return
àà 
Ok
àà 
(
àà 
new
àà 
RespuestasAPI
àà +
<
àà+ ,
List
àà, 0
<
àà0 1
FnPredictWordsDto
àà1 B
>
ààB C
>
ààC D
{
ââ 
Result
ää 
=
ää 
buscadorService
ää ,
.
ää, -
FnPredictWords
ää- ;
(
ää; <
word
ää< @
)
ää@ A
}
ãã 
)
ãã 
;
ãã 
}
åå 
catch
çç 
(
çç 
	Exception
çç 
e
çç 
)
çç 
{
éé 
return
èè 
HandleException
èè &
(
èè& '
e
èè' (
,
èè( )
nameof
èè* 0
(
èè0 1
FnPredictWords
èè1 ?
)
èè? @
)
èè@ A
;
èèA B
}
êê 
}
ëë 	
[
ìì 	
HttpPost
ìì	 
(
ìì 
Routes
ìì 
.
ìì 
PREDIC_WORDS
ìì %
)
ìì% &
]
ìì& '
public
îî 
IActionResult
îî 
ValidateWords
îî *
(
îî* +
[
îî+ ,
FromBody
îî, 4
]
îî4 5
List
îî6 :
<
îî: ;
string
îî; A
>
îîA B
words
îîC H
)
îîH I
{
ïï 	
try
ññ 
{
óó 
return
òò 
Ok
òò 
(
òò 
new
òò 
RespuestasAPI
òò +
<
òò+ ,
bool
òò, 0
>
òò0 1
{
ôô 
Result
öö 
=
öö 
buscadorService
öö ,
.
öö, -
ValidateWords
öö- :
(
öö: ;
words
öö; @
)
öö@ A
}
õõ 
)
õõ 
;
õõ 
}
úú 
catch
ùù 
(
ùù 
	Exception
ùù 
e
ùù 
)
ùù 
{
ûû 
return
üü 
HandleException
üü &
(
üü& '
e
üü' (
,
üü( )
nameof
üü* 0
(
üü0 1
ValidateWords
üü1 >
)
üü> ?
)
üü? @
;
üü@ A
}
†† 
}
°° 	
[
££ 	
HttpPost
££	 
(
££ 
Routes
££ 
.
££ 
EVENTTRACKING
££ &
)
££& '
]
££' (
public
§§ 
IActionResult
§§ 
AddEventTracking
§§ -
(
§§- .
[
§§. /
FromBody
§§/ 7
]
§§7 8
EventTrackingDto
§§9 I
eventTracking
§§J W
)
§§W X
{
•• 	
try
¶¶ 
{
ßß 
var
®® 
	ipAddress
®® 
=
®® 
HttpContext
®®  +
.
®®+ ,

Connection
®®, 6
.
®®6 7
RemoteIpAddress
®®7 F
?
®®F G
.
®®G H
ToString
®®H P
(
®®P Q
)
®®Q R
;
®®R S
buscadorService
©© 
.
©©  
AddEventTracking
©©  0
(
©©0 1
eventTracking
©©1 >
,
©©> ?
	ipAddress
©©@ I
)
©©I J
;
©©J K
return
™™ 
Ok
™™ 
(
™™ 
new
™™ 
RespuestasAPI
™™ +
<
™™+ ,
string
™™, 2
>
™™2 3
{
™™4 5
Result
™™6 <
=
™™= >
$str
™™? ]
}
™™^ _
)
™™_ `
;
™™` a
}
´´ 
catch
¨¨ 
(
¨¨ 
	Exception
¨¨ 
e
¨¨ 
)
¨¨ 
{
≠≠ 
return
ÆÆ 
HandleException
ÆÆ &
(
ÆÆ& '
e
ÆÆ' (
,
ÆÆ( )
nameof
ÆÆ* 0
(
ÆÆ0 1
AddEventTracking
ÆÆ1 A
)
ÆÆA B
)
ÆÆB C
;
ÆÆC D
}
ØØ 
}
∞∞ 	
[
≤≤ 	
HttpGet
≤≤	 
(
≤≤ 
Routes
≤≤ 
.
≤≤ 
GEO_CODE
≤≤  
)
≤≤  !
]
≤≤! "
public
≥≥ 
async
≥≥ 
Task
≥≥ 
<
≥≥ 
IActionResult
≥≥ '
>
≥≥' (
GetCoordinates
≥≥) 7
(
≥≥7 8
[
≥≥8 9
	FromQuery
≥≥9 B
]
≥≥B C
string
≥≥D J
address
≥≥K R
)
≥≥R S
{
¥¥ 	
try
µµ 
{
∂∂ 
var
∑∑ 
response
∑∑ 
=
∑∑ 
await
∑∑ $
buscadorService
∑∑% 4
.
∑∑4 5
GetCoordinates
∑∑5 C
(
∑∑C D
address
∑∑D K
)
∑∑K L
;
∑∑L M
return
ππ 
Ok
ππ 
(
ππ 
response
ππ "
)
ππ" #
;
ππ# $
}
∫∫ 
catch
ªª 
(
ªª 
	Exception
ªª 
e
ªª 
)
ªª 
{
ªª  !
return
ªª" (
HandleException
ªª) 8
(
ªª8 9
e
ªª9 :
,
ªª: ;
nameof
ªª< B
(
ªªB C
GetCoordinates
ªªC Q
)
ªªQ R
)
ªªR S
;
ªªS T
}
ªªU V
}
ºº 	
[
ææ 	
HttpPost
ææ	 
(
ææ 
Routes
ææ 
.
ææ 
EXCEL
ææ 
)
ææ 
]
ææ  
public
øø 
IActionResult
øø 
ExportExcel
øø (
(
øø( )
[
øø) *
FromBody
øø* 2
]
øø2 3
List
øø4 8
<
øø8 9

Dictionary
øø9 C
<
øøC D
string
øøD J
,
øøJ K
string
øøL R
>
øøR S
>
øøS T
data
øøU Y
)
øøY Z
{
¿¿ 	
if
¡¡ 
(
¡¡ 
data
¡¡ 
.
¡¡ 
Count
¡¡ 
==
¡¡ 
$num
¡¡ 
)
¡¡  
return
¡¡! '

BadRequest
¡¡( 2
(
¡¡2 3
$str
¡¡3 O
)
¡¡O P
;
¡¡P Q
var
¬¬ 
response
¬¬ 
=
¬¬ 
buscadorService
¬¬ *
.
¬¬* +
ExportExcel
¬¬+ 6
(
¬¬6 7
data
¬¬7 ;
)
¬¬; <
;
¬¬< =
return
√√ 
File
√√ 
(
√√ 
response
√√  
,
√√  !
$str
ƒƒ [
,
ƒƒ[ \
$str
≈≈ *
)
≈≈* +
;
≈≈+ ,
}
∆∆ 	
[
»» 	
HttpPost
»»	 
(
»» 
Routes
»» 
.
»» 
PDF
»» 
)
»» 
]
»» 
public
…… 
IActionResult
…… 
	ExportPdf
…… &
(
……& '
[
……' (
FromBody
……( 0
]
……0 1
List
……2 6
<
……6 7

Dictionary
……7 A
<
……A B
string
……B H
,
……H I
string
……J P
>
……P Q
>
……Q R
data
……S W
)
……W X
{
   	
var
ÀÀ 
response
ÀÀ 
=
ÀÀ 
buscadorService
ÀÀ *
.
ÀÀ* +
	ExportPdf
ÀÀ+ 4
(
ÀÀ4 5
data
ÀÀ5 9
)
ÀÀ9 :
;
ÀÀ: ;
return
ÃÃ 
File
ÃÃ 
(
ÃÃ 
response
ÃÃ  
,
ÃÃ  !
$str
ÃÃ" 3
,
ÃÃ3 4
$str
ÃÃ5 F
)
ÃÃF G
;
ÃÃG H
}
ÕÕ 	
}
ŒŒ 
}œœ á 
KC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\BaseController.cs
	namespace 	
WebApp
 
. 
Controllers 
{		 
public 

class 
BaseController 
:  !
ControllerBase" 0
{ 
private 
readonly 
ILogger  
<  !
BaseController! /
>/ 0
_logger1 8
;8 9
	protected 
BaseController  
(  !
ILogger! (
<( )
BaseController) 7
>7 8
logger9 ?
)? @
{ 	
this 
. 
_logger 
= 
logger !
;! "
} 	
	protected## 
IActionResult## 
HandleException##  /
(##/ 0
	Exception##0 9
e##: ;
,##; <
string$$ 

methodName$$ 
,$$ 
[%% 
CallerMemberName%% 
]%% 
string%% %
?%%% &
caller%%' -
=%%. /
null%%0 4
)%%4 5
{&& 	
_logger'' 
.'' 
LogError'' 
('' 
e'' 
,'' 
$str(( A
,((A B

methodName)) 
,)) 
caller** 
,** 
HttpContext++ 
.++ 
TraceIdentifier++ '
)++' (
;++( )
var.. 
	respuesta.. 
=.. 
new.. 
RespuestasAPI..  -
<..- .
object... 4
>..4 5
{// 

StatusCode00 
=00 
HttpStatusCode00 +
.00+ ,
InternalServerError00, ?
,00? @
	IsSuccess11 
=11 
false11 !
,11! "
ErrorMessages22 
=22 
new22  #
List22$ (
<22( )
string22) /
>22/ 0
{221 2
$str223 O
}22P Q
,22Q R
Result33 
=33 
new33 
{33 
}33  
}44 
;44 
return66 

StatusCode66 
(66 
StatusCodes66 )
.66) *(
Status500InternalServerError66* F
,66F G
	respuesta66H Q
)66Q R
;66R S
}77 	
	protectedAA 
IActionResultAA 
BadRequestResponseAA  2
(AA2 3
stringAA3 9
messageAA: A
)AAA B
{BB 	
returnCC 

BadRequestCC 
(CC 
newCC !
RespuestasAPICC" /
<CC/ 0
objectCC0 6
>CC6 7
{DD 

StatusCodeEE 
=EE 
HttpStatusCodeEE +
.EE+ ,

BadRequestEE, 6
,EE6 7
	IsSuccessFF 
=FF 
falseFF !
,FF! "
ErrorMessagesGG 
=GG 
newGG  #
ListGG$ (
<GG( )
stringGG) /
>GG/ 0
{GG1 2
messageGG3 :
}GG; <
,GG< =
ResultHH 
=HH 
newHH 
{HH 
}HH  
}II 
)II 
;II 
}JJ 	
	protectedTT 
IActionResultTT 
NotFoundResponseTT  0
(TT0 1
stringTT1 7
messageTT8 ?
)TT? @
{UU 	
returnVV 
NotFoundVV 
(VV 
newVV 
RespuestasAPIVV  -
<VV- .
objectVV. 4
>VV4 5
{WW 

StatusCodeXX 
=XX 
HttpStatusCodeXX +
.XX+ ,
NotFoundXX, 4
,XX4 5
	IsSuccessYY 
=YY 
falseYY !
,YY! "
ErrorMessagesZZ 
=ZZ 
newZZ  #
ListZZ$ (
<ZZ( )
stringZZ) /
>ZZ/ 0
{ZZ1 2
messageZZ3 :
}ZZ; <
,ZZ< =
Result[[ 
=[[ 
new[[ 
{[[ 
}[[  
}\\ 
)\\ 
;\\ 
}]] 	
}__ 
}`` 