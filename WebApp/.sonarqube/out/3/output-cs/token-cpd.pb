Äq
7C:\Users\Dell\source\repos\BuscadorCan\WebApp\Routes.cs
	namespace 	
WebApp
 
{ 
public 

static 
class 
Routes 
{ 
public 
const 
string 
BUSCADOR $
=% &
$str' 5
;5 6
public		 
const		 
string		 
SEARCH_PHRASE		 )
=		* +
$str		, ;
;		; <
public

 
const

 
string

 %
HOMOLOGACION_ESQUEMA_TODO

 5
=

6 7
$str

8 Q
;

Q R
public 
const 
string #
HOMOLOGACION_ESQUEMA_ID 3
=4 5
$str6 K
;K L
public 
const 
string "
FN_ESQUEMA_CABECERA_ID 2
=3 4
$str5 H
;H I
public 
const 
string %
HOMOLOGACION_ESQUEMA_DATO 5
=6 7
$str8 Q
;Q R
public 
const 
string  
ESQUEMA_DATO_BUSCADO 0
=1 2
$str3 G
;G H
public 
const 
string 
PREDIC_WORDS (
=) *
$str+ 9
;9 :
public 
const 
string 
VALIDATE_WORDS *
=+ ,
$str- <
;< =
public 
const 
string 
EVENTTRACKING )
=* +
$str, >
;> ?
public 
const 
string 
GEO_CODE $
=% &
$str' 0
;0 1
public 
const 
string 
EXCEL !
=" #
$str$ +
;+ ,
public 
const 
string 
PDF 
=  !
$str" '
;' (
public 
const 
string 
	CATALOGOS %
=& '
$str( 7
;7 8
public 
const 
string 
GRID_SCHEMA '
=( )
$str* 7
;7 8
public 
const 
string 
FILTERS_SCHEMA *
=+ ,
$str- =
;= >
public 
const 
string 
FILTERS_DATA (
=) *
$str+ 9
;9 :
public 
const 
string 
DIMENSION_SCHEMA ,
=- .
$str/ B
;B C
public 
const 
string 
GRUPOS "
=# $
$str% -
;- .
public 
const 
string 
ROLES !
=" #
$str$ +
;+ ,
public 
const 
string 
ONAS  
=! "
$str# )
;) *
public   
const   
string   
MENU_CATALOGO   )
=  * +
$str  , 2
;  2 3
public!! 
const!! 
string!! 
PANEL!! !
=!!" #
$str!!$ +
;!!+ ,
public"" 
const"" 
string""  
ESQUEMA_ORGANIZACION"" 0
=""1 2
$str""3 D
;""D E
public## 
const## 
string## 
VW_ONA## "
=### $
$str##% ,
;##, -
public$$ 
const$$ 
string$$ 
FILTERS_ANINADOS$$ ,
=$$- .
$str$$/ A
;$$A B
public%% 
const%% 
string%% 
ANINADOS%% $
=%%% &
$str%%' 1
;%%1 2
public)) 
const)) 
string)) 
DYNAMIC)) #
=))$ %
$str))& 2
;))2 3
public** 
const** 
string** 
GETPROPERTIES** )
=*** +
$"**, .
$str**. L
"**L M
;**M N
public++ 
const++ 
string++ 
GETVALUECOLUMNA++ +
=++, -
$"++. 0
$str++0 ^
"++^ _
;++_ `
public,, 
const,, 
string,, %
GETLISTAVALIDACIONESQUEMA,, 5
=,,6 7
$",,8 :
$str,,: \
",,\ ]
;,,] ^
public-- 
const-- 
string-- 
TEST--  
=--! "
$"--# %
$str--% 7
"--7 8
;--8 9
public.. 
const.. 
string.. 
MIGRAR.. "
=..# $
$"..% '
$str..' ;
"..; <
;..< =
public22 
const22 
string22 
ENVIAR22 "
=22# $
$str22% -
;22- .
public66 
const66 
string66 
ESQUEMA66 #
=66$ %
$str66& 3
;663 4
public77 
const77 
string77 

VALIDACION77 &
=77' (
$str77) 5
;775 6
public88 
const88 
string88 $
VALIDACION_ACTUALIZACION88 4
=885 6
$str887 N
;88N O
public99 
const99 
string99 
VISTA_COLUMNA99 )
=99* +
$str99, ;
;99; <
public:: 
const:: 
string:: 

ESQUEMA_ID:: &
=::' (
$"::) +
$str::+ =
"::= >
;::> ?
public>> 
const>> 
string>> 
EVENT_TRACKING>> *
=>>+ ,
$str>>- @
;>>@ A
public?? 
const?? 
string?? 
EVENT_USER_ALL?? *
=??+ ,
$str??- ;
;??; <
public@@ 
const@@ 
string@@ 
EVENT@@ !
=@@" #
$str@@$ *
;@@* +
publicAA 
constAA 
stringAA 
EVENT_DELETEAA (
=AA) *
$"AA+ -
$strAA- I
"AAI J
;AAJ K
publicBB 
constBB 
stringBB 
EVENT_DELETE_IDBB +
=BB, -
$"BB. 0
$strBB0 O
"BBO P
;BBP Q
publicCC 
constCC 
stringCC 
EVENT_SESSIONCC )
=CC* +
$strCC, :
;CC: ;
publicDD 
constDD 
stringDD 
COORDINATESDD '
=DD( )
$"DD* ,
$strDD, >
"DD> ?
;DD? @
publicEE 
constEE 
stringEE 
EVENT_PAG_MAS_VISITEE /
=EE0 1
$strEE2 D
;EED E
publicFF 
constFF 
stringFF "
EVENT_FILTRO_MAS_USADOFF 2
=FF3 4
$strFF5 J
;FFJ K
publicJJ 
constJJ 
stringJJ 
GOOGLEJJ "
=JJ# $
$strJJ% 2
;JJ2 3
publicKK 
constKK 
stringKK 
	AUTHORIZEKK %
=KK& '
$strKK( 3
;KK3 4
publicLL 
constLL 
stringLL 
CALLBACKLL $
=LL% &
$strLL' 1
;LL1 2
publicPP 
constPP 
stringPP 
HOMOLOGACIONPP (
=PP) *
$strPP+ =
;PP= >
publicQQ 
constQQ 
stringQQ 
FIND_BY_PARENTQQ *
=QQ+ ,
$strQQ- ;
;QQ; <
publicRR 
constRR 
stringRR '
FIND_BY_CODIGO_HOMOLOGACIONRR 7
=RR8 9
$"RR: <
$strRR< k
"RRk l
;RRl m
publicSS 
constSS 
stringSS $
FIND_BY_ALL_HOMOLOGACIONSS 4
=SS5 6
$strSS7 B
;SSB C
publicWW 
constWW 
stringWW 
LOG_MIGRACIONWW )
=WW* +
$strWW, >
;WW> ?
public[[ 
const[[ 
string[[ 
MIGRACION_EXCEL[[ +
=[[, -
$str[[. B
;[[B C
public\\ 
const\\ 
string\\ 
MIGRACION_UPLOAD\\ ,
=\\- .
$str\\/ 7
;\\7 8
public`` 
const`` 
string`` 
CONEXION`` $
=``% &
$str``' 5
;``5 6
publicaa 
constaa 
stringaa 
	LISTA_ONAaa %
=aa& '
$"aa( *
$straa* @
"aa@ A
;aaA B
publicee 
constee 
stringee 
ONACee  
=ee! "
$stree# -
;ee- .
publicff 
constff 
stringff 
POST_ONA_MIGRATEff ,
=ff- .
$strff/ ?
;ff? @
publicjj 
constjj 
stringjj 
MENUjj  
=jj! "
$strjj# -
;jj- .
publicnn 
constnn 
stringnn 
ONAnn 
=nn  !
$strnn" +
;nn+ ,
publicoo 
constoo 
stringoo 
LISTA_ONA_BY_IDoo +
=oo, -
$"oo. 0
$stroo0 C
"ooC D
;ooD E
publicpp 
constpp 
stringpp 
PAISESpp "
=pp# $
$strpp% -
;pp- .
publictt 
consttt 
stringtt 
REPORTES_VISTAtt *
=tt+ ,
$strtt- ?
;tt? @
publicuu 
constuu 
stringuu 
FIND_BY_VISTAuu )
=uu* +
$"uu, .
$struu. P
"uuP Q
;uuQ R
publicvv 
constvv 
stringvv 
ACREDITACION_ONAvv ,
=vv- .
$strvv/ A
;vvA B
publicww 
constww 
stringww  
ACREDITACION_ESQUEMAww 0
=ww1 2
$strww3 I
;wwI J
publicxx 
constxx 
stringxx 
ESTADO_ESQUEMAxx *
=xx+ ,
$strxx- =
;xx= >
publicyy 
constyy 
stringyy 
OEC_PAISyy $
=yy% &
$stryy' 1
;yy1 2
publiczz 
constzz 
stringzz 
ESQUEMA_PAISzz (
=zz) *
$strzz+ 9
;zz9 :
public{{ 
const{{ 
string{{ 
	OEC_FECHA{{ %
={{& '
$str{{( 3
;{{3 4
public|| 
const|| 
string|| "
PROFESIONAL_CALIFICADO|| 2
=||3 4
$str||5 M
;||M N
public}} 
const}} 
string}} 
PROFESIONAL_ONA}} +
=}}, -
$str}}. ?
;}}? @
public~~ 
const~~ 
string~~ 
PROFESIONAL_ESQUEMA~~ /
=~~0 1
$str~~2 G
;~~G H
public 
const 
string 
PROFESIONAL_FECHA -
=. /
$str0 C
;C D
public
 
const
 
string
  
CALIFICA_UBICACION
 .
=
/ 0
$str
1 E
;
E F
public
 
const
 
string
 
BUSQUEDA_FECHA
 *
=
+ ,
$str
- =
;
= >
public
 
const
 
string
 
BUSQUEDA_FILTRO
 +
=
, -
$str
. ?
;
? @
public
 
const
 
string
  
BUSQUEDA_UBICACION
 .
=
/ 0
$str
1 E
;
E F
public
 
const
 
string
 
ACTUALIZACION_ONA
 -
=
. /
$str
0 C
;
C D
public
 
const
 
string
 "
ORGANISMO_REGISTRADO
 0
=
1 2
$str
3 I
;
I J
public
 
const
 
string
 
ORGANISMO_ESQUEMA
 -
=
. /
$str
0 F
;
F G
public
 
const
 
string
 !
ORGANISMO_ACTIVIDAD
 /
=
0 1
$str
2 G
;
G H
public
 
const
 
string
 
	THESAURUS
 %
=
& '
$str
( 7
;
7 8
public
 
const
 
string
 
GET_THESAURUS
 )
=
* +
$str
, ?
;
? @
public
 
const
 
string
 
THESAURUS_AGREGAR
 -
=
. /
$str
0 C
;
C D
public
 
const
 
string
 "
THESAURUS_ACTUALIZAR
 0
=
1 2
$str
3 I
;
I J
public
 
const
 
string
 #
THESAURUS_AGREGAR_SUB
 1
=
2 3
$"
4 6
$str
6 o
"
o p
;
p q
public
 
const
 
string
  
THESAURUS_EJECUTAR
 .
=
/ 0
$str
1 ?
;
? @
public
 
const
 
string
 
THESAURUS_RESET
 +
=
, -
$str
. ?
;
? @
public
 
const
 
string
 
USUARIOS
 $
=
% &
$str
' 5
;
5 6
public
 
const
 
string
 
LOGIN
 !
=
" #
$str
$ +
;
+ ,
public
 
const
 
string
 
VALIDAR
 #
=
$ %
$str
& /
;
/ 0
public
 
const
 
string
 
	RECUPERAR
 %
=
& '
$str
( 3
;
3 4
public
 
const
 
string
 
REGISTRO
 $
=
% &
$str
' 1
;
1 2
public
 
const
 
string
 
VALIDAR_EMAIL
 )
=
* +
$str
, ;
;
; <
public
 
const
 
string
 
CAMBIAR_CLAVE
 )
=
* +
$str
, ;
;
; <
public
 
const
 
string
 
UPLOAD_ICON
 '
=
( )
$str
* 6
;
6 7
}
¡¡ 
}¢¢ ;
8C:\Users\Dell\source\repos\BuscadorCan\WebApp\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
Log 
. 
Logger 

= 
new 
LoggerConfiguration $
($ %
)% &
. 
ReadFrom 
. 
Configuration 
( 
builder #
.# $
Configuration$ 1
)1 2
. 
Enrich 
. 
FromLogContext 
( 
) 
. 
CreateLogger 
( 
) 
; 
builder 
. 
Host 
. 

UseSerilog 
( 
) 
; 
builder 
. 
Services 
. 
	Configure 
< 
FormOptions &
>& '
(' (
options( /
=>0 2
{3 4
options 	
.	 
$
MultipartBodyLengthLimit
 "
=# $
$num% -
;- .
} 
) 
; 
builder 
. 
Services 
. 
ConfigureDbContexts $
($ %
builder% ,
., -
Configuration- :
): ;
;; <
builder"" 
."" 
Services"" 
."" 
ConfigureServices"" "
(""" #
)""# $
;""$ %
builder'' 
.'' 
Services'' 
.'' #
ConfigureAuthentication'' (
(''( )
builder'') 0
.''0 1
Configuration''1 >
)''> ?
;''? @
builder,, 
.,, 
Services,, 
.,, 
ConfigureSwagger,, !
(,,! "
),," #
;,,# $
builder.. 
... 
Services.. 
... 
ConfigureRoutes..  
(..  !
builder..! (
...( )
Configuration..) 6
)..6 7
;..7 8
builder44 
.44 
Services44 
.44 
AddControllers44 
(44  
)44  !
.44! "
AddNewtonsoftJson44" 3
(443 4
)444 5
;445 6
builder66 
.66 
Services66 
.66 
AddCors66 
(66 
options66  
=>66! #
{77 
options88 
.88 
	AddPolicy88 
(88 
$str88 "
,88" #
builder99 
=>99 
{:: 	
string;; 
[;; 
];; 
domainsAllowed;; #
=;;$ %
[;;& '
Inicializar<< 
.<< 

UrlBaseApi<< &
,<<& '
Inicializar== 
.== 
UrlBaseAdmin== (
,==( )
Inicializar>> 
.>> 
UrlBaseServ>> '
,>>' (
Inicializar?? 
.?? 
UrlBaseBuscador?? +
,??+ ,
Inicializar@@ 
.@@ 
UrlBasePublicServ@@ -
]AA 
;AA 
builderCC 
.CC 
WithOriginsCC 
(CC  
domainsAllowedCC  .
)CC. /
.DD 
AllowAnyHeaderDD "
(DD" #
)DD# $
.EE 
AllowAnyMethodEE "
(EE" #
)EE# $
;EE$ %
}FF 	
)FF	 

;FF
 
}GG 
)GG 
;GG 
builderII 
.II 
ConfigurationII 
.JJ 
AddJsonFileJJ 
(JJ 
$strJJ #
,JJ# $
optionalJJ% -
:JJ- .
falseJJ/ 4
)JJ4 5
.KK 
AddJsonFileKK 
(KK 
$"KK 
$strKK 
{KK  
builderKK  '
.KK' (
EnvironmentKK( 3
.KK3 4
EnvironmentNameKK4 C
}KKC D
$strKKD I
"KKI J
,KKJ K
optionalKKL T
:KKT U
trueKKV Z
)KKZ [
.LL #
AddEnvironmentVariablesLL 
(LL 
)LL 
;LL 
builderQQ 
.QQ 
ServicesQQ 
.QQ 
AddRateLimiterQQ 
(QQ  
optionsQQ  '
=>QQ( *
{RR 
optionsSS 
.SS 
GlobalLimiterSS 
=SS "
PartitionedRateLimiterSS 2
.SS2 3
CreateSS3 9
<SS9 :
HttpContextSS: E
,SSE F
stringSSG M
>SSM N
(SSN O
httpContextSSO Z
=>SS[ ]
RateLimitPartitionTT 
.TT !
GetFixedWindowLimiterTT 0
(TT0 1
partitionKeyUU 
:UU 
httpContextUU %
.UU% &

ConnectionUU& 0
.UU0 1
RemoteIpAddressUU1 @
?UU@ A
.UUA B
ToStringUUB J
(UUJ K
)UUK L
??UUM O
$strUUP Y
,UUY Z
factoryVV 
:VV 
_VV 
=>VV 
newVV )
FixedWindowRateLimiterOptionsVV ;
{WW 
PermitLimitXX 
=XX 
$numXX !
,XX! "
WindowYY 
=YY 
TimeSpanYY !
.YY! "
FromMinutesYY" -
(YY- .
$numYY. /
)YY/ 0
,YY0 1 
QueueProcessingOrderZZ $
=ZZ% & 
QueueProcessingOrderZZ' ;
.ZZ; <
OldestFirstZZ< G
,ZZG H

QueueLimit[[ 
=[[ 
$num[[ 
}\\ 
)\\ 
)\\ 
;\\ 
options]] 
.]] 
RejectionStatusCode]] 
=]]  !
StatusCodes]]" -
.]]- .$
Status429TooManyRequests]]. F
;]]F G
}^^ 
)^^ 
;^^ 
var`` 
app`` 
=`` 	
builder``
 
.`` 
Build`` 
(`` 
)`` 
;`` 
appbb 
.bb 
UseRateLimiterbb 
(bb 
)bb 
;bb 
appii 
.ii 
UseCorsii 
(ii 
$strii 
)ii 
;ii 
appoo 
.oo 
UseStaticFilesoo 
(oo 
)oo 
;oo 
iftt 
(tt 
apptt 
.tt 
Environmenttt 
.tt 
IsDevelopmenttt !
(tt! "
)tt" #
||tt$ &
apptt' *
.tt* +
Environmenttt+ 6
.tt6 7
IsProductiontt7 C
(ttC D
)ttD E
)ttE F
{uu 
appvv 
.vv 

UseSwaggervv 
(vv 
)vv 
;vv 
appww 
.ww 
UseSwaggerUIww 
(ww 
)ww 
;ww 
appxx 
.xx 
UsePathBasexx 
(xx 
$strxx )
)xx) *
;xx* +
}yy 
app 
. 
UseAuthentication 
( 
) 
; 
app 
.
 
UseAuthorization
 
(
 
)
 
;
 
app 
.
 
MapControllers
 
(
 
)
 
;
 
app 
.
 
Run
 
(
 
)
 	
;
	 
ýT
;C:\Users\Dell\source\repos\BuscadorCan\WebApp\Extensions.cs
	namespace 	
WebApp
 
. 

Extensions 
{ 
public 

static 
class 
ServiceExtensions )
{ 
public 
static 
void 
ConfigureDbContexts .
(. /
this/ 3
IServiceCollection4 F
servicesG O
,O P
IConfigurationQ _
configuration` m
)m n
{ 	
services 
. 
AddDbContextPool %
<% &
SqlServerDbContext& 8
>8 9
(9 :
options: A
=>B D
options 
. 
UseSqlServer "
(" #
configuration# 0
.0 1
GetConnectionString1 D
(D E
$strE R
)R S
)S T
)   
;   
services## 
.## 
	AddScoped## 
<## &
ISqlServerDbContextFactory## 9
>##9 :
(##: ;
provider##; C
=>##D F
{$$ 
var%% 
options%% 
=%% 
provider%% &
.%%& '
GetRequiredService%%' 9
<%%9 :
DbContextOptions%%: J
<%%J K
SqlServerDbContext%%K ]
>%%] ^
>%%^ _
(%%_ `
)%%` a
;%%a b
return&& 
new&& %
SqlServerDbContextFactory&& 4
(&&4 5
options&&5 <
)&&< =
;&&= >
}'' 
)'' 
;'' 
services** 
.** 
AddSingleton** !
<**! "
IDbContextFactory**" 3
,**3 4
DbContextFactory**5 E
>**E F
(**F G
)**G H
;**H I
}++ 	
public11 
static11 
void11 
ConfigureServices11 ,
(11, -
this11- 1
IServiceCollection112 D
services11E M
)11M N
{22 	
services44 
.44 
AddAutoMapper44 "
(44" #
typeof44# )
(44) *
Mapper44* 0
)440 1
)441 2
;442 3
services77 
.77 
Scan77 
(77 
scan77 
=>77 !
scan77" &
.88 
FromAssembliesOf88 !
(88! "
typeof88" (
(88( )
EmailService88) 5
)885 6
,886 7
typeof888 >
(88> ?
ONARepository88? L
)88L M
)88M N
.99 

AddClasses99 
(99 
classes99 #
=>99$ &
classes99' .
.99. /
AssignableToAny99/ >
(99> ?
typeof:: 
(:: 
IGmailClientFactory:: .
)::. /
,::/ 0
typeof;; 
(;; 
ICatalogosService;; ,
);;, -
,;;- .
typeof<< 
(<< 
IEmailService<< (
)<<( )
,<<) *
typeof== 
(== #
IUsuarioEmailRepository== 2
)==2 3
,==3 4
typeof>> 
(>> 
IJwtFactory>> &
)>>& '
,>>' (
typeof?? 
(?? 
IJwtService?? &
)??& '
,??' (
typeof@@ 
(@@ 
IHashStrategy@@ (
)@@( )
,@@) *
typeofAA 
(AA 
IHashServiceAA '
)AA' (
,AA( )
typeofBB 
(BB )
IRandomStringGeneratorServiceBB 8
)BB8 9
,BB9 :
typeofCC 
(CC 
IThesaurusServiceCC ,
)CC, -
,CC- .
typeofDD 
(DD 
IUsuarioRepositoryDD -
)DD- .
,DD. /
typeofEE 
(EE 
IImportadorEE &
)EE& '
,EE' (
typeofFF 
(FF 
	IMigradorFF $
)FF$ %
,FF% &
typeofGG 
(GG 
IOnaMigrateGG &
)GG& '
,GG' (
typeofHH 
(HH  
IAuthenticateServiceHH /
)HH/ 0
,HH0 1
typeofII 
(II 
IRecoverUserServiceII .
)II. /
,II/ 0
typeofJJ 
(JJ *
IConectionStringBuilderServiceJJ 9
)JJ9 :
,JJ: ;
typeofKK 
(KK 
IDynamicRepositoryKK -
)KK- .
,KK. /
typeofLL 
(LL 
IReporteRepositoryLL -
)LL- .
,LL. /
typeofMM 
(MM )
IpaActualizarFiltroRepositoryMM 8
)MM8 9
,MM9 :
typeofNN 
(NN $
IEventTrackingRepositoryNN 3
)NN3 4
,NN4 5
typeofOO 
(OO  
IThesaurusRepositoryOO /
)OO/ 0
)PP 
)PP 
.QQ #
AsImplementedInterfacesQQ (
(QQ( )
)QQ) *
.RR 
WithScopedLifetimeRR #
(RR# $
)RR$ %
)SS 
;SS 
servicesVV 
.VV 
ScanVV 
(VV 
scanVV 
=>VV !
scanVV" &
.WW 
FromAssembliesOfWW !
(WW! "
typeofWW" (
(WW( )
EmailServiceWW) 5
)WW5 6
,WW6 7
typeofWW8 >
(WW> ?
ONARepositoryWW? L
)WWL M
)WWM N
.XX 

AddClassesXX 
(XX 
)XX 
.YY 
AsMatchingInterfaceYY $
(YY$ %
)YY% &
.ZZ 
WithScopedLifetimeZZ #
(ZZ# $
)ZZ$ %
)[[ 
;[[ 
services^^ 
.^^ 
AddSingleton^^ !
<^^! " 
IHttpContextAccessor^^" 6
,^^6 7
HttpContextAccessor^^8 K
>^^K L
(^^L M
)^^M N
;^^N O
servicesaa 
.aa 
AddHttpClientaa "
<aa" #!
IIpCoordinatesServiceaa# 8
,aa8 9 
IpCoordinatesServiceaa: N
>aaN O
(aaO P
)aaP Q
;aaQ R
}cc 	
publicjj 
staticjj 
voidjj #
ConfigureAuthenticationjj 2
(jj2 3
thisjj3 7
IServiceCollectionjj8 J
servicesjjK S
,jjS T
IConfigurationjjU c
configurationjjd q
)jjq r
{kk 	
varmm 
keymm 
=mm 
Encodingmm 
.mm 
ASCIImm $
.mm$ %
GetBytesmm% -
(mm- .
configurationmm. ;
.mm; <
GetValuemm< D
<mmD E
stringmmE K
>mmK L
(mmL M
$strmmM b
)mmb c
??mmd f
$strmmg i
)mmi j
;mmj k
servicespp 
.pp 
AddAuthenticationpp &
(pp& '
JwtBearerDefaultspp' 8
.pp8 9 
AuthenticationSchemepp9 M
)ppM N
.ppN O
AddJwtBearerppO [
(pp[ \
optionspp\ c
=>ppd f
{qq 
optionsrr 
.rr  
RequireHttpsMetadatarr ,
=rr- .
falserr/ 4
;rr4 5
optionsss 
.ss 
	SaveTokenss !
=ss" #
truess$ (
;ss( )
optionstt 
.tt %
TokenValidationParameterstt 1
=tt2 3
newtt4 7%
TokenValidationParameterstt8 Q
{uu $
ValidateIssuerSigningKeyvv ,
=vv- .
truevv/ 3
,vv3 4
IssuerSigningKeyww $
=ww% &
newww' * 
SymmetricSecurityKeyww+ ?
(ww? @
keyww@ C
)wwC D
,wwD E
ValidateIssuerxx "
=xx# $
falsexx% *
,xx* +
ValidateAudienceyy $
=yy% &
falseyy' ,
}zz 
;zz 
}{{ 
){{ 
;{{ 
}|| 	
public
 
static
 
void
 
ConfigureSwagger
 +
(
+ ,
this
, 0 
IServiceCollection
1 C
services
D L
)
L M
{
 	
services
 
.
 %
AddEndpointsApiExplorer
 ,
(
, -
)
- .
;
. /
services
 
.
 
AddSwaggerGen
 "
(
" #
options
# *
=>
+ -
{
 
options
 
.
 #
AddSecurityDefinition
 -
(
- .
$str
. 6
,
6 7
new
8 ;#
OpenApiSecurityScheme
< Q
{
 
Description
 
=
  !
$str
" Y
+
Z [
$str
 z
+
{ |
$str
 6
,
6 7
Name
 
=
 
$str
 *
,
* +
In
 
=
 
ParameterLocation
 *
.
* +
Header
+ 1
,
1 2
Scheme
 
=
 
$str
 %
}
 
)
 
;
 
options
 
.
 $
AddSecurityRequirement
 .
(
. /
new
/ 2(
OpenApiSecurityRequirement
3 M
{
N O
{

 
new
 #
OpenApiSecurityScheme
 %
{
& '
	Reference
 
=
 
new
 
OpenApiReference
 .
{
/ 0
Type
 
=
 
ReferenceType
 $
.
$ %
SecurityScheme
% 3
,
3 4
Id
 
=
 
$str
 
}
 
,
 
Scheme
 
=
 
$str
 
,
  
Name
 
=
 
$str
 
,
 
In
 
=
 
ParameterLocation
 $
.
$ %
Header
% +
}
 
,
 
new
 
List
 
<
 
string
 
>
 
(
 
)
 
}

 
}
   	
)
  	 

;
  
 
}
¡¡ 
)
¡¡ 
;
¡¡ 
}
¢¢ 	
public
¤¤ 
static
¤¤ 
void
¤¤ 
ConfigureRoutes
¤¤ *
(
¤¤* +
this
¤¤+ / 
IServiceCollection
¤¤0 B
services
¤¤C K
,
¤¤K L
IConfiguration
¤¤M [
configuration
¤¤\ i
)
¤¤i j
{
¥¥ 	
var
¦¦ 
routes
¦¦ 
=
¦¦ 
configuration
¦¦ &
.
¦¦& '

GetSection
¦¦' 1
(
¦¦1 2
$str
¦¦2 <
)
¦¦< =
;
¦¦= >
}
¨¨ 	
}
ªª 
}«« (
PC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\UtilitiesController.cs
	namespace 	
WebApp
 
. 
Controllers 
{ 
[ 
	Authorize 
] 
[		 
Route		 

(		
 
$str		 
)		 
]		 
[

 
ApiController

 
]

 
public 

class 
UtilitiesController $
:% &
ControllerBase' 5
{ 
private 
readonly 
IWebHostEnvironment ,
_environment- 9
;9 :
public 
UtilitiesController "
(" #
IWebHostEnvironment# 6
environment7 B
)B C
{ 	
_environment 
= 
environment &
;& '
} 	
[ 	
HttpPost	 
( 
Routes 
. 
UPLOAD_ICON $
)$ %
]% &
public 
async 
Task 
< 
IActionResult '
>' (

UploadIcon) 3
(3 4
[4 5
FromForm5 =
]= >
	IFormFile? H
fileI M
,M N
[O P
FromFormP X
]X Y
intZ ]
idONA^ c
)c d
{ 	
try   
{!! 
if"" 
("" 
file"" 
=="" 
null""  
||""! #
file""$ (
.""( )
Length"") /
==""0 2
$num""3 4
)""4 5
return## 

BadRequest## %
(##% &
$str##& K
)##K L
;##L M
Console&& 
.&& 
	WriteLine&& !
(&&! "
$"&&" $
$str&&$ 5
{&&5 6
idONA&&6 ;
}&&; <
"&&< =
)&&= >
;&&> ?
var)) 
	extension)) 
=)) 
Path))  $
.))$ %
GetExtension))% 1
())1 2
file))2 6
.))6 7
FileName))7 ?
)))? @
?))@ A
.))A B
ToLowerInvariant))B R
())R S
)))S T
;))T U
var** 
allowedExtensions** %
=**& '
new**( +
[**+ ,
]**, -
{**. /
$str**0 6
,**6 7
$str**8 >
}**? @
;**@ A
if,, 
(,, 
string,, 
.,, 
IsNullOrEmpty,, (
(,,( )
	extension,,) 2
),,2 3
||,,4 6
!,,7 8
allowedExtensions,,8 I
.,,I J
Contains,,J R
(,,R S
	extension,,S \
),,\ ]
),,] ^
return-- 

BadRequest-- %
(--% &
$str--& H
)--H I
;--I J
var// 
uniqueFileName// "
=//# $
$"//% '
{//' (
idONA//( -
}//- .
{//. /
	extension/// 8
}//8 9
"//9 :
;//: ;
var00 

folderPath00 
=00  
Path00! %
.00% &
Combine00& -
(00- .
_environment00. :
.00: ;
ContentRootPath00; J
,00J K
$str00L U
,00U V
$str00W ^
)00^ _
;00_ `
if22 
(22 
!22 
	Directory22 
.22 
Exists22 %
(22% &

folderPath22& 0
)220 1
)221 2
	Directory33 
.33 
CreateDirectory33 -
(33- .

folderPath33. 8
)338 9
;339 :
var55 
filePath55 
=55 
Path55 #
.55# $
Combine55$ +
(55+ ,

folderPath55, 6
,556 7
uniqueFileName558 F
)55F G
;55G H
using77 
(77 
var77 
stream77 !
=77" #
new77$ '

FileStream77( 2
(772 3
filePath773 ;
,77; <
FileMode77= E
.77E F
Create77F L
)77L M
)77M N
{88 
await99 
file99 
.99 
CopyToAsync99 *
(99* +
stream99+ 1
)991 2
;992 3
}:: 
var<< 
relativePath<<  
=<<! "
$"<<# %
$str<<% +
{<<+ ,
uniqueFileName<<, :
}<<: ;
"<<; <
;<<< =
return== 
Ok== 
(== 
new== 
{== 
FilePath==  (
===) *
relativePath==+ 7
}==8 9
)==9 :
;==: ;
}>> 
catch?? 
(?? 
	Exception?? 
ex?? 
)??  
{@@ 
returnAA 

StatusCodeAA !
(AA! "
$numAA" %
,AA% &
$"AA' )
$strAA) O
{AAO P
exAAP R
.AAR S
MessageAAS Z
}AAZ [
"AA[ \
)AA\ ]
;AA] ^
}BB 
}CC 	
}DD 
}EE Ú
OC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\UsuariosController.cs
	namespace		 	
WebApp		
 
.		 
Controllers		 
{

 
[ 
Route 

(
 
Routes 
. 
USUARIOS 
) 
] 
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class 
UsuariosController #
:$ %
BaseController& 4
{ 
private 
readonly 
IUsuarioService (
_iUsuarioService) 9
;9 :
private 
readonly  
IAuthenticateService -
	_iService. 7
;7 8
private 
readonly 
IRecoverUserService ,
_iServiceRecover- =
;= >
public 
UsuariosController !
(! "
IUsuarioService" 1
iUsuarioService2 A
,A B 
IAuthenticateServiceC W
iServiceX `
,` a
IRecoverUserServiceb u
iServiceRecover	v 
,
 
ILogger
 
<
  
UsuariosController
 ¡
>
¡ ¢
logger
£ ©
)
© ª
:
« ¬
base
­ ±
(
± ²
logger
² ¸
)
¸ ¹
{ 	
this 
. 
_iUsuarioService !
=" #
iUsuarioService$ 3
;3 4
this 
. 
	_iService 
= 
iService %
;% &
this 
. 
_iServiceRecover !
=" #
iServiceRecover$ 3
;3 4
} 	
[)) 	
AllowAnonymous))	 
])) 
[** 	
HttpPost**	 
(** 
Routes** 
.** 
LOGIN** 
)** 
]**  
public++ 
IActionResult++ 
Login++ "
(++" #
[++# $
FromBody++$ ,
]++, -#
UsuarioAutenticacionDto++. E#
usuarioAutenticacionDto++F ]
)++] ^
{,, 	
try-- 
{.. 
var// 
result// 
=// 
	_iService// &
.//& '
Authenticate//' 3
(//3 4#
usuarioAutenticacionDto//4 K
)//K L
;//L M
if11 
(11 
!11 
result11 
.11 
	IsSuccess11 %
)11% &
{22 
return33 
BadRequestResponse33 -
(33- .
result33. 4
.334 5
ErrorMessage335 A
)33A B
;33B C
}44 
return66 
Ok66 
(66 
new66 
RespuestasAPI66 +
<66+ ,#
AuthenticateResponseDto66, C
>66C D
{77 
Result88 
=88 
result88 #
.88# $
Value88$ )
}99 
)99 
;99 
}:: 
catch;; 
(;; 
	Exception;; 
e;; 
);; 
{<< 
return== 
HandleException== &
(==& '
e==' (
,==( )
nameof==* 0
(==0 1
Login==1 6
)==6 7
)==7 8
;==8 9
}>> 
}?? 	
[JJ 	
AllowAnonymousJJ	 
]JJ 
[KK 	
HttpPostKK	 
(KK 
RoutesKK 
.KK 
VALIDARKK  
)KK  !
]KK! "
publicLL 
IActionResultLL 
ValidarLL $
(LL$ %
[LL% &
FromBodyLL& .
]LL. /
AuthValidationDtoLL0 A
authValidationDtoLLB S
)LLS T
{MM 	
tryNN 
{OO 
varPP 
resultPP 
=PP 
	_iServicePP &
.PP& '
ValidateCodePP' 3
(PP3 4
authValidationDtoPP4 E
)PPE F
;PPF G
ifRR 
(RR 
!RR 
resultRR 
.RR 
	IsSuccessRR %
)RR% &
{SS 
returnTT 
BadRequestResponseTT -
(TT- .
resultTT. 4
.TT4 5
ErrorMessageTT5 A
)TTA B
;TTB C
}UU 
returnWW 
OkWW 
(WW 
newWW 
RespuestasAPIWW +
<WW+ ,,
 UsuarioAutenticacionRespuestaDtoWW, L
>WWL M
{XX 
ResultYY 
=YY 
resultYY #
.YY# $
ValueYY$ )
}ZZ 
)ZZ 
;ZZ 
}[[ 
catch\\ 
(\\ 
	Exception\\ 
e\\ 
)\\ 
{]] 
return^^ 
HandleException^^ &
(^^& '
e^^' (
,^^( )
nameof^^* 0
(^^0 1
Validar^^1 8
)^^8 9
)^^9 :
;^^: ;
}__ 
}`` 	
[jj 	
AllowAnonymousjj	 
]jj 
[kk 	
HttpPostkk	 
(kk 
Routeskk 
.kk 
	RECUPERARkk "
)kk" #
]kk# $
publicll 
IActionResultll 
RecoverAsyncll )
(ll) *
[ll* +
FromBodyll+ 3
]ll3 4"
UsuarioRecuperacionDtoll5 K"
usuarioRecuperacionDtollL b
)llb c
{mm 	
trynn 
{oo 
varpp 
resultpp 
=pp 
_iServiceRecoverpp -
.pp- .
RecoverPasswordpp. =
(pp= >"
usuarioRecuperacionDtopp> T
)ppT U
;ppU V
ifrr 
(rr 
!rr 
resultrr 
.rr 
	IsSuccessrr %
)rr% &
{ss 
returntt 
BadRequestResponsett -
(tt- .
resulttt. 4
.tt4 5
ErrorMessagett5 A
)ttA B
;ttB C
}uu 
returnww 
Okww 
(ww 
newww 
RespuestasAPIww +
<ww+ ,
boolww, 0
>ww0 1
{xx 
Resultyy 
=yy 
resultyy #
.yy# $
Valueyy$ )
}zz 
)zz 
;zz 
}{{ 
catch|| 
(|| 
	Exception|| 
e|| 
)|| 
{}} 
return~~ 
HandleException~~ &
(~~& '
e~~' (
,~~( )
nameof~~* 0
(~~0 1
RecoverAsync~~1 =
)~~= >
)~~> ?
;~~? @
} 
}
 	
[
 	
AllowAnonymous
	 
]
 
[
 	
HttpPost
	 
(
 
Routes
 
.
 
REGISTRO
 !
)
! "
]
" #
public
 
IActionResult
 
Create
 #
(
# $
[
$ %
FromBody
% -
]
- .

UsuarioDto
/ 9
dto
: =
)
= >
{
 	
try
 
{
 
bool
 
validarEmailUnico
 &
=
' (
_iUsuarioService
) 9
.
9 :
IsUniqueUser
: F
(
F G
dto
G J
.
J K
Email
K P
??
Q S
$str
T V
)
V W
;
W X
if
 
(
 
!
 
validarEmailUnico
 &
)
& '
{
 
return
  
BadRequestResponse
 -
(
- .
$str
. N
)
N O
;
O P
}
 
return
 
Ok
 
(
 
new
 
RespuestasAPI
 +
<
+ ,
bool
, 0
>
0 1
{
 
	IsSuccess
 
=
 
_iUsuarioService
  0
.
0 1
Create
1 7
(
7 8
dto
8 ;
)
; <
}
 
)
 
;
 
}
 
catch
 
(
 
	Exception
 
e
 
)
 
{
 
return
 
HandleException
 &
(
& '
e
' (
,
( )
nameof
* 0
(
0 1
Create
1 7
)
7 8
)
8 9
;
9 :
}
 
}
   	
[
©© 	
	Authorize
©©	 
]
©© 
[
ªª 	
HttpGet
ªª	 
]
ªª 
public
«« 
IActionResult
«« 
FindAll
«« $
(
««$ %
)
««% &
{
¬¬ 	
try
­­ 
{
®® 
return
¯¯ 
Ok
¯¯ 
(
¯¯ 
new
¯¯ 
RespuestasAPI
¯¯ +
<
¯¯+ ,
List
¯¯, 0
<
¯¯0 1

UsuarioDto
¯¯1 ;
>
¯¯; <
>
¯¯< =
{
°° 
Result
±± 
=
±± 
_iUsuarioService
±± -
.
±±- .
FindAll
±±. 5
(
±±5 6
)
±±6 7
}
²² 
)
²² 
;
²² 
}
³³ 
catch
´´ 
(
´´ 
	Exception
´´ 
e
´´ 
)
´´ 
{
µµ 
return
¶¶ 
HandleException
¶¶ &
(
¶¶& '
e
¶¶' (
,
¶¶( )
nameof
¶¶* 0
(
¶¶0 1
FindAll
¶¶1 8
)
¶¶8 9
)
¶¶9 :
;
¶¶: ;
}
·· 
}
¸¸ 	
[
ÂÂ 	
	Authorize
ÂÂ	 
]
ÂÂ 
[
ÃÃ 	
HttpGet
ÃÃ	 
(
ÃÃ 
$str
ÃÃ "
,
ÃÃ" #
Name
ÃÃ$ (
=
ÃÃ) *
$str
ÃÃ+ 5
)
ÃÃ5 6
]
ÃÃ6 7
public
ÄÄ 
IActionResult
ÄÄ 
FindById
ÄÄ %
(
ÄÄ% &
int
ÄÄ& )
	idUsuario
ÄÄ* 3
)
ÄÄ3 4
{
ÅÅ 	
try
ÆÆ 
{
ÇÇ 
var
ÈÈ 
itemUsuario
ÈÈ 
=
ÈÈ  !
_iUsuarioService
ÈÈ" 2
.
ÈÈ2 3
FindById
ÈÈ3 ;
(
ÈÈ; <
	idUsuario
ÈÈ< E
)
ÈÈE F
;
ÈÈF G
if
ÊÊ 
(
ÊÊ 
itemUsuario
ÊÊ 
==
ÊÊ  "
null
ÊÊ# '
)
ÊÊ' (
{
ËË 
return
ÌÌ 
NotFoundResponse
ÌÌ +
(
ÌÌ+ ,
$str
ÌÌ, C
)
ÌÌC D
;
ÌÌD E
}
ÍÍ 
return
ÏÏ 
Ok
ÏÏ 
(
ÏÏ 
new
ÏÏ 
RespuestasAPI
ÏÏ +
<
ÏÏ+ ,

UsuarioDto
ÏÏ, 6
>
ÏÏ6 7
{
ÐÐ 
Result
ÑÑ 
=
ÑÑ 
itemUsuario
ÑÑ (
}
ÒÒ 
)
ÒÒ 
;
ÒÒ 
}
ÓÓ 
catch
ÔÔ 
(
ÔÔ 
	Exception
ÔÔ 
e
ÔÔ 
)
ÔÔ 
{
ÕÕ 
return
ÖÖ 
HandleException
ÖÖ &
(
ÖÖ& '
e
ÖÖ' (
,
ÖÖ( )
nameof
ÖÖ* 0
(
ÖÖ0 1
FindById
ÖÖ1 9
)
ÖÖ9 :
)
ÖÖ: ;
;
ÖÖ; <
}
×× 
}
ØØ 	
[
ââ 	
	Authorize
ââ	 
]
ââ 
[
ãã 	
HttpPut
ãã	 
(
ãã 
$str
ãã "
,
ãã" #
Name
ãã$ (
=
ãã) *
$str
ãã+ 3
)
ãã3 4
]
ãã4 5
public
ää 
IActionResult
ää 
Update
ää #
(
ää# $
int
ää$ '
	idUsuario
ää( 1
,
ää1 2
[
ää3 4
FromBody
ää4 <
]
ää< =

UsuarioDto
ää> H
dto
ääI L
)
ääL M
{
åå 	
try
ææ 
{
çç 
dto
èè 
.
èè 
	IdUsuario
èè 
=
èè 
	idUsuario
èè  )
;
èè) *
return
éé 
Ok
éé 
(
éé 
new
éé 
RespuestasAPI
éé +
<
éé+ ,
bool
éé, 0
>
éé0 1
{
êê 
	IsSuccess
ëë 
=
ëë 
_iUsuarioService
ëë  0
.
ëë0 1
Update
ëë1 7
(
ëë7 8
dto
ëë8 ;
)
ëë; <
}
ìì 
)
ìì 
;
ìì 
}
íí 
catch
îî 
(
îî 
	Exception
îî 
e
îî 
)
îî 
{
ïï 
return
ðð 
HandleException
ðð &
(
ðð& '
e
ðð' (
,
ðð( )
nameof
ðð* 0
(
ðð0 1
Update
ðð1 7
)
ðð7 8
)
ðð8 9
;
ðð9 :
}
ññ 
}
òò 	
[
üü 	
	Authorize
üü	 
]
üü 
[
ýý 	

HttpDelete
ýý	 
(
ýý 
$str
ýý %
,
ýý% &
Name
ýý' +
=
ýý, -
$str
ýý. :
)
ýý: ;
]
ýý; <
public
þþ 
IActionResult
þþ 

Deactivate
þþ '
(
þþ' (
int
þþ( +
	idUsuario
þþ, 5
)
þþ5 6
{
ÿÿ 	
try
 
{
 
bool
 
response
 
=
 
_iUsuarioService
  0
.
0 1

Deactivate
1 ;
(
; <
	idUsuario
< E
)
E F
;
F G
if
 
(
 
!
 
response
 
)
 
{
 
return
 
NotFoundResponse
 +
(
+ ,
$str
, F
)
F G
;
G H
}
 
return
 
Ok
 
(
 
new
 
RespuestasAPI
 +
<
+ ,
bool
, 0
>
0 1
{
 
	IsSuccess
 
=
 
response
  (
}
 
)
 
;
 
}
 
catch
 
(
 
	Exception
 
e
 
)
 
{
 
return
 
HandleException
 &
(
& '
e
' (
,
( )
nameof
* 0
(
0 1

Deactivate
1 ;
)
; <
)
< =
;
= >
}
 
}
 	
[
 	
	Authorize
	 
]
 
[
 	
HttpGet
	 
(
 
Routes
 
.
 
VALIDAR_EMAIL
 %
)
% &
]
& '
public
 
IActionResult
 
ValidarEmail
 )
(
) *
[
* +
	FromQuery
+ 4
]
4 5
string
6 <
email
= B
)
B C
{
 	
try
 
{
 
bool
   
isUnique
   
=
   
_iUsuarioService
    0
.
  0 1
IsUniqueUser
  1 =
(
  = >
email
  > C
)
  C D
;
  D E
return
¡¡ 
Ok
¡¡ 
(
¡¡ 
isUnique
¡¡ "
)
¡¡" #
;
¡¡# $
}
¢¢ 
catch
££ 
(
££ 
	Exception
££ 
e
££ 
)
££ 
{
¤¤ 
return
¥¥ 
HandleException
¥¥ &
(
¥¥& '
e
¥¥' (
,
¥¥( )
nameof
¥¥* 0
(
¥¥0 1
ValidarEmail
¥¥1 =
)
¥¥= >
)
¥¥> ?
;
¥¥? @
}
¦¦ 
}
§§ 	
[
­­ 	
	Authorize
­­	 
]
­­ 
[
®® 	
HttpPost
®®	 
(
®® 
Routes
®® 
.
®® 
CAMBIAR_CLAVE
®® &
)
®®& '
]
®®' (
public
¯¯ 
IActionResult
¯¯ 
CambiarClave
¯¯ )
(
¯¯) *
[
¯¯* +
FromBody
¯¯+ 3
]
¯¯3 4$
UsuarioCambiarClaveDto
¯¯5 K
usuario
¯¯L S
)
¯¯S T
{
°° 	
try
±± 
{
²² 
var
³³ 
result
³³ 
=
³³ 
_iUsuarioService
³³ -
.
³³- .
ChangePasswd
³³. :
(
³³: ;
usuario
³³; B
.
³³B C
Clave
³³C H
,
³³H I
usuario
³³J Q
.
³³Q R

ClaveNueva
³³R \
)
³³\ ]
;
³³] ^
if
µµ 
(
µµ 
!
µµ 
result
µµ 
.
µµ 
	IsSuccess
µµ %
)
µµ% &
{
¶¶ 
return
··  
BadRequestResponse
·· -
(
··- .
result
··. 4
.
··4 5
ErrorMessage
··5 A
)
··A B
;
··B C
}
¸¸ 
return
ºº 
Ok
ºº 
(
ºº 
new
ºº 
RespuestasAPI
ºº +
<
ºº+ ,
bool
ºº, 0
>
ºº0 1
{
»» 
Result
¼¼ 
=
¼¼ 
result
¼¼ #
.
¼¼# $
Value
¼¼$ )
}
½½ 
)
½½ 
;
½½ 
}
¾¾ 
catch
¿¿ 
(
¿¿ 
	Exception
¿¿ 
e
¿¿ 
)
¿¿ 
{
ÀÀ 
return
ÁÁ 
HandleException
ÁÁ &
(
ÁÁ& '
e
ÁÁ' (
,
ÁÁ( )
nameof
ÁÁ* 0
(
ÁÁ0 1
Login
ÁÁ1 6
)
ÁÁ6 7
)
ÁÁ7 8
;
ÁÁ8 9
}
ÂÂ 
}
ÃÃ 	
}
ÄÄ 
}ÅÅ æ1
VC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\UsuarioEndpointController.cs
	namespace 	
WebApp
 
. 
Controllers 
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class %
UsuarioEndpointController *
:+ ,
BaseController- ;
{ 
private 
readonly "
IUsuarioEndpontService /"
_usuarioEndpontService0 F
;F G
private 
readonly 
IMapper  
_mapper! (
;( )
public %
UsuarioEndpointController (
(( )"
IUsuarioEndpontService) ?!
usuarioEndpontService@ U
,U V
IMapperW ^
mapper_ e
,e f
ILoggerg n
<n o&
UsuarioEndpointController	o 
>
 
logger
 
)
 
:
 
base
 
(
 
logger
 
)
  
{ 	
this 
. "
_usuarioEndpontService '
=( )!
usuarioEndpontService* ?
;? @
this 
. 
_mapper 
= 
mapper !
;! "
} 	
[&& 	
	Authorize&&	 
]&& 
['' 	
HttpPost''	 
]'' 
public(( 
IActionResult(( 
Create(( #
(((# $
[(($ %
FromBody((% -
]((- .-
!UsuarioEndpointPermisoRegistroDto((/ P
data((Q U
)((U V
{)) 	
try** 
{++ 
return,, 
Ok,, 
(,, 
new,, 
RespuestasAPI,, +
<,,+ ,
bool,,, 0
>,,0 1
{-- 
	IsSuccess.. 
=.. "
_usuarioEndpontService..  6
...6 7
Create..7 =
(..= >
_mapper..> E
...E F
Map..F I
<..I J
UsuarioEndpoint..J Y
>..Y Z
(..Z [
data..[ _
).._ `
)..` a
}// 
)// 
;// 
}00 
catch11 
(11 
	Exception11 
e11 
)11 
{22 
return33 
HandleException33 &
(33& '
e33' (
,33( )
nameof33* 0
(330 1
Create331 7
)337 8
)338 9
;339 :
}44 
}55 	
[== 	
	Authorize==	 
]== 
[>> 	
HttpGet>>	 
]>> 
public?? 
IActionResult?? 
FindAll?? $
(??$ %
)??% &
{@@ 	
tryAA 
{BB 
returnCC 
OkCC 
(CC 
newCC 
RespuestasAPICC +
<CC+ ,
ListCC, 0
<CC0 1%
UsuarioEndpointPermisoDtoCC1 J
>CCJ K
>CCK L
{DD 
ResultEE 
=EE 
_mapperEE $
.EE$ %
MapEE% (
<EE( )
ListEE) -
<EE- .%
UsuarioEndpointPermisoDtoEE. G
>EEG H
>EEH I
(EEI J"
_usuarioEndpontServiceEEJ `
.EE` a
FindAllEEa h
(EEh i
)EEi j
)EEj k
}FF 
)FF 
;FF 
}GG 
catchHH 
(HH 
	ExceptionHH 
eHH 
)HH 
{II 
returnJJ 
HandleExceptionJJ &
(JJ& '
eJJ' (
,JJ( )
nameofJJ* 0
(JJ0 1
FindAllJJ1 8
)JJ8 9
)JJ9 :
;JJ: ;
}KK 
}LL 	
[VV 	
	AuthorizeVV	 
]VV 
[WW 	
HttpGetWW	 
(WW 
$strWW #
,WW# $
NameWW% )
=WW* +
$strWW, >
)WW> ?
]WW? @
publicXX 
IActionResultXX 
FindByEndpointIdXX -
(XX- .
intXX. 1

endpointIdXX2 <
)XX< =
{YY 	
tryZZ 
{[[ 
var\\ 
itemUsuario\\ 
=\\  !"
_usuarioEndpontService\\" 8
.\\8 9
FindByEndpointId\\9 I
(\\I J

endpointId\\J T
)\\T U
;\\U V
if^^ 
(^^ 
itemUsuario^^ 
==^^  "
null^^# '
)^^' (
{__ 
return`` 
NotFoundResponse`` +
(``+ ,

Constantes``, 6
.``6 7)
MESAGGE_REGISTRO_NO_ENCOTRADO``7 T
)``T U
;``U V
}aa 
returncc 
Okcc 
(cc 
newcc 
RespuestasAPIcc +
<cc+ ,

UsuarioDtocc, 6
>cc6 7
{dd 
Resultee 
=ee 
_mapperee $
.ee$ %
Mapee% (
<ee( )

UsuarioDtoee) 3
>ee3 4
(ee4 5
itemUsuarioee5 @
)ee@ A
}ff 
)ff 
;ff 
}gg 
catchhh 
(hh 
	Exceptionhh 
ehh 
)hh 
{ii 
returnjj 
HandleExceptionjj &
(jj& '
ejj' (
,jj( )
nameofjj* 0
(jj0 1
FindByEndpointIdjj1 A
)jjA B
)jjB C
;jjC D
}kk 
}ll 	
}nn 
}oo E
PC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\ThesaurusController.cs
	namespace

 	
WebApp


 
.

 
Controllers

 
{ 
[ 
	Authorize 
] 
[ 
Route 

(
 
Routes 
. 
	THESAURUS 
) 
] 
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class 
ThesaurusController $
:% &
BaseController' 5
{ 
private 
readonly 
IThesaurusService *
_thesaurusService+ <
;< =
public 
ThesaurusController "
(" #
IThesaurusService# 4
thesaurusService5 E
,E F
ILoggerG N
<N O
ThesaurusControllerO b
>b c
loggerd j
)j k
:l m
basen r
(r s
loggers y
)y z
{ 	
this 
. 
_thesaurusService "
=# $
thesaurusService% 5
;5 6
} 	
[$$ 	
HttpGet$$	 
($$ 
Routes$$ 
.$$ 
GET_THESAURUS$$ %
)$$% &
]$$& '
public%% 
IActionResult%% 
ObtenerThesaurus%% -
(%%- .
)%%. /
{&& 	
try'' 
{(( 
return)) 
Ok)) 
()) 
new)) 
RespuestasAPI)) +
<))+ ,
ThesaurusDto)), 8
>))8 9
{** 
Result++ 
=++ 
_thesaurusService++ .
.++. /
ObtenerThesaurus++/ ?
(++? @
)++@ A
},, 
),, 
;,, 
}-- 
catch.. 
(.. 
	Exception.. 
e.. 
).. 
{// 
return00 
HandleException00 &
(00& '
e00' (
,00( )
nameof00* 0
(000 1
ObtenerThesaurus001 A
)00A B
)00B C
;00C D
}11 
}22 	
[;; 	
HttpPost;;	 
(;; 
Routes;; 
.;; 
THESAURUS_AGREGAR;; *
);;* +
];;+ ,
public<< 
IActionResult<< 
AgregarExpansion<< -
(<<- .
[<<. /
FromBody<</ 7
]<<7 8
List<<9 =
<<<= >
string<<> D
><<D E
	sinonimos<<F O
)<<O P
{== 	
try>> 
{?? 
return@@ 
Ok@@ 
(@@ 
new@@ 
RespuestasAPI@@ +
<@@+ ,
string@@, 2
>@@2 3
{AA 
ResultBB 
=BB 
_thesaurusServiceBB .
.BB. /
AgregarExpansionBB/ ?
(BB? @
	sinonimosBB@ I
)BBI J
}CC 
)CC 
;CC 
}DD 
catchEE 
(EE 
	ExceptionEE 
eEE 
)EE 
{FF 
returnGG 
HandleExceptionGG &
(GG& '
eGG' (
,GG( )
nameofGG* 0
(GG0 1
AgregarExpansionGG1 A
)GGA B
)GGB C
;GGC D
}HH 
}II 	
[RR 	
HttpPostRR	 
(RR 
RoutesRR 
.RR  
THESAURUS_ACTUALIZARRR -
)RR- .
]RR. /
publicSS 
IActionResultSS 
ActualizarExpansionSS 0
(SS0 1
[SS1 2
FromBodySS2 :
]SS: ;
ListSS< @
<SS@ A
ExpansionDtoSSA M
>SSM N

expansionsSSO Y
)SSY Z
{TT 	
tryUU 
{VV 
returnWW 
OkWW 
(WW 
newWW 
RespuestasAPIWW +
<WW+ ,
stringWW, 2
>WW2 3
{XX 
ResultYY 
=YY 
_thesaurusServiceYY .
.YY. /
ActualizarExpansionYY/ B
(YYB C

expansionsYYC M
)YYM N
}ZZ 
)ZZ 
;ZZ 
}[[ 
catch\\ 
(\\ 
	Exception\\ 
e\\ 
)\\ 
{]] 
return^^ 
HandleException^^ &
(^^& '
e^^' (
,^^( )
nameof^^* 0
(^^0 1
ActualizarExpansion^^1 D
)^^D E
)^^E F
;^^F G
}__ 
}`` 	
[jj 	
HttpGetjj	 
(jj 
Routesjj 
.jj !
THESAURUS_AGREGAR_SUBjj -
)jj- .
]jj. /
publickk 
IActionResultkk 
AgregarSubExpansionkk 0
(kk0 1
[kk1 2
	FromRoutekk2 ;
]kk; <
stringkk= C
expansionExistentekkD V
,kkV W
stringkkX ^
nuevoSubkk_ g
)kkg h
{ll 	
trymm 
{nn 
returnoo 
Okoo 
(oo 
newoo 
RespuestasAPIoo +
<oo+ ,
stringoo, 2
>oo2 3
{pp 
Resultqq 
=qq 
_thesaurusServiceqq .
.qq. / 
AgregarSubAExpansionqq/ C
(qqC D
expansionExistenteqqD V
,qqV W
nuevoSubqqX `
)qq` a
}rr 
)rr 
;rr 
}ss 
catchtt 
(tt 
	Exceptiontt 
ett 
)tt 
{uu 
returnvv 
HandleExceptionvv &
(vv& '
evv' (
,vv( )
nameofvv* 0
(vv0 1
AgregarSubExpansionvv1 D
)vvD E
)vvE F
;vvF G
}ww 
}xx 	
[
 	
HttpGet
	 
(
 
Routes
 
.
  
THESAURUS_EJECUTAR
 *
)
* +
]
+ ,
public
 
IActionResult
 
EjecutarBat
 (
(
( )
)
) *
{
 	
try
 
{
 
return
 
Ok
 
(
 
new
 
RespuestasAPI
 +
<
+ ,
string
, 2
>
2 3
{
 
Result
 
=
 
_thesaurusService
 .
.
. / 
EjecutarArchivoBat
/ A
(
A B
)
B C
}
 
)
 
;
 
}
 
catch
 
(
 
	Exception
 
e
 
)
 
{
 
return
 
HandleException
 &
(
& '
e
' (
,
( )
nameof
* 0
(
0 1
EjecutarBat
1 <
)
< =
)
= >
;
> ?
}
 
}
 	
[
 	
HttpGet
	 
(
 
Routes
 
.
 
THESAURUS_RESET
 '
)
' (
]
( )
public
 
IActionResult
 
ResetSQLServer
 +
(
+ ,
)
, -
{
 	
try
 
{
 
return
 
Ok
 
(
 
new
 
RespuestasAPI
 +
<
+ ,
string
, 2
>
2 3
{
 
Result
 
=
 
_thesaurusService
 .
.
. /
ResetSQLServer
/ =
(
= >
)
> ?
}
   
)
   
;
   
}
¡¡ 
catch
¢¢ 
(
¢¢ 
	Exception
¢¢ 
e
¢¢ 
)
¢¢ 
{
££ 
return
¤¤ 
HandleException
¤¤ &
(
¤¤& '
e
¤¤' (
,
¤¤( )
nameof
¤¤* 0
(
¤¤0 1
ResetSQLServer
¤¤1 ?
)
¤¤? @
)
¤¤@ A
;
¤¤A B
}
¥¥ 
}
¦¦ 	
}
¨¨ 
}©© Ë
NC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\ReporteController.cs
	namespace		 	
WebApp		
 
.		 
Controllers		 
{

 
[ 
Route 

(
 
Routes 
. 
REPORTES_VISTA  
)  !
]! "
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class 
ReporteController "
:# $
BaseController% 3
{ 
private 
readonly 
IReporteService (
_reporteService) 8
;8 9
public 
ReporteController  
(  !
IReporteService! 0
reporteService1 ?
,? @
ILoggerA H
<H I
ReporteControllerI Z
>Z [
logger\ b
)b c
:d e
basef j
(j k
loggerk q
)q r
{ 	
this 
. 
_reporteService  
=! "
reporteService# 1
;1 2
} 	
["" 	
	Authorize""	 
]"" 
[## 	
HttpGet##	 
(## 
Routes## 
.## 
FIND_BY_VISTA## %
)##% &
]##& '
public$$ 
IActionResult$$ 
findByVista$$ (
($$( )
string$$) /
codigoHomologacion$$0 B
)$$B C
{%% 	
try&& 
{'' 
var(( 
homologacion((  
=((! "
_reporteService((# 2
.((2 3
findByVista((3 >
(((> ?
codigoHomologacion((? Q
)((Q R
;((R S
if** 
(** 
homologacion**  
==**! #
null**$ (
)**( )
{++ 
return,, 
NotFound,, #
(,,# $
new,,$ '
RespuestasAPI,,( 5
<,,5 6
VwHomologacionDto,,6 G
>,,G H
{-- 
Result.. 
=..  
new..! $
VwHomologacionDto..% 6
(..6 7
)..7 8
}// 
)// 
;// 
}00 
var22 
homologacionDto22 #
=22$ %
homologacion22& 2
;222 3
return44 
Ok44 
(44 
new44 
RespuestasAPI44 +
<44+ ,
VwHomologacionDto44, =
>44= >
{55 
Result66 
=66 
homologacionDto66 ,
}77 
)77 
;77 
}88 
catch99 
(99 
	Exception99 
e99 
)99 
{:: 
return;; 
HandleException;; &
(;;& '
e;;' (
,;;( )
nameof;;* 0
(;;0 1
findByVista;;1 <
);;< =
);;= >
;;;> ?
}<< 
}== 	
[EE 	
	AuthorizeEE	 
]EE 
[FF 	
HttpGetFF	 
(FF 
RoutesFF 
.FF 
ACREDITACION_ONAFF (
)FF( )
]FF) *
publicGG 
IActionResultGG "
ObtenerAcreditacionOnaGG 3
(GG3 4
)GG4 5
{HH 	
tryII 
{JJ 
returnKK 
OkKK 
(KK 
newKK 
RespuestasAPIKK +
<KK+ ,
ListKK, 0
<KK0 1 
VwAcreditacionOnaDtoKK1 E
>KKE F
>KKF G
{LL 
ResultMM 
=MM 
_reporteServiceMM ,
.MM, -$
ObtenerVwAcreditacionOnaMM- E
(MME F
)MMF G
}NN 
)NN 
;NN 
}OO 
catchPP 
(PP 
	ExceptionPP 
ePP 
)PP 
{QQ 
returnRR 
HandleExceptionRR &
(RR& '
eRR' (
,RR( )
nameofRR* 0
(RR0 1"
ObtenerAcreditacionOnaRR1 G
)RRG H
)RRH I
;RRI J
}SS 
}TT 	
[\\ 	
	Authorize\\	 
]\\ 
[]] 	
HttpGet]]	 
(]] 
Routes]] 
.]]  
ACREDITACION_ESQUEMA]] ,
)]], -
]]]- .
public^^ 
IActionResult^^ &
ObtenerAcreditacionEsquema^^ 7
(^^7 8
)^^8 9
{__ 	
try`` 
{aa 
returnbb 
Okbb 
(bb 
newbb 
RespuestasAPIbb +
<bb+ ,
Listbb, 0
<bb0 1$
VwAcreditacionEsquemaDtobb1 I
>bbI J
>bbJ K
{cc 
Resultdd 
=dd 
_reporteServicedd ,
.dd, -(
ObtenerVwAcreditacionEsquemadd- I
(ddI J
)ddJ K
}ee 
)ee 
;ee 
}ff 
catchgg 
(gg 
	Exceptiongg 
egg 
)gg 
{hh 
returnii 
HandleExceptionii &
(ii& '
eii' (
,ii( )
nameofii* 0
(ii0 1&
ObtenerAcreditacionEsquemaii1 K
)iiK L
)iiL M
;iiM N
}jj 
}kk 	
[ss 	
	Authorizess	 
]ss 
[tt 	
HttpGettt	 
(tt 
Routestt 
.tt 
ESTADO_ESQUEMAtt &
)tt& '
]tt' (
publicuu 
IActionResultuu  
ObtenerEstadoEsquemauu 1
(uu1 2
)uu2 3
{vv 	
tryww 
{xx 
returnyy 
Okyy 
(yy 
newyy 
RespuestasAPIyy +
<yy+ ,
Listyy, 0
<yy0 1
VwEstadoEsquemaDtoyy1 C
>yyC D
>yyD E
{zz 
Result{{ 
={{ 
_reporteService{{ ,
.{{, -"
ObtenerVwEstadoEsquema{{- C
({{C D
){{D E
}|| 
)|| 
;|| 
}}} 
catch~~ 
(~~ 
	Exception~~ 
e~~ 
)~~ 
{ 
return
 
HandleException
 &
(
& '
e
' (
,
( )
nameof
* 0
(
0 1"
ObtenerEstadoEsquema
1 E
)
E F
)
F G
;
G H
}
 
}
 	
[
 	
	Authorize
	 
]
 
[
 	
HttpGet
	 
(
 
Routes
 
.
 
OEC_PAIS
  
)
  !
]
! "
public
 
IActionResult
 
ObtenerOecPais
 +
(
+ ,
)
, -
{
 	
try
 
{
 
return
 
Ok
 
(
 
new
 
RespuestasAPI
 +
<
+ ,
List
, 0
<
0 1
VwOecPaisDto
1 =
>
= >
>
> ?
{
 
Result
 
=
 
_reporteService
 ,
.
, -
ObtenerVwOecPais
- =
(
= >
)
> ?
}
 
)
 
;
 
}
 
catch
 
(
 
	Exception
 
e
 
)
 
{
 
return
 
HandleException
 &
(
& '
e
' (
,
( )
nameof
* 0
(
0 1
ObtenerOecPais
1 ?
)
? @
)
@ A
;
A B
}
 
}
 	
[
¡¡ 	
	Authorize
¡¡	 
]
¡¡ 
[
¢¢ 	
HttpGet
¢¢	 
(
¢¢ 
Routes
¢¢ 
.
¢¢ 
ESQUEMA_PAIS
¢¢ $
)
¢¢$ %
]
¢¢% &
public
££ 
IActionResult
££  
ObtenerEsquemaPais
££ /
(
££/ 0
)
££0 1
{
¤¤ 	
try
¥¥ 
{
¦¦ 
return
§§ 
Ok
§§ 
(
§§ 
new
§§ 
RespuestasAPI
§§ +
<
§§+ ,
List
§§, 0
<
§§0 1
VwEsquemaPaisDto
§§1 A
>
§§A B
>
§§B C
{
¨¨ 
Result
©© 
=
©© 
_reporteService
©© ,
.
©©, -"
ObtenerVwEsquemaPais
©©- A
(
©©A B
)
©©B C
}
ªª 
)
ªª 
;
ªª 
}
«« 
catch
¬¬ 
(
¬¬ 
	Exception
¬¬ 
e
¬¬ 
)
¬¬ 
{
­­ 
return
®® 
HandleException
®® &
(
®®& '
e
®®' (
,
®®( )
nameof
®®* 0
(
®®0 1 
ObtenerEsquemaPais
®®1 C
)
®®C D
)
®®D E
;
®®E F
}
¯¯ 
}
°° 	
[
¸¸ 	
	Authorize
¸¸	 
]
¸¸ 
[
¹¹ 	
HttpGet
¹¹	 
(
¹¹ 
Routes
¹¹ 
.
¹¹ 
	OEC_FECHA
¹¹ !
)
¹¹! "
]
¹¹" #
public
ºº 
IActionResult
ºº 
ObtenerOecFecha
ºº ,
(
ºº, -
)
ºº- .
{
»» 	
try
¼¼ 
{
½½ 
return
¾¾ 
Ok
¾¾ 
(
¾¾ 
new
¾¾ 
RespuestasAPI
¾¾ +
<
¾¾+ ,
List
¾¾, 0
<
¾¾0 1
VwOecFechaDto
¾¾1 >
>
¾¾> ?
>
¾¾? @
{
¿¿ 
Result
ÀÀ 
=
ÀÀ 
_reporteService
ÀÀ ,
.
ÀÀ, -
ObtenerVwOecFecha
ÀÀ- >
(
ÀÀ> ?
)
ÀÀ? @
}
ÁÁ 
)
ÁÁ 
;
ÁÁ 
}
ÂÂ 
catch
ÃÃ 
(
ÃÃ 
	Exception
ÃÃ 
e
ÃÃ 
)
ÃÃ 
{
ÄÄ 
return
ÅÅ 
HandleException
ÅÅ &
(
ÅÅ& '
e
ÅÅ' (
,
ÅÅ( )
nameof
ÅÅ* 0
(
ÅÅ0 1
ObtenerOecFecha
ÅÅ1 @
)
ÅÅ@ A
)
ÅÅA B
;
ÅÅB C
}
ÆÆ 
}
ÇÇ 	
[
ÐÐ 	
	Authorize
ÐÐ	 
]
ÐÐ 
[
ÑÑ 	
HttpGet
ÑÑ	 
(
ÑÑ 
Routes
ÑÑ 
.
ÑÑ $
PROFESIONAL_CALIFICADO
ÑÑ .
)
ÑÑ. /
]
ÑÑ/ 0
public
ÒÒ 
IActionResult
ÒÒ *
ObtenerProfesionalCalificado
ÒÒ 9
(
ÒÒ9 :
)
ÒÒ: ;
{
ÓÓ 	
try
ÔÔ 
{
ÕÕ 
return
ÖÖ 
Ok
ÖÖ 
(
ÖÖ 
new
ÖÖ 
RespuestasAPI
ÖÖ +
<
ÖÖ+ ,
List
ÖÖ, 0
<
ÖÖ0 1(
VwProfesionalCalificadoDto
ÖÖ1 K
>
ÖÖK L
>
ÖÖL M
{
×× 
Result
ØØ 
=
ØØ 
_reporteService
ØØ ,
.
ØØ, -,
ObtenerVwProfesionalCalificado
ØØ- K
(
ØØK L
)
ØØL M
}
ÙÙ 
)
ÙÙ 
;
ÙÙ 
}
ÚÚ 
catch
ÛÛ 
(
ÛÛ 
	Exception
ÛÛ 
e
ÛÛ 
)
ÛÛ 
{
ÜÜ 
return
ÝÝ 
HandleException
ÝÝ &
(
ÝÝ& '
e
ÝÝ' (
,
ÝÝ( )
nameof
ÝÝ* 0
(
ÝÝ0 1*
ObtenerProfesionalCalificado
ÝÝ1 M
)
ÝÝM N
)
ÝÝN O
;
ÝÝO P
}
ÞÞ 
}
ßß 	
[
çç 	
	Authorize
çç	 
]
çç 
[
èè 	
HttpGet
èè	 
(
èè 
Routes
èè 
.
èè 
PROFESIONAL_ONA
èè '
)
èè' (
]
èè( )
public
éé 
IActionResult
éé #
ObtenerProfesionalOna
éé 2
(
éé2 3
)
éé3 4
{
êê 	
try
ëë 
{
ìì 
return
íí 
Ok
íí 
(
íí 
new
íí 
RespuestasAPI
íí +
<
íí+ ,
List
íí, 0
<
íí0 1!
VwProfesionalOnaDto
íí1 D
>
ííD E
>
ííE F
{
îî 
Result
ïï 
=
ïï 
_reporteService
ïï ,
.
ïï, -%
ObtenerVwProfesionalOna
ïï- D
(
ïïD E
)
ïïE F
}
ðð 
)
ðð 
;
ðð 
}
ññ 
catch
òò 
(
òò 
	Exception
òò 
e
òò 
)
òò 
{
óó 
return
ôô 
HandleException
ôô &
(
ôô& '
e
ôô' (
,
ôô( )
nameof
ôô* 0
(
ôô0 1#
ObtenerProfesionalOna
ôô1 F
)
ôôF G
)
ôôG H
;
ôôH I
}
õõ 
}
öö 	
[
þþ 	
	Authorize
þþ	 
]
þþ 
[
ÿÿ 	
HttpGet
ÿÿ	 
(
ÿÿ 
Routes
ÿÿ 
.
ÿÿ !
PROFESIONAL_ESQUEMA
ÿÿ +
)
ÿÿ+ ,
]
ÿÿ, -
public
 
IActionResult
 '
ObtenerProfesionalEsquema
 6
(
6 7
)
7 8
{
 	
try
 
{
 
return
 
Ok
 
(
 
new
 
RespuestasAPI
 +
<
+ ,
List
, 0
<
0 1%
VwProfesionalEsquemaDto
1 H
>
H I
>
I J
{
 
Result
 
=
 
_reporteService
 ,
.
, -)
ObtenerVwProfesionalEsquema
- H
(
H I
)
I J
}
 
)
 
;
 
}
 
catch
 
(
 
	Exception
 
e
 
)
 
{
 
return
 
HandleException
 &
(
& '
e
' (
,
( )
nameof
* 0
(
0 1'
ObtenerProfesionalEsquema
1 J
)
J K
)
K L
;
L M
}
 
}
 	
[
 	
	Authorize
	 
]
 
[
 	
HttpGet
	 
(
 
Routes
 
.
 
PROFESIONAL_FECHA
 )
)
) *
]
* +
public
 
IActionResult
 %
ObtenerProfesionalFecha
 4
(
4 5
)
5 6
{
 	
try
 
{
 
return
 
Ok
 
(
 
new
 
RespuestasAPI
 +
<
+ ,
List
, 0
<
0 1#
VwProfesionalFechaDto
1 F
>
F G
>
G H
{
 
Result
 
=
 
_reporteService
 ,
.
, -'
ObtenerVwProfesionalFecha
- F
(
F G
)
G H
}
 
)
 
;
 
}
 
catch
   
(
   
	Exception
   
e
   
)
   
{
¡¡ 
return
¢¢ 
HandleException
¢¢ &
(
¢¢& '
e
¢¢' (
,
¢¢( )
nameof
¢¢* 0
(
¢¢0 1%
ObtenerProfesionalFecha
¢¢1 H
)
¢¢H I
)
¢¢I J
;
¢¢J K
}
££ 
}
¤¤ 	
[
¬¬ 	
	Authorize
¬¬	 
]
¬¬ 
[
­­ 	
HttpGet
­­	 
(
­­ 
Routes
­­ 
.
­­  
CALIFICA_UBICACION
­­ *
)
­­* +
]
­­+ ,
public
®® 
IActionResult
®® &
ObtenerCalificaUbicacion
®® 5
(
®®5 6
)
®®6 7
{
¯¯ 	
try
°° 
{
±± 
return
²² 
Ok
²² 
(
²² 
new
²² 
RespuestasAPI
²² +
<
²²+ ,
List
²², 0
<
²²0 1$
VwCalificaUbicacionDto
²²1 G
>
²²G H
>
²²H I
{
³³ 
Result
´´ 
=
´´ 
_reporteService
´´ ,
.
´´, -(
ObtenerVwCalificaUbicacion
´´- G
(
´´G H
)
´´H I
}
µµ 
)
µµ 
;
µµ 
}
¶¶ 
catch
·· 
(
·· 
	Exception
·· 
e
·· 
)
·· 
{
¸¸ 
return
¹¹ 
HandleException
¹¹ &
(
¹¹& '
e
¹¹' (
,
¹¹( )
nameof
¹¹* 0
(
¹¹0 1&
ObtenerCalificaUbicacion
¹¹1 I
)
¹¹I J
)
¹¹J K
;
¹¹K L
}
ºº 
}
»» 	
[
ÃÃ 	
	Authorize
ÃÃ	 
]
ÃÃ 
[
ÄÄ 	
HttpGet
ÄÄ	 
(
ÄÄ 
Routes
ÄÄ 
.
ÄÄ 
BUSQUEDA_FECHA
ÄÄ &
)
ÄÄ& '
]
ÄÄ' (
public
ÅÅ 
IActionResult
ÅÅ "
ObtenerBusquedaFecha
ÅÅ 1
(
ÅÅ1 2
)
ÅÅ2 3
{
ÆÆ 	
try
ÇÇ 
{
ÈÈ 
return
ÉÉ 
Ok
ÉÉ 
(
ÉÉ 
new
ÉÉ 
RespuestasAPI
ÉÉ +
<
ÉÉ+ ,
List
ÉÉ, 0
<
ÉÉ0 1 
VwBusquedaFechaDto
ÉÉ1 C
>
ÉÉC D
>
ÉÉD E
{
ÊÊ 
Result
ËË 
=
ËË 
_reporteService
ËË ,
.
ËË, -$
ObtenerVwBusquedaFecha
ËË- C
(
ËËC D
)
ËËD E
}
ÌÌ 
)
ÌÌ 
;
ÌÌ 
}
ÍÍ 
catch
ÎÎ 
(
ÎÎ 
	Exception
ÎÎ 
e
ÎÎ 
)
ÎÎ 
{
ÏÏ 
return
ÐÐ 
HandleException
ÐÐ &
(
ÐÐ& '
e
ÐÐ' (
,
ÐÐ( )
nameof
ÐÐ* 0
(
ÐÐ0 1"
ObtenerBusquedaFecha
ÐÐ1 E
)
ÐÐE F
)
ÐÐF G
;
ÐÐG H
}
ÑÑ 
}
ÒÒ 	
[
ÚÚ 	
	Authorize
ÚÚ	 
]
ÚÚ 
[
ÛÛ 	
HttpGet
ÛÛ	 
(
ÛÛ 
Routes
ÛÛ 
.
ÛÛ 
BUSQUEDA_FILTRO
ÛÛ '
)
ÛÛ' (
]
ÛÛ( )
public
ÜÜ 
IActionResult
ÜÜ #
ObtenerBusquedaFiltro
ÜÜ 2
(
ÜÜ2 3
)
ÜÜ3 4
{
ÝÝ 	
try
ÞÞ 
{
ßß 
return
àà 
Ok
àà 
(
àà 
new
àà 
RespuestasAPI
àà +
<
àà+ ,
List
àà, 0
<
àà0 1!
VwBusquedaFiltroDto
àà1 D
>
ààD E
>
ààE F
{
áá 
Result
ââ 
=
ââ 
_reporteService
ââ ,
.
ââ, -%
ObtenerVwBusquedaFiltro
ââ- D
(
ââD E
)
ââE F
}
ãã 
)
ãã 
;
ãã 
}
ää 
catch
åå 
(
åå 
	Exception
åå 
e
åå 
)
åå 
{
ææ 
return
çç 
HandleException
çç &
(
çç& '
e
çç' (
,
çç( )
nameof
çç* 0
(
çç0 1#
ObtenerBusquedaFiltro
çç1 F
)
ççF G
)
ççG H
;
ççH I
}
èè 
}
éé 	
[
ññ 	
	Authorize
ññ	 
]
ññ 
[
òò 	
HttpGet
òò	 
(
òò 
Routes
òò 
.
òò  
BUSQUEDA_UBICACION
òò *
)
òò* +
]
òò+ ,
public
óó 
IActionResult
óó &
ObtenerBusquedaUbicacion
óó 5
(
óó5 6
)
óó6 7
{
ôô 	
try
õõ 
{
öö 
return
÷÷ 
Ok
÷÷ 
(
÷÷ 
new
÷÷ 
RespuestasAPI
÷÷ +
<
÷÷+ ,
List
÷÷, 0
<
÷÷0 1$
VwBusquedaUbicacionDto
÷÷1 G
>
÷÷G H
>
÷÷H I
{
øø 
Result
ùù 
=
ùù 
_reporteService
ùù ,
.
ùù, -(
ObtenerVwBusquedaUbicacion
ùù- G
(
ùùG H
)
ùùH I
}
úú 
)
úú 
;
úú 
}
ûû 
catch
üü 
(
üü 
	Exception
üü 
e
üü 
)
üü 
{
ýý 
return
þþ 
HandleException
þþ &
(
þþ& '
e
þþ' (
,
þþ( )
nameof
þþ* 0
(
þþ0 1&
ObtenerBusquedaUbicacion
þþ1 I
)
þþI J
)
þþJ K
;
þþK L
}
ÿÿ 
}
 	
[
 	
	Authorize
	 
]
 
[
 	
HttpGet
	 
(
 
Routes
 
.
 
ACTUALIZACION_ONA
 )
)
) *
]
* +
public
 
IActionResult
 %
ObtenerActualizacionONA
 4
(
4 5
)
5 6
{
 	
try
 
{
 
return
 
Ok
 
(
 
new
 
RespuestasAPI
 +
<
+ ,
List
, 0
<
0 1#
VwActualizacionONADto
1 F
>
F G
>
G H
{
 
Result
 
=
 
_reporteService
 ,
.
, -'
ObtenerVwActualizacionONA
- F
(
F G
)
G H
}
 
)
 
;
 
}
 
catch
 
(
 
	Exception
 
e
 
)
 
{
 
return
 
HandleException
 &
(
& '
e
' (
,
( )
nameof
* 0
(
0 1%
ObtenerActualizacionONA
1 H
)
H I
)
I J
;
J K
}
 
}
 	
[
 	
	Authorize
	 
]
 
[
   	
HttpGet
  	 
(
   
Routes
   
.
   "
ORGANISMO_REGISTRADO
   ,
)
  , -
]
  - .
public
¡¡ 
IActionResult
¡¡ (
ObtenerOrganismoRegistrado
¡¡ 7
(
¡¡7 8
)
¡¡8 9
{
¢¢ 	
try
££ 
{
¤¤ 
return
¥¥ 
Ok
¥¥ 
(
¥¥ 
new
¥¥ 
RespuestasAPI
¥¥ +
<
¥¥+ ,
List
¥¥, 0
<
¥¥0 1&
VwOrganismoRegistradoDto
¥¥1 I
>
¥¥I J
>
¥¥J K
{
¦¦ 
Result
§§ 
=
§§ 
_reporteService
§§ ,
.
§§, -*
ObtenerVwOrganismoRegistrado
§§- I
(
§§I J
)
§§J K
}
¨¨ 
)
¨¨ 
;
¨¨ 
}
©© 
catch
ªª 
(
ªª 
	Exception
ªª 
e
ªª 
)
ªª 
{
«« 
return
¬¬ 
HandleException
¬¬ &
(
¬¬& '
e
¬¬' (
,
¬¬( )
nameof
¬¬* 0
(
¬¬0 1(
ObtenerOrganismoRegistrado
¬¬1 K
)
¬¬K L
)
¬¬L M
;
¬¬M N
}
­­ 
}
®® 	
[
¶¶ 	
	Authorize
¶¶	 
]
¶¶ 
[
·· 	
HttpGet
··	 
(
·· 
Routes
·· 
.
·· 
ORGANISMO_ESQUEMA
·· )
)
··) *
]
··* +
public
¸¸ 
IActionResult
¸¸ (
ObtenerOrganizacionEsquema
¸¸ 7
(
¸¸7 8
)
¸¸8 9
{
¹¹ 	
try
ºº 
{
»» 
return
¼¼ 
Ok
¼¼ 
(
¼¼ 
new
¼¼ 
RespuestasAPI
¼¼ +
<
¼¼+ ,
List
¼¼, 0
<
¼¼0 1&
VwOrganizacionEsquemaDto
¼¼1 I
>
¼¼I J
>
¼¼J K
{
½½ 
Result
¾¾ 
=
¾¾ 
_reporteService
¾¾ ,
.
¾¾, -*
ObtenerVwOrganizacionEsquema
¾¾- I
(
¾¾I J
)
¾¾J K
}
¿¿ 
)
¿¿ 
;
¿¿ 
}
ÀÀ 
catch
ÁÁ 
(
ÁÁ 
	Exception
ÁÁ 
e
ÁÁ 
)
ÁÁ 
{
ÂÂ 
return
ÃÃ 
HandleException
ÃÃ &
(
ÃÃ& '
e
ÃÃ' (
,
ÃÃ( )
nameof
ÃÃ* 0
(
ÃÃ0 1(
ObtenerOrganizacionEsquema
ÃÃ1 K
)
ÃÃK L
)
ÃÃL M
;
ÃÃM N
}
ÄÄ 
}
ÅÅ 	
[
ÍÍ 	
	Authorize
ÍÍ	 
]
ÍÍ 
[
ÎÎ 	
HttpGet
ÎÎ	 
(
ÎÎ 
Routes
ÎÎ 
.
ÎÎ !
ORGANISMO_ACTIVIDAD
ÎÎ +
)
ÎÎ+ ,
]
ÎÎ, -
public
ÏÏ 
IActionResult
ÏÏ '
ObtenerOrganismoActividad
ÏÏ 6
(
ÏÏ6 7
)
ÏÏ7 8
{
ÐÐ 	
try
ÑÑ 
{
ÒÒ 
return
ÓÓ 
Ok
ÓÓ 
(
ÓÓ 
new
ÓÓ 
RespuestasAPI
ÓÓ +
<
ÓÓ+ ,
List
ÓÓ, 0
<
ÓÓ0 1%
VwOrganismoActividadDto
ÓÓ1 H
>
ÓÓH I
>
ÓÓI J
{
ÔÔ 
Result
ÕÕ 
=
ÕÕ 
_reporteService
ÕÕ ,
.
ÕÕ, -)
ObtenerVwOrganismoActividad
ÕÕ- H
(
ÕÕH I
)
ÕÕI J
}
ÖÖ 
)
ÖÖ 
;
ÖÖ 
}
×× 
catch
ØØ 
(
ØØ 
	Exception
ØØ 
e
ØØ 
)
ØØ 
{
ÙÙ 
return
ÚÚ 
HandleException
ÚÚ &
(
ÚÚ& '
e
ÚÚ' (
,
ÚÚ( )
nameof
ÚÚ* 0
(
ÚÚ0 1'
ObtenerOrganismoActividad
ÚÚ1 J
)
ÚÚJ K
)
ÚÚK L
;
ÚÚL M
}
ÛÛ 
}
ÜÜ 	
}
ÝÝ 
}ÞÞ ºc
KC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\ONAsController.cs
	namespace 	
WebApp
 
. 
Controllers 
{ 
[ 
Route 

(
 
Routes 
. 
ONA 
) 
] 
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class 
ONAsController 
:  !
BaseController" 0
{ 
private 
readonly 
IONAService $
_oNAService% 0
;0 1
private 
readonly 
IMapper  
_mapper! (
;( )
public 
ONAsController 
( 
IONAService )

oNAService* 4
,4 5
IMapper6 =
mapper> D
,D E
ILoggerF M
<M N
BaseControllerN \
>\ ]
logger^ d
)d e
:f g
baseh l
(l m
loggerm s
)s t
{ 	
this 
. 
_oNAService 
= 

oNAService )
;) *
this 
. 
_mapper 
= 
mapper !
;! "
} 	
['' 	
HttpGet''	 
]'' 
public(( 
IActionResult(( 
FindAll(( $
((($ %
)((% &
{)) 	
try** 
{++ 
return,, 
Ok,, 
(,, 
new,, 
RespuestasAPI,, +
<,,+ ,
List,,, 0
<,,0 1
OnaDto,,1 7
>,,7 8
>,,8 9
{-- 
Result.. 
=.. 
_oNAService.. (
...( )
FindAll..) 0
(..0 1
)..1 2
...2 3
Select..3 9
(..9 :
item..: >
=>..? A
_mapper..B I
...I J
Map..J M
<..M N
OnaDto..N T
>..T U
(..U V
item..V Z
)..Z [
)..[ \
...\ ]
ToList..] c
(..c d
)..d e
}// 
)// 
;// 
}00 
catch11 
(11 
	Exception11 
e11 
)11 
{22 
return33 
HandleException33 &
(33& '
e33' (
,33( )
nameof33* 0
(330 1
FindAll331 8
)338 9
)339 :
;33: ;
}44 
}55 	
[?? 	
	Authorize??	 
]?? 
[@@ 	
HttpGet@@	 
(@@ 
Routes@@ 
.@@ 
LISTA_ONA_BY_ID@@ '
)@@' (
]@@( )
publicAA 
IActionResultAA 
GetListByONAsAsyncAA /
(AA/ 0
intAA0 3
idOnaAA4 9
)AA9 :
{BB 	
tryCC 
{DD 
returnEE 
OkEE 
(EE 
newEE 
RespuestasAPIEE +
<EE+ ,
ListEE, 0
<EE0 1
OnaDtoEE1 7
>EE7 8
>EE8 9
{FF 
ResultGG 
=GG 
_oNAServiceGG (
.GG( )
GetListByONAsAsyncGG) ;
(GG; <
idOnaGG< A
)GGA B
.GGB C
SelectGGC I
(GGI J
itemGGJ N
=>GGO Q
_mapperGGR Y
.GGY Z
MapGGZ ]
<GG] ^
OnaDtoGG^ d
>GGd e
(GGe f
itemGGf j
)GGj k
)GGk l
.GGl m
ToListGGm s
(GGs t
)GGt u
}HH 
)HH 
;HH 
}II 
catchJJ 
(JJ 
	ExceptionJJ 
eJJ 
)JJ 
{KK 
returnLL 
HandleExceptionLL &
(LL& '
eLL' (
,LL( )
nameofLL* 0
(LL0 1
GetListByONAsAsyncLL1 C
)LLC D
)LLD E
;LLE F
}MM 
}NN 	
[WW 	
	AuthorizeWW	 
]WW 
[XX 	
HttpGetXX	 
(XX 
RoutesXX 
.XX 
PAISESXX 
)XX 
]XX  
publicYY 
IActionResultYY 
FindAllPaisYY (
(YY( )
)YY) *
{ZZ 	
try[[ 
{\\ 
return]] 
Ok]] 
(]] 
new]] 
RespuestasAPI]] +
<]]+ ,
List]], 0
<]]0 1
	VwPaisDto]]1 :
>]]: ;
>]]; <
{^^ 
Result__ 
=__ 
_oNAService__ (
.__( )
FindAllPaises__) 6
(__6 7
)__7 8
.__8 9
Select__9 ?
(__? @
item__@ D
=>__E G
_mapper__H O
.__O P
Map__P S
<__S T
	VwPaisDto__T ]
>__] ^
(__^ _
item___ c
)__c d
)__d e
.__e f
ToList__f l
(__l m
)__m n
}`` 
)`` 
;`` 
}aa 
catchbb 
(bb 
	Exceptionbb 
ebb 
)bb 
{cc 
returndd 
HandleExceptiondd &
(dd& '
edd' (
,dd( )
nameofdd* 0
(dd0 1
FindAllPaisdd1 <
)dd< =
)dd= >
;dd> ?
}ee 
}ff 	
[pp 	
AllowAnonymouspp	 
]pp 
[qq 	
HttpGetqq	 
(qq 
$strqq 
)qq 
]qq 
publicrr 
IActionResultrr 
FindByIdrr %
(rr% &
intrr& )
idrr* ,
)rr, -
{ss 	
trytt 
{uu 
varvv 
recordvv 
=vv 
_oNAServicevv (
.vv( )
FindByIdvv) 1
(vv1 2
idvv2 4
)vv4 5
;vv5 6
ifxx 
(xx 
recordxx 
==xx 
nullxx "
)xx" #
{yy 
returnzz 
NotFoundResponsezz +
(zz+ ,

Constanteszz, 6
.zz6 7)
MESAGGE_REGISTRO_NO_ENCOTRADOzz7 T
)zzT U
;zzU V
}{{ 
return}} 
Ok}} 
(}} 
new}} 
RespuestasAPI}} +
<}}+ ,
OnaDto}}, 2
>}}2 3
{~~ 
Result 
= 
_mapper $
.$ %
Map% (
<( )
OnaDto) /
>/ 0
(0 1
record1 7
)7 8
}
 
)
 
;
 
}
 
catch
 
(
 
	Exception
 
e
 
)
 
{
 
return
 
HandleException
 &
(
& '
e
' (
,
( )
nameof
* 0
(
0 1
FindById
1 9
)
9 :
)
: ;
;
; <
}
 
}
 	
[
 	
	Authorize
	 
]
 
[
 	
HttpPut
	 
(
 
$str
 
)
 
]
 
public
 
IActionResult
 
Update
 #
(
# $
int
$ '
id
( *
,
* +
[
, -
FromBody
- 5
]
5 6
OnaDto
7 =
dto
> A
)
A B
{
 	
try
 
{
 
dto
 
.
 
IdONA
 
=
 
id
 
;
 
var
 
homologacion
  
=
! "
_mapper
# *
.
* +
Map
+ .
<
. /
ONA
/ 2
>
2 3
(
3 4
dto
4 7
)
7 8
;
8 9
return
 
Ok
 
(
 
new
 
RespuestasAPI
 +
<
+ ,
bool
, 0
>
0 1
{
 
	IsSuccess
 
=
 
_oNAService
  +
.
+ ,
Update
, 2
(
2 3
homologacion
3 ?
)
? @
}
 
)
 
;
 
}
 
catch
 
(
 
	Exception
 
e
 
)
 
{
 
return
   
HandleException
   &
(
  & '
e
  ' (
,
  ( )
nameof
  * 0
(
  0 1
Update
  1 7
)
  7 8
)
  8 9
;
  9 :
}
¡¡ 
}
¢¢ 	
[
«« 	
	Authorize
««	 
]
«« 
[
¬¬ 	
HttpPost
¬¬	 
]
¬¬ 
public
­­ 
IActionResult
­­ 
Create
­­ #
(
­­# $
[
­­$ %
FromBody
­­% -
]
­­- .
OnaDto
­­/ 5
dto
­­6 9
)
­­9 :
{
®® 	
try
¯¯ 
{
°° 
var
±± 
record
±± 
=
±± 
_mapper
±± $
.
±±$ %
Map
±±% (
<
±±( )
ONA
±±) ,
>
±±, -
(
±±- .
dto
±±. 1
)
±±1 2
;
±±2 3
return
³³ 
Ok
³³ 
(
³³ 
new
³³ 
RespuestasAPI
³³ +
<
³³+ ,
bool
³³, 0
>
³³0 1
{
´´ 
	IsSuccess
µµ 
=
µµ 
_oNAService
µµ  +
.
µµ+ ,
Create
µµ, 2
(
µµ2 3
record
µµ3 9
)
µµ9 :
}
¶¶ 
)
¶¶ 
;
¶¶ 
}
·· 
catch
¸¸ 
(
¸¸ 
	Exception
¸¸ 
e
¸¸ 
)
¸¸ 
{
¹¹ 
return
ºº 
HandleException
ºº &
(
ºº& '
e
ºº' (
,
ºº( )
nameof
ºº* 0
(
ºº0 1
Create
ºº1 7
)
ºº7 8
)
ºº8 9
;
ºº9 :
}
»» 
}
¼¼ 	
[
ÅÅ 	
	Authorize
ÅÅ	 
]
ÅÅ 
[
ÆÆ 	

HttpDelete
ÆÆ	 
(
ÆÆ 
$str
ÆÆ 
)
ÆÆ 
]
ÆÆ  
public
ÇÇ 
IActionResult
ÇÇ 
Deactive
ÇÇ %
(
ÇÇ% &
int
ÇÇ& )
id
ÇÇ* ,
)
ÇÇ, -
{
ÈÈ 	
try
ÉÉ 
{
ÊÊ 
var
ËË 
record
ËË 
=
ËË 
_oNAService
ËË (
.
ËË( )
FindById
ËË) 1
(
ËË1 2
id
ËË2 4
)
ËË4 5
;
ËË5 6
if
ÍÍ 
(
ÍÍ 
record
ÍÍ 
==
ÍÍ 
null
ÍÍ "
)
ÍÍ" #
{
ÎÎ 
return
ÏÏ 
NotFoundResponse
ÏÏ +
(
ÏÏ+ ,

Constantes
ÏÏ, 6
.
ÏÏ6 7+
MESAGGE_REGISTRO_NO_ENCOTRADO
ÏÏ7 T
)
ÏÏT U
;
ÏÏU V
}
ÐÐ 
record
ÒÒ 
.
ÒÒ 
Estado
ÒÒ 
=
ÒÒ 

Constantes
ÒÒ  *
.
ÒÒ* +
ESTADO_USUARIO_X
ÒÒ+ ;
;
ÒÒ; <
return
ÔÔ 
Ok
ÔÔ 
(
ÔÔ 
new
ÔÔ 
RespuestasAPI
ÔÔ +
<
ÔÔ+ ,
bool
ÔÔ, 0
>
ÔÔ0 1
{
ÕÕ 
	IsSuccess
ÖÖ 
=
ÖÖ 
_oNAService
ÖÖ  +
.
ÖÖ+ ,
Update
ÖÖ, 2
(
ÖÖ2 3
record
ÖÖ3 9
)
ÖÖ9 :
}
×× 
)
×× 
;
×× 
}
ØØ 
catch
ÙÙ 
(
ÙÙ 
	Exception
ÙÙ 
e
ÙÙ 
)
ÙÙ 
{
ÚÚ 
return
ÛÛ 
HandleException
ÛÛ &
(
ÛÛ& '
e
ÛÛ' (
,
ÛÛ( )
nameof
ÛÛ* 0
(
ÛÛ0 1
Deactive
ÛÛ1 9
)
ÛÛ9 :
)
ÛÛ: ;
;
ÛÛ; <
}
ÜÜ 
}
ÝÝ 	
}
ßß 
}àà ò
QC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\OnaMigrateController.cs
	namespace 	
WebApp
 
. 
Controllers 
{ 
[ 
Route 

(
 
Routes 
. 
ONAC 
) 
] 
[		 
ApiController		 
]		 
[

  
ProducesResponseType

 
(

 
StatusCodes

 %
.

% &
Status200OK

& 1
)

1 2
]

2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class  
OnaMigrateController %
:& '
BaseController( 6
{ 
private 
readonly 
IOnaMigrate $
_ionaMigrate% 1
;1 2
public  
OnaMigrateController #
(# $
IOnaMigrate$ /
IonaMigrate0 ;
,; <
ILogger 
< 
BaseController #
># $
logger% +
)+ ,
:- .
base/ 3
(3 4
logger4 :
): ;
{ 	
_ionaMigrate 
= 
IonaMigrate &
;& '
} 	
[ 	
HttpPost	 
( 
Routes 
. 
POST_ONA_MIGRATE )
)) *
]* +
public   
async   
Task   
<   
IActionResult   '
>  ' (
postOnaMigrate  ) 7
(  7 8
[  8 9
FromBody  9 A
]  A B 
OnaMigrateRequestDto  C W
request  X _
)  _ `
{!! 	
try"" 
{## 
return$$ 
Ok$$ 
($$ 
new$$ 
RespuestasAPI$$ +
<$$+ ,
List$$, 0
<$$0 1
OnaMigrateDto$$1 >
>$$> ?
>$$? @
{%% 
Result&& 
=&& 
(&& 
await&& #
_ionaMigrate&&$ 0
.&&0 1
postOnaMigrate&&1 ?
(&&? @
request&&@ G
.&&G H
vista&&H M
,&&M N
request&&O V
.&&V W
IdOna&&W \
,&&\ ]
request&&^ e
.&&e f
	IdEsquema&&f o
)&&o p
)&&p q
.&&q r
ToList&&r x
(&&x y
)&&y z
}'' 
)'' 
;'' 
})) 
catch** 
(** 
	Exception** 
e** 
)** 
{++ 
return,, 
HandleException,, &
(,,& '
e,,' (
,,,( )
nameof,,* 0
(,,0 1
postOnaMigrate,,1 ?
),,? @
),,@ A
;,,A B
}-- 
}.. 	
}00 
}11 ÃM
RC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\ONAConexionController.cs
	namespace

 	
WebApp


 
.

 
Controllers

 
{ 
[ 
Route 

(
 
Routes 
. 
CONEXION 
) 
] 
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class !
ONAConexionController &
:' (
BaseController) 7
{ 
private 
readonly 
IONAConexionService ,
_oNAConexionService- @
;@ A
public !
ONAConexionController $
($ %
IONAConexionService% 8
oNAConexionService9 K
,K L
ILoggerM T
<T U!
ONAConexionControllerU j
>j k
loggerl r
)r s
:t u
basev z
(z {
logger	{ 
)
 
{ 	
this 
. 
_oNAConexionService $
=% &
oNAConexionService' 9
;9 :
} 	
[## 	
	Authorize##	 
]## 
[$$ 	
HttpGet$$	 
]$$ 
public%% 
IActionResult%% 
FindAll%% $
(%%$ %
)%%% &
{&& 	
try'' 
{(( 
return)) 
Ok)) 
()) 
new)) 
RespuestasAPI)) +
<))+ ,
List)), 0
<))0 1
ONAConexionDto))1 ?
>))? @
>))@ A
{** 
Result++ 
=++ 
_oNAConexionService++ 0
.++0 1
FindAll++1 8
(++8 9
)++9 :
},, 
),, 
;,, 
}-- 
catch.. 
(.. 
	Exception.. 
e.. 
).. 
{// 
return00 
HandleException00 &
(00& '
e00' (
,00( )
nameof00* 0
(000 1
FindAll001 8
)008 9
)009 :
;00: ;
}11 
}22 	
[<< 	
	Authorize<<	 
]<< 
[== 	
HttpGet==	 
(== 
Routes== 
.== 
	LISTA_ONA== !
)==! "
]==" #
public>> 
IActionResult>> (
GetOnaConexionByOnaListAsync>> 9
(>>9 :
int>>: =
idOna>>> C
)>>C D
{?? 	
try@@ 
{AA 
returnBB 
OkBB 
(BB 
newBB 
RespuestasAPIBB +
<BB+ ,
ListBB, 0
<BB0 1
ONAConexionDtoBB1 ?
>BB? @
>BB@ A
{CC 
ResultDD 
=DD 
_oNAConexionServiceDD 0
.DD0 1(
GetONAConexionByOnaListAsyncDD1 M
(DDM N
idOnaDDN S
)DDS T
}EE 
)EE 
;EE 
}FF 
catchGG 
(GG 
	ExceptionGG 
eGG 
)GG 
{HH 
returnII 
HandleExceptionII &
(II& '
eII' (
,II( )
nameofII* 0
(II0 1(
GetOnaConexionByOnaListAsyncII1 M
)IIM N
)IIN O
;IIO P
}JJ 
}KK 	
[UU 	
	AuthorizeUU	 
]UU 
[VV 	
HttpGetVV	 
(VV 
$strVV 
)VV 
]VV 
publicWW 
IActionResultWW 
FindByIdWW %
(WW% &
intWW& )
idWW* ,
)WW, -
{XX 	
tryYY 
{ZZ 
var[[ 
record[[ 
=[[ 
_oNAConexionService[[ 0
.[[0 1
FindById[[1 9
([[9 :
id[[: <
)[[< =
;[[= >
if]] 
(]] 
record]] 
==]] 
null]] "
)]]" #
{^^ 
return__ 
NotFoundResponse__ +
(__+ ,

Constantes__, 6
.__6 7)
MESAGGE_REGISTRO_NO_ENCOTRADO__7 T
)__T U
;__U V
}`` 
returnbb 
Okbb 
(bb 
newbb 
RespuestasAPIbb +
<bb+ ,
ONAConexionDtobb, :
>bb: ;
{cc 
Resultdd 
=dd 
recorddd #
}ee 
)ee 
;ee 
}ff 
catchgg 
(gg 
	Exceptiongg 
egg 
)gg 
{hh 
returnii 
HandleExceptionii &
(ii& '
eii' (
,ii( )
nameofii* 0
(ii0 1
FindByIdii1 9
)ii9 :
)ii: ;
;ii; <
}jj 
}kk 	
[uu 	
	Authorizeuu	 
]uu 
[vv 	
HttpPutvv	 
(vv 
$strvv 
)vv 
]vv 
publicww 
IActionResultww 
Updateww #
(ww# $
intww$ '
idww( *
,ww* +
[ww, -
FromBodyww- 5
]ww5 6
ONAConexionDtoww7 E
dtowwF I
)wwI J
{xx 	
tryyy 
{zz 
dto{{ 
.{{ 
IdONA{{ 
={{ 
id{{ 
;{{ 
return|| 
Ok|| 
(|| 
new|| 
RespuestasAPI|| +
<||+ ,
bool||, 0
>||0 1
{}} 
	IsSuccess~~ 
=~~ 
_oNAConexionService~~  3
.~~3 4
Update~~4 :
(~~: ;
dto~~; >
)~~> ?
} 
) 
; 
}
 
catch
 
(
 
	Exception
 
e
 
)
 
{
 
return
 
HandleException
 &
(
& '
e
' (
,
( )
nameof
* 0
(
0 1
Update
1 7
)
7 8
)
8 9
;
9 :
}
 
}
 	
[
 	
	Authorize
	 
]
 
[
 	
HttpPost
	 
]
 
public
 
IActionResult
 
Create
 #
(
# $
[
$ %
FromBody
% -
]
- .
ONAConexionDto
/ =
dto
> A
)
A B
{
 	
try
 
{
 
return
 
Ok
 
(
 
new
 
RespuestasAPI
 +
<
+ ,
bool
, 0
>
0 1
{
 
	IsSuccess
 
=
 !
_oNAConexionService
  3
.
3 4
Create
4 :
(
: ;
dto
; >
)
> ?
}
 
)
 
;
 
}
 
catch
 
(
 
	Exception
 
e
 
)
 
{
 
return
 
HandleException
 &
(
& '
e
' (
,
( )
nameof
* 0
(
0 1
Create
1 7
)
7 8
)
8 9
;
9 :
}
 
}
 	
[
¦¦ 	
	Authorize
¦¦	 
]
¦¦ 
[
§§ 	

HttpDelete
§§	 
(
§§ 
$str
§§ 
)
§§ 
]
§§  
public
¨¨ 
IActionResult
¨¨ 
Deactive
¨¨ %
(
¨¨% &
int
¨¨& )
id
¨¨* ,
)
¨¨, -
{
©© 	
try
ªª 
{
«« 
var
¬¬ 
record
¬¬ 
=
¬¬ !
_oNAConexionService
¬¬ 0
.
¬¬0 1
FindById
¬¬1 9
(
¬¬9 :
id
¬¬: <
)
¬¬< =
;
¬¬= >
if
®® 
(
®® 
record
®® 
==
®® 
null
®® "
)
®®" #
{
¯¯ 
return
°° 
NotFoundResponse
°° +
(
°°+ ,

Constantes
°°, 6
.
°°6 7+
MESAGGE_REGISTRO_NO_ENCOTRADO
°°7 T
)
°°T U
;
°°U V
}
±± 
record
³³ 
.
³³ 
Estado
³³ 
=
³³ 

Constantes
³³  *
.
³³* +
ESTADO_USUARIO_X
³³+ ;
;
³³; <
return
µµ 
Ok
µµ 
(
µµ 
new
µµ 
RespuestasAPI
µµ +
<
µµ+ ,
bool
µµ, 0
>
µµ0 1
{
¶¶ 
	IsSuccess
·· 
=
·· !
_oNAConexionService
··  3
.
··3 4
Update
··4 :
(
··: ;
record
··; A
)
··A B
}
¸¸ 
)
¸¸ 
;
¸¸ 
}
¹¹ 
catch
ºº 
(
ºº 
	Exception
ºº 
e
ºº 
)
ºº 
{
»» 
return
¼¼ 
HandleException
¼¼ &
(
¼¼& '
e
¼¼' (
,
¼¼( )
nameof
¼¼* 0
(
¼¼0 1
Deactive
¼¼1 9
)
¼¼9 :
)
¼¼: ;
;
¼¼; <
}
½½ 
}
¾¾ 	
}
ÁÁ 
}ÂÂ ÙC
UC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\MigracionExcelController.cs
	namespace 	
WebApp
 
. 
Controllers 
{ 
[ 
Route 
( 	
Routes	 
. 
MIGRACION_EXCEL 
)  
]  !
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes #
.# $
Status200OK$ /
)/ 0
]0 1
[  
ProducesResponseType 
( 
StatusCodes #
.# $
Status400BadRequest$ 7
)7 8
]8 9
[  
ProducesResponseType 
( 
StatusCodes #
.# $
Status403Forbidden$ 6
)6 7
]7 8
[  
ProducesResponseType 
( 
StatusCodes #
.# $!
Status401Unauthorized$ 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes #
.# $(
Status500InternalServerError$ @
)@ A
]A B
public 
class	 #
MigacionExcelController &
:& '
BaseController( 6
{ 
private 
readonly "
IMigracionExcelService /"
_migracionExcelService0 F
;F G
private 
readonly 
IMapper  
_mapper! (
;( )
private 
readonly 
IExcelService &
	_importer' 0
;0 1
public #
MigacionExcelController &
(& '"
IMigracionExcelService &!
migracionExcelService' <
,< =
IMapper 
mapper 
, 
IExcelService 
importer &
,& '
ILogger 
< 
BaseController &
>& '
logger( .
)   
:   
base   
(   
logger   
)   
{!! 	
this"" 
."" "
_migracionExcelService"" '
=""( )!
migracionExcelService""* ?
;""? @
this## 
.## 
_mapper## 
=## 
mapper## !
;##! "
this$$ 
.$$ 
	_importer$$ 
=$$ 
importer$$ %
;$$% &
}%% 	
[.. 	
	Authorize..	 
].. 
[// 	
HttpGet//	 
]// 
public00 
IActionResult00 
FindAll00 $
(00$ %
)00% &
{11 	
try22 
{33 
return44 
Ok44 
(44 
new44 
RespuestasAPI44 +
<44+ ,
List44, 0
<440 1
MigracionExcelDto441 B
>44B C
>44C D
{55 
Result66 
=66 "
_migracionExcelService66 3
.663 4
FindAll664 ;
(66; <
)66< =
.66= >
Select66> D
(66D E
item66E I
=>66J L
_mapper66M T
.66T U
Map66U X
<66X Y
MigracionExcelDto66Y j
>66j k
(66k l
item66l p
)66p q
)66q r
.66r s
ToList66s y
(66y z
)66z {
}77 
)77 
;77 
}88 
catch99 
(99 
	Exception99 
e99 
)99 
{:: 
return;; 
HandleException;; &
(;;& '
e;;' (
,;;( )
nameof;;* 0
(;;0 1
FindAll;;1 8
);;8 9
);;9 :
;;;: ;
}<< 
}== 	
[HH 	
	AuthorizeHH	 
]HH 
[II 	
HttpPostII	 
(II 
RoutesII 
.II 
MIGRACION_UPLOADII )
)II) *
]II* +
publicJJ 
IActionResultJJ 
ImportarExcelJJ *
(JJ* +
	IFormFileJJ+ 4
fileJJ5 9
,JJ9 :
[JJ; <
	FromQueryJJ< E
]JJE F
intJJG J
idOnaJJK P
)JJP Q
{KK 	
tryLL 
{MM 
ifNN 
(NN 
fileNN 
==NN 
nullNN  
||NN! #
fileNN$ (
.NN( )
LengthNN) /
==NN0 2
$numNN3 4
)NN4 5
{OO 
returnPP 
BadRequestResponsePP -
(PP- .
$strPP. E
)PPE F
;PPF G
}QQ 
ifRR 
(RR 
idOnaRR 
<=RR 
$numRR 
)RR 
{SS 
returnTT 
BadRequestResponseTT -
(TT- .
$strTT. B
)TTB C
;TTC D
}UU 
stringWW 
fileExtensionWW $
=WW% &
PathWW' +
.WW+ ,
GetExtensionWW, 8
(WW8 9
fileWW9 =
.WW= >
FileNameWW> F
)WWF G
;WWG H
ifXX 
(XX 
fileExtensionXX !
!=XX" $
$strXX% +
&&XX, .
fileExtensionXX/ <
!=XX= ?
$strXX@ G
)XXG H
{YY 
returnZZ 
BadRequestResponseZZ -
(ZZ- .
$strZZ. A
)ZZA B
;ZZB C
}[[ 
string^^ 
wwwrootPath^^ "
=^^# $
Path^^% )
.^^) *
Combine^^* 1
(^^1 2
	Directory^^2 ;
.^^; <
GetCurrentDirectory^^< O
(^^O P
)^^P Q
,^^Q R
$str^^S \
)^^\ ]
;^^] ^
string__ 
	filesPath__  
=__! "
Path__# '
.__' (
Combine__( /
(__/ 0
wwwrootPath__0 ;
,__; <
$str__= D
)__D E
;__E F
ifbb 
(bb 
!bb 
	Directorybb 
.bb 
Existsbb %
(bb% &
	filesPathbb& /
)bb/ 0
)bb0 1
{cc 
	Directorydd 
.dd 
CreateDirectorydd -
(dd- .
	filesPathdd. 7
)dd7 8
;dd8 9
}ee 
stringhh 
filePathhh 
=hh  !
Pathhh" &
.hh& '
Combinehh' .
(hh. /
	filesPathhh/ 8
,hh8 9
filehh: >
.hh> ?
FileNamehh? G
)hhG H
;hhH I
usingkk 
(kk 
varkk 
streamkk !
=kk" #
newkk$ '

FileStreamkk( 2
(kk2 3
filePathkk3 ;
,kk; <
FileModekk= E
.kkE F
CreatekkF L
)kkL M
)kkM N
{ll 
filemm 
.mm 
CopyTomm 
(mm  
streammm  &
)mm& '
;mm' (
}nn 
LogMigracionqq 
	migracionqq &
=qq' ("
_migracionExcelServiceqq) ?
.qq? @
Createqq@ F
(qqF G
newqqG J
LogMigracionqqK W
{rr 
Estadoss 
=ss 

Constantesss '
.ss' ("
ESTADO_USUARIO_PENDINGss( >
,ss> ?
ExcelFileNamett !
=tt" #
filett$ (
.tt( )
FileNamett) 1
}uu 
)uu 
;uu 
	_importerww 
.ww 
ImportarExcelww '
(ww' (
filePathww( 0
,ww0 1
	migracionww2 ;
,ww; <
idOnaww= B
)wwB C
;wwC D
returnyy 
Okyy 
(yy 
newyy 
RespuestasAPIyy +
<yy+ ,
boolyy, 0
>yy0 1
{zz 
	IsSuccess{{ 
={{ 
true{{  $
}|| 
)|| 
;|| 
}}} 
catch~~ 
(~~ 
	Exception~~ 
ex~~ 
)~~  
{ 
return
 

StatusCode
 !
(
! "
$num
" %
,
% &
new
' *
{
 

statusCode
 
=
  
$num
! $
,
$ %
	isSuccess
 
=
 
false
  %
,
% &
errorMessages
 !
=
" #
new
$ '
[
' (
]
( )
{
* +
ex
, .
.
. /
Message
/ 6
}
7 8
}
 
)
 
;
 
}
 
}
 	
}
 
} ÒN
KC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\MenuController.cs
	namespace

 	
WebApp


 
.

 
Controllers

 
{ 
[ 
Route 

(
 
Routes 
. 
MENU 
) 
] 
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class 
MenuController 
:  !
BaseController" 0
{ 
private 
readonly 
IMenuService %
_menuService& 2
;2 3
public 
MenuController 
( 
IMenuService *
menuService+ 6
,6 7
ILogger8 ?
<? @
MenuController@ N
>N O
loggerP V
)V W
:X Y
baseZ ^
(^ _
logger_ e
)e f
{ 	
this 
. 
_menuService 
= 
menuService  +
;+ ,
} 	
["" 	
HttpGet""	 
]"" 
public## 
IActionResult## 
FindAll## $
(##$ %
)##% &
{$$ 	
try%% 
{&& 
return'' 
Ok'' 
('' 
new'' 
RespuestasAPI'' +
<''+ ,
List'', 0
<''0 1

MenuRolDto''1 ;
>''; <
>''< =
{(( 
Result)) 
=)) 
_menuService)) )
.))) *
FindAll))* 1
())1 2
)))2 3
}** 
)** 
;** 
}++ 
catch,, 
(,, 
	Exception,, 
e,, 
),, 
{-- 
return.. 
HandleException.. &
(..& '
e..' (
,..( )
nameof..* 0
(..0 1
FindAll..1 8
)..8 9
)..9 :
;..: ;
}// 
}00 	
[;; 	
HttpGet;;	 
(;; 
$str;; -
);;- .
];;. /
public<< 
IActionResult<< 
FindById<< %
(<<% &
int<<& )
idHRol<<* 0
,<<0 1
int<<2 5
idHMenu<<6 =
)<<= >
{== 	
try>> 
{?? 
var@@ 
record@@ 
=@@ 
_menuService@@ )
.@@) *
FindDataById@@* 6
(@@6 7
idHRol@@7 =
,@@= >
idHMenu@@? F
)@@F G
;@@G H
ifAA 
(AA 
recordAA 
==AA 
nullAA "
)AA" #
{BB 
returnCC 
NotFoundResponseCC +
(CC+ ,

ConstantesCC, 6
.CC6 7)
MESAGGE_REGISTRO_NO_ENCOTRADOCC7 T
)CCT U
;CCU V
}DD 
returnEE 
OkEE 
(EE 
newEE 
RespuestasAPIEE +
<EE+ ,

MenuRolDtoEE, 6
>EE6 7
{FF 
ResultGG 
=GG 
recordGG #
}HH 
)HH 
;HH 
}II 
catchJJ 
(JJ 
	ExceptionJJ 
eJJ 
)JJ 
{KK 
returnLL 
HandleExceptionLL &
(LL& '
eLL' (
,LL( )
nameofLL* 0
(LL0 1
FindByIdLL1 9
)LL9 :
)LL: ;
;LL; <
}MM 
}NN 	
[YY 	
	AuthorizeYY	 
]YY 
[ZZ 	
HttpPutZZ	 
(ZZ 
$strZZ -
)ZZ- .
]ZZ. /
public[[ 
IActionResult[[ 
Update[[ #
([[# $
int[[$ '
idHRol[[( .
,[[. /
int[[0 3
idHMenu[[4 ;
,[[; <
[[[= >
FromBody[[> F
][[F G

MenuRolDto[[H R
dto[[S V
)[[V W
{\\ 	
try]] 
{^^ 
return__ 
Ok__ 
(__ 
new__ 
RespuestasAPI__ +
<__+ ,
bool__, 0
>__0 1
{`` 
	IsSuccessaa 
=aa 
_menuServiceaa  ,
.aa, -
Updateaa- 3
(aa3 4
dtoaa4 7
)aa7 8
}bb 
)bb 
;bb 
}cc 
catchdd 
(dd 
	Exceptiondd 
edd 
)dd 
{ee 
returnff 
HandleExceptionff &
(ff& '
eff' (
,ff( )
nameofff* 0
(ff0 1
Updateff1 7
)ff7 8
)ff8 9
;ff9 :
}gg 
}hh 	
[qq 	
	Authorizeqq	 
]qq 
[rr 	
HttpPostrr	 
]rr 
publicss 
IActionResultss 
Createss #
(ss# $
[ss$ %
FromBodyss% -
]ss- .

MenuRolDtoss/ 9
dtoss: =
)ss= >
{tt 	
tryuu 
{vv 
returnww 
Okww 
(ww 
newww 
RespuestasAPIww +
<ww+ ,
boolww, 0
>ww0 1
{xx 
	IsSuccessyy 
=yy 
_menuServiceyy  ,
.yy, -
Createyy- 3
(yy3 4
dtoyy4 7
)yy7 8
}zz 
)zz 
;zz 
}{{ 
catch|| 
(|| 
	Exception|| 
e|| 
)|| 
{}} 
return~~ 
HandleException~~ &
(~~& '
e~~' (
,~~( )
nameof~~* 0
(~~0 1
Create~~1 7
)~~7 8
)~~8 9
;~~9 :
} 
}
 	
[
 	
	Authorize
	 
]
 
[
 	

HttpDelete
	 
(
 
$str
 0
)
0 1
]
1 2
public
 
IActionResult
 
Deactive
 %
(
% &
int
& )
idHRol
* 0
,
0 1
int
2 5
idHMenu
6 =
)
= >
{
 	
try
 
{
 
var
 
record
 
=
 
_menuService
 )
.
) *
FindById
* 2
(
2 3
idHRol
3 9
,
9 :
idHMenu
; B
)
B C
;
C D
record
 
.
 
Estado
 
=
 
record
  &
.
& '
Estado
' -
==
. 0

Constantes
1 ;
.
; <
ESTADO_USUARIO_A
< L
?
M N

Constantes
O Y
.
Y Z
ESTADO_USUARIO_X
Z j
:
k l

Constantes
m w
.
w x
ESTADO_USUARIO_Ax 
; 
if
 
(
 
record
 
==
 
null
 "
)
" #
{
 
return
 
NotFoundResponse
 +
(
+ ,

Constantes
, 6
.
6 7+
MESAGGE_REGISTRO_NO_ENCOTRADO
7 T
)
T U
;
U V
}
 
return
 
Ok
 
(
 
new
 
RespuestasAPI
 +
<
+ ,
bool
, 0
>
0 1
{
 
	IsSuccess
 
=
 
_menuService
  ,
.
, -
Update
- 3
(
3 4
record
4 :
)
: ;
}
 
)
 
;
 
}
 
catch
 
(
 
	Exception
 
e
 
)
 
{
 
return
 
HandleException
 &
(
& '
e
' (
,
( )
nameof
* 0
(
0 1
Deactive
1 9
)
9 :
)
: ;
;
; <
}
 
}
 	
[
¨¨ 	
HttpGet
¨¨	 
(
¨¨ 
$str
¨¨ *
,
¨¨* +
Name
¨¨, 0
=
¨¨1 2
$str
¨¨3 :
)
¨¨: ;
]
¨¨; <
public
©© 
IActionResult
©© '
ObtenerMenusPendingConfig
©© 6
(
©©6 7
int
©©7 :
idHomologacionRol
©©; L
)
©©L M
{
ªª 	
try
«« 
{
¬¬ 
return
­­ 
Ok
­­ 
(
­­ 
new
­­ 
RespuestasAPI
­­ +
<
­­+ ,
List
­­, 0
<
­­0 1
MenuPaginaDto
­­1 >
>
­­> ?
>
­­? @
{
®® 
Result
¯¯ 
=
¯¯ 
_menuService
¯¯ )
.
¯¯) *'
ObtenerMenusPendingConfig
¯¯* C
(
¯¯C D
idHomologacionRol
¯¯D U
)
¯¯U V
}
°° 
)
°° 
;
°° 
}
±± 
catch
²² 
(
²² 
	Exception
²² 
e
²² 
)
²² 
{
³³ 
return
´´ 
HandleException
´´ &
(
´´& '
e
´´' (
,
´´( )
nameof
´´* 0
(
´´0 1'
ObtenerMenusPendingConfig
´´1 J
)
´´J K
)
´´K L
;
´´L M
}
µµ 
}
¶¶ 	
}
·· 
}¸¸ ÿ
SC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\LogMigracionController.cs
	namespace

 	
WebApp


 
.

 
Controllers

 
{ 
[ 
Route 

(
 
Routes 
. 
LOG_MIGRACION 
)  
]  !
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class "
LogMigracionController '
:( )
BaseController* 8
{ 
private 
readonly  
ILogMigracionService - 
_logMigracionService. B
;B C
private 
readonly 
IMapper  
_mapper! (
;( )
public "
LogMigracionController %
(% & 
ILogMigracionService& :
logMigracionService; N
,N O
IMapper 
mapper 
, 
ILogger 
< 
BaseController "
>" #
logger$ *
)* +
: 
base 
( 
logger 
) 
{ 	
this 
.  
_logMigracionService %
=& '
logMigracionService( ;
;; <
this 
. 
_mapper 
= 
mapper !
;! "
} 	
[(( 	
	Authorize((	 
](( 
[)) 	
HttpGet))	 
])) 
public** 
IActionResult** 
FindAll** $
(**$ %
)**% &
{++ 	
try,, 
{-- 
return.. 
Ok.. 
(.. 
new.. 
RespuestasAPI.. +
<..+ ,
List.., 0
<..0 1
LogMigracionDto..1 @
>..@ A
>..A B
{// 
Result00 
=00  
_logMigracionService00 1
.001 2
FindAll002 9
(009 :
)00: ;
.00; <
Select00< B
(00B C
item00C G
=>00H J
_mapper00K R
.00R S
Map00S V
<00V W
LogMigracionDto00W f
>00f g
(00g h
item00h l
)00l m
)00m n
.00n o
ToList00o u
(00u v
)00v w
}11 
)11 
;11 
}22 
catch33 
(33 
	Exception33 
e33 
)33 
{44 
return55 
HandleException55 &
(55& '
e55' (
,55( )
nameof55* 0
(550 1
FindAll551 8
)558 9
)559 :
;55: ;
}66 
}77 	
}88 
}99 ºY
SC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\HomologacionController.cs
	namespace 	
WebApp
 
. 
Controllers 
{ 
[ 
Route 

(
 
Routes 
. 
HOMOLOGACION 
) 
]  
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class "
HomologacionController '
:( )
BaseController* 8
{ 
private 
readonly  
IHomologacionService -!
_iHomologacionService. C
;C D
public "
HomologacionController %
(% & 
IHomologacionService& : 
iHomologacionService; O
,O P
ILoggerQ X
<X Y"
HomologacionControllerY o
>o p
loggerq w
)w x
:y z
base{ 
(	 
logger
 
)
 
{ 	
this 
. !
_iHomologacionService &
=' ( 
iHomologacionService) =
;= >
} 	
[## 	
HttpGet##	 
(## 
Routes## 
.## 
FIND_BY_PARENT## &
)##& '
]##' (
public$$ 
IActionResult$$ 
FindByParent$$ )
($$) *
)$$* +
{%% 	
try&& 
{'' 
return(( 
Ok(( 
((( 
new(( 
RespuestasAPI(( +
<((+ ,
List((, 0
<((0 1
HomologacionDto((1 @
>((@ A
>((A B
{)) 
Result** 
=** !
_iHomologacionService** 2
.**2 3
FindByParent**3 ?
(**? @
)**@ A
}++ 
)++ 
;++ 
},, 
catch-- 
(-- 
	Exception-- 
e-- 
)-- 
{.. 
return// 
HandleException// &
(//& '
e//' (
,//( )
nameof//* 0
(//0 1
FindByParent//1 =
)//= >
)//> ?
;//? @
}00 
}11 	
[;; 	
	Authorize;;	 
];; 
[<< 	
HttpGet<<	 
(<< 
$str<< 
)<< 
]<< 
public== 
IActionResult== 
FindById== %
(==% &
int==& )
id==* ,
)==, -
{>> 	
try?? 
{@@ 
varAA 
recordAA 
=AA !
_iHomologacionServiceAA 2
.AA2 3
FindByIdAA3 ;
(AA; <
idAA< >
)AA> ?
;AA? @
ifCC 
(CC 
recordCC 
==CC 
nullCC "
)CC" #
{DD 
returnEE 
NotFoundResponseEE +
(EE+ ,

ConstantesEE, 6
.EE6 7)
MESAGGE_REGISTRO_NO_ENCOTRADOEE7 T
)EET U
;EEU V
}FF 
returnHH 
OkHH 
(HH 
newHH 
RespuestasAPIHH +
<HH+ ,
HomologacionDtoHH, ;
>HH; <
{II 
ResultJJ 
=JJ 
recordJJ #
}KK 
)KK 
;KK 
}LL 
catchMM 
(MM 
	ExceptionMM 
eMM 
)MM 
{NN 
returnOO 
HandleExceptionOO &
(OO& '
eOO' (
,OO( )
nameofOO* 0
(OO0 1
FindByIdOO1 9
)OO9 :
)OO: ;
;OO; <
}PP 
}QQ 	
[[[ 	
	Authorize[[	 
][[ 
[\\ 	
HttpPut\\	 
(\\ 
$str\\ 
)\\ 
]\\ 
public]] 
IActionResult]] 
Update]] #
(]]# $
int]]$ '
id]]( *
,]]* +
[]], -
FromBody]]- 5
]]]5 6
HomologacionDto]]7 F
dto]]G J
)]]J K
{^^ 	
try__ 
{`` 
dtoaa 
.aa 
IdHomologacionaa "
=aa# $
idaa% '
;aa' (
dtobb 
.bb 
Estadobb 
=bb 

Constantesbb '
.bb' (
ESTADO_USUARIO_Abb( 8
;bb8 9
returndd 
Okdd 
(dd 
newdd 
RespuestasAPIdd +
<dd+ ,
booldd, 0
>dd0 1
{ee 
	IsSuccessff 
=ff !
_iHomologacionServiceff  5
.ff5 6
Updateff6 <
(ff< =
dtoff= @
)ff@ A
}gg 
)gg 
;gg 
}hh 
catchii 
(ii 
	Exceptionii 
eii 
)ii 
{jj 
returnkk 
HandleExceptionkk &
(kk& '
ekk' (
,kk( )
nameofkk* 0
(kk0 1
Updatekk1 7
)kk7 8
)kk8 9
;kk9 :
}ll 
}mm 	
[vv 	
	Authorizevv	 
]vv 
[ww 	
HttpPostww	 
]ww 
publicxx 
IActionResultxx 
Createxx #
(xx# $
[xx$ %
FromBodyxx% -
]xx- .
HomologacionDtoxx/ >
dtoxx? B
)xxB C
{yy 	
tryzz 
{{{ 
return|| 
Ok|| 
(|| 
new|| 
RespuestasAPI|| +
<||+ ,
bool||, 0
>||0 1
{}} 
	IsSuccess~~ 
=~~ !
_iHomologacionService~~  5
.~~5 6
Create~~6 <
(~~< =
dto~~= @
)~~@ A
} 
) 
; 
}
 
catch
 
(
 
	Exception
 
e
 
)
 
{
 
return
 
HandleException
 &
(
& '
e
' (
,
( )
nameof
* 0
(
0 1
Create
1 7
)
7 8
)
8 9
;
9 :
}
 
}
 	
[
 	
	Authorize
	 
]
 
[
 	

HttpDelete
	 
(
 
$str
 
)
 
]
  
public
 
IActionResult
 
Deactive
 %
(
% &
int
& )
id
* ,
)
, -
{
 	
try
 
{
 
var
 
record
 
=
 #
_iHomologacionService
 2
.
2 3
FindById
3 ;
(
; <
id
< >
)
> ?
;
? @
if
 
(
 
record
 
==
 
null
 "
)
" #
{
 
return
 
NotFoundResponse
 +
(
+ ,

Constantes
, 6
.
6 7+
MESAGGE_REGISTRO_NO_ENCOTRADO
7 T
)
T U
;
U V
}
 
record
 
.
 
Estado
 
=
 

Constantes
  *
.
* +
ESTADO_USUARIO_X
+ ;
;
; <
return
 
Ok
 
(
 
new
 
RespuestasAPI
 +
<
+ ,
bool
, 0
>
0 1
{
 
	IsSuccess
 
=
 #
_iHomologacionService
  5
.
5 6
Update
6 <
(
< =
record
= C
)
C D
}
   
)
   
;
   
}
¡¡ 
catch
¢¢ 
(
¢¢ 
	Exception
¢¢ 
e
¢¢ 
)
¢¢ 
{
££ 
return
¤¤ 
HandleException
¤¤ &
(
¤¤& '
e
¤¤' (
,
¤¤( )
nameof
¤¤* 0
(
¤¤0 1
Deactive
¤¤1 9
)
¤¤9 :
)
¤¤: ;
;
¤¤; <
}
¥¥ 
}
¦¦ 	
[
¯¯ 	
	Authorize
¯¯	 
]
¯¯ 
[
°° 	
HttpGet
°°	 
(
°° 
Routes
°° 
.
°° )
FIND_BY_CODIGO_HOMOLOGACION
°° 3
)
°°3 4
]
°°4 5
public
±± 
IActionResult
±± &
FindByCodigoHomologacion
±± 5
(
±±5 6
string
±±6 < 
codigoHomologacion
±±= O
)
±±O P
{
²² 	
try
³³ 
{
´´ 
return
µµ 
Ok
µµ 
(
µµ 
new
µµ 
RespuestasAPI
µµ +
<
µµ+ ,
List
µµ, 0
<
µµ0 1
VwHomologacionDto
µµ1 B
>
µµB C
>
µµC D
{
¶¶ 
Result
·· 
=
·· #
_iHomologacionService
·· 2
.
··2 3,
ObtenerVwHomologacionPorCodigo
··3 Q
(
··Q R 
codigoHomologacion
··R d
)
··d e
}
¸¸ 
)
¸¸ 
;
¸¸ 
}
¹¹ 
catch
ºº 
(
ºº 
	Exception
ºº 
e
ºº 
)
ºº 
{
»» 
return
¼¼ 
HandleException
¼¼ &
(
¼¼& '
e
¼¼' (
,
¼¼( )
nameof
¼¼* 0
(
¼¼0 1&
FindByCodigoHomologacion
¼¼1 I
)
¼¼I J
)
¼¼J K
;
¼¼K L
}
½½ 
}
¾¾ 	
[
ÆÆ 	
	Authorize
ÆÆ	 
]
ÆÆ 
[
ÇÇ 	
HttpGet
ÇÇ	 
(
ÇÇ 
Routes
ÇÇ 
.
ÇÇ &
FIND_BY_ALL_HOMOLOGACION
ÇÇ 0
)
ÇÇ0 1
]
ÇÇ1 2
public
ÈÈ 
IActionResult
ÈÈ 
	FindByAll
ÈÈ &
(
ÈÈ& '
)
ÈÈ' (
{
ÉÉ 	
try
ÊÊ 
{
ËË 
return
ÌÌ 
Ok
ÌÌ 
(
ÌÌ 
new
ÌÌ 
RespuestasAPI
ÌÌ +
<
ÌÌ+ ,
List
ÌÌ, 0
<
ÌÌ0 1
HomologacionDto
ÌÌ1 @
>
ÌÌ@ A
>
ÌÌA B
{
ÍÍ 
Result
ÎÎ 
=
ÎÎ #
_iHomologacionService
ÎÎ 2
.
ÎÎ2 3
	FindByAll
ÎÎ3 <
(
ÎÎ< =
)
ÎÎ= >
}
ÏÏ 
)
ÏÏ 
;
ÏÏ 
}
ÐÐ 
catch
ÑÑ 
(
ÑÑ 
	Exception
ÑÑ 
e
ÑÑ 
)
ÑÑ 
{
ÒÒ 
return
ÓÓ 
HandleException
ÓÓ &
(
ÓÓ& '
e
ÓÓ' (
,
ÓÓ( )
nameof
ÓÓ* 0
(
ÓÓ0 1
	FindByAll
ÓÓ1 :
)
ÓÓ: ;
)
ÓÓ; <
;
ÓÓ< =
}
ÔÔ 
}
ÕÕ 	
}
ÖÖ 
}×× ²v
TC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\EventTrackingController.cs
	namespace		 	
WebApp		
 
.		 
Controllers		 
{

 
[ 
	Authorize 
] 
[ 
Route 

(
 
Routes 
. 
EVENT_TRACKING  
)  !
]! "
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class #
EventTrackingController (
:) *
BaseController+ 9
{ 
private 
readonly !
IEventTrackingService ."
_iEventTrackingService/ E
;E F
private 
readonly 
IMapper  
_mapper! (
;( )
private 
readonly !
IIpCoordinatesService ."
_iIpCoordinatesService/ E
;E F
public #
EventTrackingController &
(& '!
IEventTrackingService' <!
iEventTrackingService= R
,R S
IMapper' .
mapper/ 5
,5 6!
IIpCoordinatesService' <!
iIpCoordinatesService= R
,R S
ILogger' .
<. /
BaseController/ =
>= >
logger? E
)E F
:G H
baseI M
(M N
loggerN T
)T U
{ 	
this 
. "
_iEventTrackingService '
=( )!
iEventTrackingService* ?
;? @
this 
. 
_mapper 
= 
mapper !
;! "
this   
.   "
_iIpCoordinatesService   '
=  ( )!
iIpCoordinatesService  * ?
;  ? @
}!! 	
[,, 	
HttpGet,,	 
(,, 
$str,, -
),,- .
],,. /
public-- 
IActionResult-- 
FindById-- %
(--% &
int--& )
idHRol--* 0
,--0 1
int--2 5
idHMenu--6 =
)--= >
{.. 	
try// 
{00 
var11 
record11 
=11 "
_iEventTrackingService11 3
.113 4
FindDataById114 @
(11@ A
idHRol11A G
,11G H
idHMenu11I P
)11P Q
;11Q R
if22 
(22 
record22 
==22 
null22 "
)22" #
{33 
return44 
NotFoundResponse44 +
(44+ ,

Constantes44, 6
.446 7)
MESAGGE_REGISTRO_NO_ENCOTRADO447 T
)44T U
;44U V
}55 
return66 
Ok66 
(66 
new66 
RespuestasAPI66 +
<66+ ,

MenuRolDto66, 6
>666 7
{77 
Result88 
=88 
_mapper88 $
.88$ %
Map88% (
<88( )

MenuRolDto88) 3
>883 4
(884 5
record885 ;
)88; <
}99 
)99 
;99 
}:: 
catch;; 
(;; 
	Exception;; 
e;; 
);; 
{<< 
return== 
HandleException== &
(==& '
e==' (
,==( )
nameof==* 0
(==0 1
FindById==1 9
)==9 :
)==: ;
;==; <
}>> 
}?? 	
[EE 	
HttpGetEE	 
(EE 
RoutesEE 
.EE 
EVENT_USER_ALLEE &
)EE& '
]EE' (
publicFF 
IActionResultFF 
GetEventUserAllFF ,
(FF, -
)FF- .
{GG 	
tryHH 
{II 
returnJJ 
OkJJ 
(JJ 
newJJ 
RespuestasAPIJJ +
<JJ+ ,
ListJJ, 0
<JJ0 1
VwEventUserAllDtoJJ1 B
>JJB C
>JJC D
{KK 
ResultLL 
=LL "
_iEventTrackingServiceLL 3
.LL3 4
GetEventUserAllLL4 C
(LLC D
)LLD E
.LLE F
SelectLLF L
(LLL M
itemLLM Q
=>LLR T
_mapperLLU \
.LL\ ]
MapLL] `
<LL` a
VwEventUserAllDtoLLa r
>LLr s
(LLs t
itemLLt x
)LLx y
)LLy z
.LLz {
ToList	LL{ 
(
LL 
)
LL 
}MM 
)MM 
;MM 
}NN 
catchOO 
(OO 
	ExceptionOO 
eOO 
)OO 
{PP 
returnQQ 
HandleExceptionQQ &
(QQ& '
eQQ' (
,QQ( )
nameofQQ* 0
(QQ0 1
GetEventUserAllQQ1 @
)QQ@ A
)QQA B
;QQB C
}RR 
}SS 	
[\\ 	
HttpGet\\	 
(\\ 
Routes\\ 
.\\ 
EVENT\\ 
)\\ 
]\\ 
public]] 
IActionResult]] 
GetEventAll]] (
(]]( )
[]]) *
	FromQuery]]* 3
]]]3 4
string]]5 ;
report]]< B
,]]B C
[]]D E
	FromQuery]]E N
]]]N O
DateOnly]]P X
fini]]Y ]
,]]] ^
[]]_ `
	FromQuery]]` i
]]]i j
DateOnly]]k s
ffin]]t x
)]]x y
{^^ 	
try__ 
{`` 
returnaa 
Okaa 
(aa 
newaa 
RespuestasAPIaa +
<aa+ ,
Listaa, 0
<aa0 1
EventUserDtoaa1 =
>aa= >
>aa> ?
{bb 
Resultcc 
=cc "
_iEventTrackingServicecc 3
.cc3 4
GetEventAllcc4 ?
(cc? @
reportcc@ F
,ccF G
finiccH L
,ccL M
ffinccN R
)ccR S
.ccS T
SelectccT Z
(ccZ [
itemcc[ _
=>cc` b
_mapperccc j
.ccj k
Mapcck n
<ccn o
EventUserDtocco {
>cc{ |
(cc| }
item	cc} 
)
cc 
)
cc 
.
cc 
ToList
cc 
(
cc 
)
cc 
}dd 
)dd 
;dd 
}ee 
catchff 
(ff 
	Exceptionff 
eff 
)ff 
{gg 
returnhh 
HandleExceptionhh &
(hh& '
ehh' (
,hh( )
nameofhh* 0
(hh0 1
GetEventUserAllhh1 @
)hh@ A
)hhA B
;hhB C
}ii 
}jj 	
[rr 	

HttpDeleterr	 
(rr 
Routesrr 
.rr 
EVENT_DELETErr '
)rr' (
]rr( )
publicss 
IActionResultss 
DeleteEventAllss +
(ss+ ,
DateOnlyss, 4
finiss5 9
,ss9 :
DateOnlyss; C
ffinssD H
)ssH I
{tt 	
tryuu 
{vv 
returnww 
Okww 
(ww 
newww 
RespuestasAPIww +
<ww+ ,
boolww, 0
>ww0 1
{xx 
Resultyy 
=yy "
_iEventTrackingServiceyy 3
.yy3 4
DeleteEventAllyy4 B
(yyB C
finiyyC G
,yyG H
ffinyyI M
)yyM N
}zz 
)zz 
;zz 
}{{ 
catch|| 
(|| 
	Exception|| 
e|| 
)|| 
{}} 
return~~ 
HandleException~~ &
(~~& '
e~~' (
,~~( )
nameof~~* 0
(~~0 1
GetEventUserAll~~1 @
)~~@ A
)~~A B
;~~B C
} 
}
 	
[
 	

HttpDelete
	 
(
 
Routes
 
.
 
EVENT_DELETE_ID
 *
)
* +
]
+ ,
public
 
IActionResult
 
DeleteEventById
 ,
(
, -
int
- 0
codigoEvento
1 =
)
= >
{
 	
try
 
{
 
return
 
Ok
 
(
 
new
 
RespuestasAPI
 +
<
+ ,
bool
, 0
>
0 1
{
 
Result
 
=
 $
_iEventTrackingService
 3
.
3 4
DeleteEventById
4 C
(
C D
codigoEvento
D P
)
P Q
}
 
)
 
;
 
}
 
catch
 
(
 
	Exception
 
e
 
)
 
{
 
return
 
HandleException
 &
(
& '
e
' (
,
( )
nameof
* 0
(
0 1
GetEventUserAll
1 @
)
@ A
)
A B
;
B C
}
 
}
 	
[
 	
HttpGet
	 
(
 
Routes
 
.
 
EVENT_SESSION
 %
)
% &
]
& '
public
 
IActionResult
 
GetEventSession
 ,
(
, -
)
- .
{
 	
try
 
{
   
return
¡¡ 
Ok
¡¡ 
(
¡¡ 
new
¡¡ 
RespuestasAPI
¡¡ +
<
¡¡+ ,
List
¡¡, 0
<
¡¡0 1'
VwEventTrackingSessionDto
¡¡1 J
>
¡¡J K
>
¡¡K L
{
¢¢ 
Result
££ 
=
££ $
_iEventTrackingService
££ 3
.
££3 4
GetEventSession
££4 C
(
££C D
)
££D E
.
££E F
ToList
££F L
(
££L M
)
££M N
}
¤¤ 
)
¤¤ 
;
¤¤ 
}
¥¥ 
catch
¦¦ 
(
¦¦ 
	Exception
¦¦ 
e
¦¦ 
)
¦¦ 
{
§§ 
return
¨¨ 
HandleException
¨¨ &
(
¨¨& '
e
¨¨' (
,
¨¨( )
nameof
¨¨* 0
(
¨¨0 1
GetEventSession
¨¨1 @
)
¨¨@ A
)
¨¨A B
;
¨¨B C
}
©© 
}
ªª 	
[
²² 	
HttpGet
²²	 
(
²² 
Routes
²² 
.
²² 
COORDINATES
²² #
)
²²# $
]
²²$ %
public
³³ 
async
³³ 
Task
³³ 
<
³³ 
IActionResult
³³ '
>
³³' (
GetCoordinates
³³) 7
(
³³7 8
string
³³8 >
ip
³³? A
)
³³A B
{
´´ 	
try
µµ 
{
¶¶ 
var
·· 
result
·· 
=
·· 
await
·· "$
_iIpCoordinatesService
··# 9
.
··9 :
GetCoordinates
··: H
(
··H I
ip
··I K
)
··K L
;
··L M
if
¹¹ 
(
¹¹ 
result
¹¹ 
==
¹¹ 
null
¹¹ "
)
¹¹" #
return
ºº 
NotFound
ºº #
(
ºº# $
new
ºº$ '
RespuestasAPI
ºº( 5
<
ºº5 6
string
ºº6 <
>
ºº< =
{
»» 
Result
¼¼ 
=
¼¼  
null
¼¼! %
}
½½ 
)
½½ 
;
½½ 
return
¿¿ 
Ok
¿¿ 
(
¿¿ 
result
¿¿  
)
¿¿  !
;
¿¿! "
}
ÀÀ 
catch
ÁÁ 
(
ÁÁ 
	Exception
ÁÁ 
e
ÁÁ 
)
ÁÁ 
{
ÂÂ 
return
ÃÃ 
HandleException
ÃÃ &
(
ÃÃ& '
e
ÃÃ' (
,
ÃÃ( )
nameof
ÃÃ* 0
(
ÃÃ0 1
GetCoordinates
ÃÃ1 ?
)
ÃÃ? @
)
ÃÃ@ A
;
ÃÃA B
}
ÄÄ 
}
ÅÅ 	
[
ËË 	
HttpGet
ËË	 
(
ËË 
Routes
ËË 
.
ËË !
EVENT_PAG_MAS_VISIT
ËË +
)
ËË+ ,
]
ËË, -
public
ÌÌ 
IActionResult
ÌÌ !
GetEventPagMasVisit
ÌÌ 0
(
ÌÌ0 1
)
ÌÌ1 2
{
ÍÍ 	
try
ÎÎ 
{
ÏÏ 
return
ÐÐ 
Ok
ÐÐ 
(
ÐÐ 
new
ÐÐ 
RespuestasAPI
ÐÐ +
<
ÐÐ+ ,
List
ÐÐ, 0
<
ÐÐ0 1#
PaginasMasVisitadaDto
ÐÐ1 F
>
ÐÐF G
>
ÐÐG H
{
ÑÑ 
Result
ÒÒ 
=
ÒÒ $
_iEventTrackingService
ÒÒ 3
.
ÒÒ3 4!
GetEventPagMasVisit
ÒÒ4 G
(
ÒÒG H
)
ÒÒH I
.
ÒÒI J
ToList
ÒÒJ P
(
ÒÒP Q
)
ÒÒQ R
}
ÓÓ 
)
ÓÓ 
;
ÓÓ 
}
ÔÔ 
catch
ÕÕ 
(
ÕÕ 
	Exception
ÕÕ 
e
ÕÕ 
)
ÕÕ 
{
ÖÖ 
return
×× 
HandleException
×× &
(
××& '
e
××' (
,
××( )
nameof
××* 0
(
××0 1!
GetEventPagMasVisit
××1 D
)
××D E
)
××E F
;
××F G
}
ØØ 
}
ÙÙ 	
[
ÛÛ 	
HttpGet
ÛÛ	 
(
ÛÛ 
Routes
ÛÛ 
.
ÛÛ $
EVENT_FILTRO_MAS_USADO
ÛÛ .
)
ÛÛ. /
]
ÛÛ/ 0
public
ÜÜ 
IActionResult
ÜÜ $
GetEventFiltroMasUsado
ÜÜ 3
(
ÜÜ3 4
)
ÜÜ4 5
{
ÝÝ 	
try
ÞÞ 
{
ßß 
return
àà 
Ok
àà 
(
àà 
new
àà 
RespuestasAPI
àà +
<
àà+ ,
List
àà, 0
<
àà0 1 
FiltrosMasUsadoDto
àà1 C
>
ààC D
>
ààD E
{
áá 
Result
ââ 
=
ââ $
_iEventTrackingService
ââ 3
.
ââ3 4"
GetEventFiltroMasUsa
ââ4 H
(
ââH I
)
ââI J
.
ââJ K
ToList
ââK Q
(
ââQ R
)
ââR S
}
ãã 
)
ãã 
;
ãã 
}
ää 
catch
åå 
(
åå 
	Exception
åå 
e
åå 
)
åå 
{
ææ 
return
çç 
HandleException
çç &
(
çç& '
e
çç' (
,
çç( )
nameof
çç* 0
(
çç0 1$
GetEventFiltroMasUsado
çç1 G
)
ççG H
)
ççH I
;
ççI J
}
èè 
}
éé 	
}
ëë 
}ìì ¯I
QC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\GoogleAuthController.cs
	namespace 	
WebApp
 
. 
Controllers 
{		 
[ 
Route 

(
 
Routes 
. 
GOOGLE 
) 
] 
[ 
ApiController 
] 
public 

class  
GoogleAuthController %
:& '
ControllerBase( 6
{ 
private 
readonly 
IConfiguration '
_configuration( 6
;6 7
private 
readonly 
ILogger  
<  ! 
GoogleAuthController! 5
>5 6
_logger7 >
;> ?
public    
GoogleAuthController   #
(  # $
IConfiguration  $ 2
configuration  3 @
,  @ A
ILogger  B I
<  I J 
GoogleAuthController  J ^
>  ^ _
logger  ` f
)  f g
{!! 	
_configuration"" 
="" 
configuration"" *
;""* +
_logger## 
=## 
logger## 
;## 
}$$ 	
[)) 	
HttpGet))	 
()) 
Routes)) 
.)) 
	AUTHORIZE)) !
)))! "
]))" #
public** 
IActionResult** 
	Authorize** &
(**& '
)**' (
{++ 	
if-- 
(-- 
	Directory-- 
.-- 
Exists--  
(--  !
_configuration--! /
[--/ 0
$str--0 D
]--D E
)--E F
)--F G
{.. 
var00 

tokenFiles00 
=00  
	Directory00! *
.00* +
GetFiles00+ 3
(003 4
_configuration004 B
[00B C
$str00C W
]00W X
)00X Y
;00Y Z
if22 
(22 

tokenFiles22 
.22 
Length22 %
>22& '
$num22( )
)22) *
{33 
_logger44 
.44 
LogInformation44 *
(44* +
$str44+ [
)44[ \
;44\ ]
return55 
Ok55 
(55 
new55 !
{55" #
message55$ +
=55, -
$str55. s
}55t u
)55u v
;55v w
}66 
}77 
else88 
{99 
	Directory;; 
.;; 
CreateDirectory;; )
(;;) *
_configuration;;* 8
[;;8 9
$str;;9 M
];;M N
);;N O
;;;O P
}<< 
try>> 
{?? 
varAA 
clientIdAA 
=AA 
_configurationAA -
[AA- .
$strAA. D
]AAD E
;AAE F
varBB 
clientSecretBB  
=BB! "
_configurationBB# 1
[BB1 2
$strBB2 L
]BBL M
;BBM N
varCC 
redirectUriCC 
=CC  !
_configurationCC" 0
[CC0 1
$strCC1 J
]CCJ K
;CCK L
varEE 
clientSecretsEE !
=EE" #
newEE$ '
ClientSecretsEE( 5
{FF 
ClientIdGG 
=GG 
clientIdGG '
,GG' (
ClientSecretHH  
=HH! "
clientSecretHH# /
}II 
;II 
varKK 
flowKK 
=KK 
newKK '
GoogleAuthorizationCodeFlowKK :
(KK: ;
newKK; >'
GoogleAuthorizationCodeFlowKK? Z
.KKZ [
InitializerKK[ f
{LL 
ClientSecretsMM !
=MM" #
clientSecretsMM$ 1
,MM1 2
ScopesNN 
=NN 
newNN  
[NN  !
]NN! "
{NN# $
_configurationNN% 3
[NN3 4
$strNN4 M
]NNM N
}NNO P
,NNP Q
	DataStoreOO 
=OO 
newOO  #
FileDataStoreOO$ 1
(OO1 2
_configurationOO2 @
[OO@ A
$strOOA U
]OOU V
,OOV W
trueOOX \
)OO\ ]
}PP 
)PP 
;PP 
stringSS 
authorizationUrlSS '
=SS( )
flowSS* .
.SS. /*
CreateAuthorizationCodeRequestSS/ M
(SSM N
redirectUriSSN Y
)SSY Z
.SSZ [
BuildSS[ `
(SS` a
)SSa b
.SSb c
ToStringSSc k
(SSk l
)SSl m
;SSm n
_loggerUU 
.UU 
LogInformationUU &
(UU& '
$strUU' R
)UUR S
;UUS T
returnVV 
RedirectVV 
(VV  
authorizationUrlVV  0
)VV0 1
;VV1 2
}WW 
catchXX 
(XX 
	ExceptionXX 
exXX 
)XX  
{YY 
_loggerZZ 
.ZZ 
LogErrorZZ  
(ZZ  !
$"ZZ! #
$strZZ# J
{ZZJ K
exZZK M
.ZZM N
MessageZZN U
}ZZU V
"ZZV W
)ZZW X
;ZZX Y
return[[ 

BadRequest[[ !
([[! "
$str[[" W
)[[W X
;[[X Y
}\\ 
}]] 	
[bb 	
HttpGetbb	 
(bb 
Routesbb 
.bb 
CALLBACKbb  
)bb  !
]bb! "
publiccc 
asynccc 
Taskcc 
<cc 
IActionResultcc '
>cc' (
Callbackcc) 1
(cc1 2
stringcc2 8
codecc9 =
)cc= >
{dd 	
ifee 
(ee 
stringee 
.ee 
IsNullOrEmptyee $
(ee$ %
codeee% )
)ee) *
)ee* +
{ff 
returngg 

BadRequestgg !
(gg! "
$strgg" N
)ggN O
;ggO P
}hh 
tryjj 
{kk 
varmm 
clientIdmm 
=mm 
_configurationmm -
[mm- .
$strmm. D
]mmD E
;mmE F
varnn 
clientSecretnn  
=nn! "
_configurationnn# 1
[nn1 2
$strnn2 L
]nnL M
;nnM N
varoo 
redirectUrioo 
=oo  !
_configurationoo" 0
[oo0 1
$stroo1 J
]ooJ K
;ooK L
varpp 
	userEmailpp 
=pp 
_configurationpp  .
[pp. /
$strpp/ E
]ppE F
;ppF G
varrr 
clientSecretsrr !
=rr" #
newrr$ '
ClientSecretsrr( 5
{ss 
ClientIdtt 
=tt 
clientIdtt '
,tt' (
ClientSecretuu  
=uu! "
clientSecretuu# /
}vv 
;vv 
varxx 
flowxx 
=xx 
newxx '
GoogleAuthorizationCodeFlowxx :
(xx: ;
newxx; >'
GoogleAuthorizationCodeFlowxx? Z
.xxZ [
Initializerxx[ f
{yy 
ClientSecretszz !
=zz" #
clientSecretszz$ 1
,zz1 2
Scopes{{ 
={{ 
new{{  
[{{  !
]{{! "
{{{# $
_configuration{{% 3
[{{3 4
$str{{4 P
]{{P Q
}{{R S
,{{S T
	DataStore|| 
=|| 
new||  #
FileDataStore||$ 1
(||1 2
_configuration||2 @
[||@ A
$str||A U
]||U V
,||V W
true||X \
)||\ ]
}}} 
)}} 
;}} 
TokenResponse
 
token
 #
=
$ %
await
& +
flow
, 0
.
0 1'
ExchangeCodeForTokenAsync
1 J
(
J K
	userEmail
 
,
 
code
 #
,
# $
redirectUri
% 0
,
0 1
CancellationToken
2 C
.
C D
None
D H
)
H I
;
I J
_logger
 
.
 
LogInformation
 &
(
& '
$str
' @
,
@ A
JsonConvert
B M
.
M N
SerializeObject
N ]
(
] ^
token
^ c
)
c d
)
d e
;
e f
_logger
 
.
 
LogInformation
 &
(
& '
$str
' O
)
O P
;
P Q
return
 
Ok
 
(
 
new
 
{
 
message
  '
=
( )
$str
* R
}
S T
)
T U
;
U V
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
 
_logger
 
.
 
LogError
  
(
  !
$"
! #
$str
# >
{
> ?
ex
? A
.
A B
Message
B I
}
I J
"
J K
)
K L
;
L M
return
 

BadRequest
 !
(
! "
$"
" $
$str
$ ?
{
? @
ex
@ B
.
B C
Message
C J
}
J K
"
K L
)
L M
;
M N
}
 
}
 	
}
 
} ú
NC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\EsquemaController.cs
	namespace 	
WebApp
 
. 
Controllers 
{ 
[ 
Route 

(
 
Routes 
. 
ESQUEMA 
) 
] 
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class 
EsquemaController "
:# $
BaseController% 3
{ 
private 
readonly 
IEsquemaService (
_iEsquemaService) 9
;9 :
private 
readonly 
IMapper  
_mapper! (
;( )
public 
EsquemaController  
(  !
IEsquemaService! 0
iEsquemaService1 @
,@ A
IMapper! (
mapper) /
,/ 0
ILogger1 8
<8 9
BaseController9 G
>G H
loggerI O
)O P
:Q R
baseS W
(W X
loggerX ^
)^ _
{ 	
this 
. 
_iEsquemaService !
=" #
iEsquemaService$ 3
;3 4
this 
. 
_mapper 
= 
mapper !
;! "
} 	
[(( 	
	Authorize((	 
](( 
[)) 	
HttpGet))	 
])) 
public** 
IActionResult** 
FindAll** $
(**$ %
)**% &
{++ 	
try,, 
{-- 
return.. 
Ok.. 
(.. 
new.. 
RespuestasAPI.. +
<..+ ,
List.., 0
<..0 1

EsquemaDto..1 ;
>..; <
>..< =
{// 
Result00 
=00 
_iEsquemaService00 -
.00- .
FindAll00. 5
(005 6
)006 7
.007 8
Select008 >
(00> ?
item00? C
=>00D F
_mapper00G N
.00N O
Map00O R
<00R S

EsquemaDto00S ]
>00] ^
(00^ _
item00_ c
)00c d
)00d e
.00e f
ToList00f l
(00l m
)00m n
}11 
)11 
;11 
}22 
catch33 
(33 
	Exception33 
e33 
)33 
{44 
return55 
HandleException55 &
(55& '
e55' (
,55( )
nameof55* 0
(550 1
FindAll551 8
)558 9
)559 :
;55: ;
}66 
}77 	
[AA 	
	AuthorizeAA	 
]AA 
[BB 	
HttpGetBB	 
(BB 
$strBB 
)BB 
]BB 
publicCC 
IActionResultCC 
FindByIdCC %
(CC% &
intCC& )
idCC* ,
)CC, -
{DD 	
tryEE 
{FF 
varGG 
recordGG 
=GG 
_iEsquemaServiceGG -
.GG- .
FindByIdGG. 6
(GG6 7
idGG7 9
)GG9 :
;GG: ;
ifII 
(II 
recordII 
==II 
nullII "
)II" #
{JJ 
returnKK 
NotFoundResponseKK +
(KK+ ,

ConstantesKK, 6
.KK6 7)
MESAGGE_REGISTRO_NO_ENCOTRADOKK7 T
)KKT U
;KKU V
}LL 
returnNN 
OkNN 
(NN 
newNN 
RespuestasAPINN +
<NN+ ,

EsquemaDtoNN, 6
>NN6 7
{OO 
ResultPP 
=PP 
_mapperPP $
.PP$ %
MapPP% (
<PP( )

EsquemaDtoPP) 3
>PP3 4
(PP4 5
recordPP5 ;
)PP; <
}QQ 
)QQ 
;QQ 
}RR 
catchSS 
(SS 
	ExceptionSS 
eSS 
)SS 
{TT 
returnUU 
HandleExceptionUU &
(UU& '
eUU' (
,UU( )
nameofUU* 0
(UU0 1
FindByIdUU1 9
)UU9 :
)UU: ;
;UU; <
}VV 
}WW 	
[aa 	
	Authorizeaa	 
]aa 
[bb 	
HttpPutbb	 
(bb 
$strbb 
)bb 
]bb 
publiccc 
IActionResultcc 
Updatecc #
(cc# $
intcc$ '
idcc( *
,cc* +
[cc, -
FromBodycc- 5
]cc5 6

EsquemaDtocc7 A
dtoccB E
)ccE F
{dd 	
tryee 
{ff 
dtogg 
.gg 
	IdEsquemagg 
=gg 
idgg  "
;gg" #
varhh 
recordhh 
=hh 
_mapperhh $
.hh$ %
Maphh% (
<hh( )
Esquemahh) 0
>hh0 1
(hh1 2
dtohh2 5
)hh5 6
;hh6 7
returnjj 
Okjj 
(jj 
newjj 
RespuestasAPIjj +
<jj+ ,
booljj, 0
>jj0 1
{kk 
	IsSuccessll 
=ll 
_iEsquemaServicell  0
.ll0 1
Updatell1 7
(ll7 8
recordll8 >
)ll> ?
}mm 
)mm 
;mm 
}nn 
catchoo 
(oo 
	Exceptionoo 
eoo 
)oo 
{pp 
returnqq 
HandleExceptionqq &
(qq& '
eqq' (
,qq( )
nameofqq* 0
(qq0 1
Updateqq1 7
)qq7 8
)qq8 9
;qq9 :
}rr 
}ss 	
[|| 	
	Authorize||	 
]|| 
[}} 	
HttpPost}}	 
]}} 
public~~ 
IActionResult~~ 
Create~~ #
(~~# $
[~~$ %
FromBody~~% -
]~~- .

EsquemaDto~~/ 9
dto~~: =
)~~= >
{ 	
try
 
{
 
var
 
record
 
=
 
_mapper
 $
.
$ %
Map
% (
<
( )
Esquema
) 0
>
0 1
(
1 2
dto
2 5
)
5 6
;
6 7
return
 
Ok
 
(
 
new
 
RespuestasAPI
 +
<
+ ,
bool
, 0
>
0 1
{
 
	IsSuccess
 
=
 
_iEsquemaService
  0
.
0 1
Create
1 7
(
7 8
record
8 >
)
> ?
}
 
)
 
;
 
}
 
catch
 
(
 
	Exception
 
e
 
)
 
{
 
return
 
HandleException
 &
(
& '
e
' (
,
( )
nameof
* 0
(
0 1
Create
1 7
)
7 8
)
8 9
;
9 :
}
 
}
 	
[
 	
	Authorize
	 
]
 
[
 	

HttpDelete
	 
(
 
$str
 
)
 
]
  
public
 
IActionResult
 
Deactive
 %
(
% &
int
& )
id
* ,
)
, -
{
 	
try
 
{
 
var
 
record
 
=
 
_iEsquemaService
 -
.
- .
FindById
. 6
(
6 7
id
7 9
)
9 :
;
: ;
if
 
(
 
record
 
==
 
null
 "
)
" #
{
 
return
   
NotFoundResponse
   +
(
  + ,

Constantes
  , 6
.
  6 7+
MESAGGE_REGISTRO_NO_ENCOTRADO
  7 T
)
  T U
;
  U V
}
¡¡ 
record
££ 
.
££ 
Estado
££ 
=
££ 

Constantes
££  *
.
££* +
ESTADO_USUARIO_X
££+ ;
;
££; <
return
¥¥ 
Ok
¥¥ 
(
¥¥ 
new
¥¥ 
RespuestasAPI
¥¥ +
<
¥¥+ ,
bool
¥¥, 0
>
¥¥0 1
{
¦¦ 
	IsSuccess
§§ 
=
§§ 
_iEsquemaService
§§  0
.
§§0 1
Update
§§1 7
(
§§7 8
record
§§8 >
)
§§> ?
}
¨¨ 
)
¨¨ 
;
¨¨ 
}
©© 
catch
ªª 
(
ªª 
	Exception
ªª 
e
ªª 
)
ªª 
{
«« 
return
¬¬ 
HandleException
¬¬ &
(
¬¬& '
e
¬¬' (
,
¬¬( )
nameof
¬¬* 0
(
¬¬0 1
Deactive
¬¬1 9
)
¬¬9 :
)
¬¬: ;
;
¬¬; <
}
­­ 
}
®® 	
[
·· 	
	Authorize
··	 
]
·· 
[
¸¸ 	

HttpDelete
¸¸	 
(
¸¸ 
Routes
¸¸ 
.
¸¸ 

VALIDACION
¸¸ %
)
¸¸% &
]
¸¸& '
public
¹¹ 
IActionResult
¹¹ =
/EliminarEsquemaVistaColumnaByIdEquemaVistaAsync
¹¹ L
(
¹¹L M
[
¹¹M N
FromBody
¹¹N V
]
¹¹V W'
EsquemaVistaValidacionDto
¹¹X q
esquemaRegistro¹¹r 
)¹¹ 
{
ºº 	
try
»» 
{
¼¼ 
var
½½ 
record
½½ 
=
½½ 
_iEsquemaService
½½ -
.
½½- .8
*GetEsquemaVistaColumnaByIdEquemaVistaAsync
½½. X
(
½½X Y
esquemaRegistro
½½Y h
.
½½h i
IdOna
½½i n
,
½½n o
esquemaRegistro
½½p 
.½½ 
	IdEsquema½½ 
)½½ 
;½½ 
if
¿¿ 
(
¿¿ 
record
¿¿ 
==
¿¿ 
null
¿¿ "
)
¿¿" #
{
ÀÀ 
return
ÁÁ 
NotFoundResponse
ÁÁ +
(
ÁÁ+ ,

Constantes
ÁÁ, 6
.
ÁÁ6 7+
MESAGGE_REGISTRO_NO_ENCOTRADO
ÁÁ7 T
)
ÁÁT U
;
ÁÁU V
}
ÂÂ 
record
ÄÄ 
.
ÄÄ 
Estado
ÄÄ 
=
ÄÄ 

Constantes
ÄÄ  *
.
ÄÄ* +
ESTADO_USUARIO_X
ÄÄ+ ;
;
ÄÄ; <
var
ÆÆ 
	isDeleted
ÆÆ 
=
ÆÆ 
_iEsquemaService
ÆÆ  0
.
ÆÆ0 1=
/EliminarEsquemaVistaColumnaByIdEquemaVistaAsync
ÆÆ1 `
(
ÆÆ` a
record
ÆÆa g
.
ÆÆg h
IdEsquemaVista
ÆÆh v
)
ÆÆv w
;
ÆÆw x
return
ÈÈ 
Ok
ÈÈ 
(
ÈÈ 
new
ÈÈ 
RespuestasAPI
ÈÈ +
<
ÈÈ+ ,
bool
ÈÈ, 0
>
ÈÈ0 1
{
ÉÉ 
	IsSuccess
ÊÊ 
=
ÊÊ 
	isDeleted
ÊÊ  )
}
ËË 
)
ËË 
;
ËË 
}
ÌÌ 
catch
ÍÍ 
(
ÍÍ 
	Exception
ÍÍ 
e
ÍÍ 
)
ÍÍ 
{
ÎÎ 
return
ÏÏ 
HandleException
ÏÏ &
(
ÏÏ& '
e
ÏÏ' (
,
ÏÏ( )
nameof
ÏÏ* 0
(
ÏÏ0 1=
/EliminarEsquemaVistaColumnaByIdEquemaVistaAsync
ÏÏ1 `
)
ÏÏ` a
)
ÏÏa b
;
ÏÏb c
}
ÐÐ 
}
ÑÑ 	
[
ÚÚ 	
	Authorize
ÚÚ	 
]
ÚÚ 
[
ÛÛ 	
Route
ÛÛ	 
(
ÛÛ 
Routes
ÛÛ 
.
ÛÛ &
VALIDACION_ACTUALIZACION
ÛÛ .
)
ÛÛ. /
]
ÛÛ/ 0
[
ÜÜ 	
HttpPut
ÜÜ	 
]
ÜÜ 
public
ÝÝ 
IActionResult
ÝÝ %
UpdateEsquemaValidacion
ÝÝ 4
(
ÝÝ4 5
[
ÝÝ5 6
FromBody
ÝÝ6 >
]
ÝÝ> ?'
EsquemaVistaValidacionDto
ÝÝ@ Y
dto
ÝÝZ ]
)
ÝÝ] ^
{
ÞÞ 	
try
ßß 
{
àà 
var
áá 
record
áá 
=
áá 
_mapper
áá $
.
áá$ %
Map
áá% (
<
áá( )
EsquemaVista
áá) 5
>
áá5 6
(
áá6 7
dto
áá7 :
)
áá: ;
;
áá; <
return
ãã 
Ok
ãã 
(
ãã 
new
ãã 
RespuestasAPI
ãã +
<
ãã+ ,
bool
ãã, 0
>
ãã0 1
{
ää 
	IsSuccess
åå 
=
åå 
_iEsquemaService
åå  0
.
åå0 1%
UpdateEsquemaValidacion
åå1 H
(
ååH I
record
ååI O
)
ååO P
}
ææ 
)
ææ 
;
ææ 
}
çç 
catch
èè 
(
èè 
	Exception
èè 
e
èè 
)
èè 
{
éé 
return
êê 
HandleException
êê &
(
êê& '
e
êê' (
,
êê( )
nameof
êê* 0
(
êê0 1%
UpdateEsquemaValidacion
êê1 H
)
êêH I
)
êêI J
;
êêJ K
}
ëë 
}
ìì 	
[
õõ 	
	Authorize
õõ	 
]
õõ 
[
öö 	
Route
öö	 
(
öö 
Routes
öö 
.
öö 

VALIDACION
öö  
)
öö  !
]
öö! "
[
÷÷ 	
HttpPost
÷÷	 
]
÷÷ 
public
øø 
IActionResult
øø %
CreateEsquemaValidacion
øø 4
(
øø4 5
[
øø5 6
FromBody
øø6 >
]
øø> ?'
EsquemaVistaValidacionDto
øø@ Y
dto
øøZ ]
)
øø] ^
{
ùù 	
try
úú 
{
ûû 
var
üü 
record
üü 
=
üü 
_mapper
üü $
.
üü$ %
Map
üü% (
<
üü( )
EsquemaVista
üü) 5
>
üü5 6
(
üü6 7
dto
üü7 :
)
üü: ;
;
üü; <
return
þþ 
Ok
þþ 
(
þþ 
new
þþ 
RespuestasAPI
þþ +
<
þþ+ ,
bool
þþ, 0
>
þþ0 1
{
ÿÿ 
	IsSuccess
 
=
 
_iEsquemaService
  0
.
0 1%
CreateEsquemaValidacion
1 H
(
H I
record
I O
)
O P
}
 
)
 
;
 
}
 
catch
 
(
 
	Exception
 
e
 
)
 
{
 
return
 
HandleException
 &
(
& '
e
' (
,
( )
nameof
* 0
(
0 1%
CreateEsquemaValidacion
1 H
)
H I
)
I J
;
J K
}
 
}
 	
[
 	
	Authorize
	 
]
 
[
 	
Route
	 
(
 
Routes
 
.
 
VISTA_COLUMNA
 #
)
# $
]
$ %
[
 	
HttpPost
	 
]
 
public
 
IActionResult
 -
GuardarListaEsquemaVistaColumna
 <
(
< =
[
 
FromBody
 
]
 
List
 
<
 $
EsquemaVistaColumnaDto
 2
>
2 3&
listaEsquemaVistaColumna
4 L
,
L M
[
 
	FromQuery
 
]
 
int
 
idOna
 !
,
! "
[
 
	FromQuery
 
]
 
int
 
	idEsquema
 %
)
% &
{
 	
try
 
{
 
var
 
record
 
=
 
_mapper
 $
.
$ %
Map
% (
<
( )
List
) -
<
- .!
EsquemaVistaColumna
. A
>
A B
>
B C
(
C D&
listaEsquemaVistaColumna
D \
)
\ ]
;
] ^
return
 
Ok
 
(
 
new
 
RespuestasAPI
 +
<
+ ,
bool
, 0
>
0 1
{
   
	IsSuccess
¡¡ 
=
¡¡ 
_iEsquemaService
¡¡  0
.
¡¡0 1-
GuardarListaEsquemaVistaColumna
¡¡1 P
(
¡¡P Q
record
¡¡Q W
,
¡¡W X
idOna
¡¡Y ^
,
¡¡^ _
	idEsquema
¡¡` i
)
¡¡i j
}
¢¢ 
)
¢¢ 
;
¢¢ 
}
££ 
catch
¤¤ 
(
¤¤ 
	Exception
¤¤ 
e
¤¤ 
)
¤¤ 
{
¥¥ 
return
¦¦ 
HandleException
¦¦ &
(
¦¦& '
e
¦¦' (
,
¦¦( )
nameof
¦¦* 0
(
¦¦0 1-
GuardarListaEsquemaVistaColumna
¦¦1 P
)
¦¦P Q
)
¦¦Q R
;
¦¦R S
}
§§ 
}
¨¨ 	
[
²² 	
	Authorize
²²	 
]
²² 
[
³³ 	
HttpGet
³³	 
(
³³ 
Routes
³³ 
.
³³ 

ESQUEMA_ID
³³ "
,
³³" #
Name
³³$ (
=
³³) *
$str
³³+ A
)
³³A B
]
³³B C
public
´´ 
IActionResult
´´ "
GetListaEsquemaByOna
´´ 1
(
´´1 2
int
´´2 5
idOna
´´6 ;
)
´´; <
{
µµ 	
try
¶¶ 
{
·· 
var
¸¸ 
result
¸¸ 
=
¸¸ 
_iEsquemaService
¸¸ -
.
¸¸- ."
GetListaEsquemaByOna
¸¸. B
(
¸¸B C
idOna
¸¸C H
)
¸¸H I
;
¸¸I J
return
¹¹ 
Ok
¹¹ 
(
¹¹ 
new
¹¹ 
RespuestasAPI
¹¹ +
<
¹¹+ ,
List
¹¹, 0
<
¹¹0 1
Esquema
¹¹1 8
>
¹¹8 9
>
¹¹9 :
{
¹¹; <
Result
¹¹= C
=
¹¹D E
result
¹¹F L
}
¹¹M N
)
¹¹N O
;
¹¹O P
}
ºº 
catch
»» 
(
»» 
	Exception
»» 
e
»» 
)
»» 
{
¼¼ 
return
½½ 
HandleException
½½ &
(
½½& '
e
½½' (
,
½½( )
nameof
½½* 0
(
½½0 1"
GetListaEsquemaByOna
½½1 E
)
½½E F
)
½½F G
;
½½G H
}
¾¾ 
}
¿¿ 	
}
ÂÂ 
}ÃÃ ó
LC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\EmailController.cs
	namespace 	
WebApp
 
. 
Controllers 
{		 
[

 
	Authorize

 
]

 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class 
EmailController  
:! "
BaseController# 1
{ 
private 
readonly 
IEmailService &
_emailService' 4
;4 5
public 
EmailController 
( 
IEmailService ,
emailService- 9
,9 :
ILogger &
<& '
BaseController' 5
>5 6
logger7 =
)= >
:> ?
base@ D
(D E
loggerE K
)K L
{ 	
this 
. 
_emailService 
=  
emailService! -
;- .
} 	
[ 	
HttpPost	 
( 
Routes 
. 
ENVIAR 
)  
]  !
public 
async 
Task 
< 
IActionResult '
>' (
EnviarCorreoRol) 8
(8 9
[9 :
FromBody: B
]B C
EmailDtoD L
emailM R
)R S
{T U
try 
{ 
var   
result   
=   
await   "
_emailService  # 0
.  0 1
SendEmailAsync  1 ?
(  ? @
$str  @ B
,  B C
$str  D F
,  F G
$str  H J
)  J K
;  K L
return!! 
Ok!! 
(!! 
new!! 
RespuestasAPI!! +
<!!+ ,
bool!!, 0
>!!0 1
(!!1 2
)!!2 3
{!!4 5
Result!!6 <
=!!= >
result!!? E
}!!F G
)!!G H
;!!H I
}"" 
catch## 
(## 
	Exception## 
e## 
)## 
{$$ 
return%% 
HandleException%% &
(%%& '
e%%' (
,%%( )
nameof%%* 0
(%%0 1
EnviarCorreoRol%%1 @
)%%@ A
)%%A B
;%%B C
}&& 
}'' 	
}** 
}++ ¾V
NC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\DynamicController.cs
	namespace		 	
WebApp		
 
.		 
Controllers		 
{

 
[ 
AllowAnonymous 
] 
[ 
Route 

(
 
Routes 
. 
DYNAMIC 
) 
] 
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class 
DynamicController "
:# $
BaseController% 3
{ 
private 
readonly 
IDynamicService (
_dynamicService) 8
;8 9
public 
DynamicController  
(  !
IDynamicService! 0
dynamicService1 ?
,? @
ILoggerA H
<H I
BaseControllerI W
>W X
loggerY _
)_ `
:a b
basec g
(g h
loggerh n
)n o
{ 	
_dynamicService 
= 
dynamicService ,
;, -
} 	
[%% 	
HttpGet%%	 
(%% 
Routes%% 
.%% 
GETPROPERTIES%% %
,%%% &
Name%%' +
=%%, -
$str%%. =
)%%= >
]%%> ?
public&& 
IActionResult&& 
GetProperties&& *
(&&* +
int&&+ .
idOna&&/ 4
,&&4 5
string&&6 <
viewName&&= E
)&&E F
{'' 	
try(( 
{)) 
var** 
result** 
=** 
_dynamicService** ,
.**, -
GetProperties**- :
(**: ;
idOna**; @
,**@ A
viewName**B J
)**J K
;**K L
return++ 
Ok++ 
(++ 
new++ 
RespuestasAPI++ +
<+++ ,
List++, 0
<++0 1
PropiedadesTablaDto++1 D
>++D E
>++E F
{++G H
Result++I O
=++P Q
result++R X
}++Y Z
)++Z [
;++[ \
},, 
catch-- 
(-- 
	Exception-- 
e-- 
)-- 
{.. 
return// 
HandleException// &
(//& '
e//' (
,//( )
nameof//* 0
(//0 1
GetProperties//1 >
)//> ?
)//? @
;//@ A
}00 
}11 	
[?? 	
HttpGet??	 
(?? 
Routes?? 
.?? 
GETVALUECOLUMNA?? '
,??' (
Name??) -
=??. /
$str??0 A
)??A B
]??B C
public@@ 
IActionResult@@ 
GetValueColumna@@ ,
(@@, -
int@@- 0
idONA@@1 6
,@@6 7
string@@8 >
valueColumn@@? J
,@@J K
string@@L R
viewName@@S [
)@@[ \
{AA 	
tryBB 
{CC 
varDD 
resultDD 
=DD 
_dynamicServiceDD ,
.DD, -
GetValueColumnaDD- <
(DD< =
idONADD= B
,DDB C
valueColumnDDD O
,DDO P
viewNameDDQ Y
)DDY Z
;DDZ [
returnEE 
OkEE 
(EE 
newEE 
RespuestasAPIEE +
<EE+ ,
ListEE, 0
<EE0 1
PropiedadesTablaDtoEE1 D
>EED E
>EEE F
{EEG H
ResultEEI O
=EEP Q
resultEER X
}EEY Z
)EEZ [
;EE[ \
}FF 
catchGG 
(GG 
	ExceptionGG 
eGG 
)GG 
{HH 
returnII 
HandleExceptionII &
(II& '
eII' (
,II( )
nameofII* 0
(II0 1
GetValueColumnaII1 @
)II@ A
)IIA B
;IIB C
}JJ 
}KK 	
[UU 	
HttpGetUU	 
(UU 
$strUU 
,UU 
NameUU  
=UU! "
$strUU# 1
)UU1 2
]UU2 3
publicVV 
IActionResultVV 
GetViewNamesVV )
(VV) *
intVV* -
idOnaVV. 3
)VV3 4
{WW 	
tryXX 
{YY 
varZZ 
resultZZ 
=ZZ 
_dynamicServiceZZ ,
.ZZ, -
GetViewNamesZZ- 9
(ZZ9 :
idOnaZZ: ?
)ZZ? @
;ZZ@ A
return[[ 
Ok[[ 
([[ 
new[[ 
RespuestasAPI[[ +
<[[+ ,
List[[, 0
<[[0 1
string[[1 7
>[[7 8
>[[8 9
{[[: ;
Result[[< B
=[[C D
result[[E K
}[[L M
)[[M N
;[[N O
}\\ 
catch]] 
(]] 
	Exception]] 
e]] 
)]] 
{^^ 
return__ 
HandleException__ &
(__& '
e__' (
,__( )
nameof__* 0
(__0 1
GetViewNames__1 =
)__= >
)__> ?
;__? @
}`` 
}aa 	
[ll 	
HttpGetll	 
(ll 
Routesll 
.ll %
GETLISTAVALIDACIONESQUEMAll 1
,ll1 2
Namell3 7
=ll8 9
$strll: U
)llU V
]llV W
publicmm 
IActionResultmm %
GetListaValidacionEsquemamm 6
(mm6 7
intmm7 :
idOnamm; @
,mm@ A
intmmB E
	idEsquemammF O
)mmO P
{nn 	
tryoo 
{pp 
varqq 
resultqq 
=qq 
_dynamicServiceqq ,
.qq, -%
GetListaValidacionEsquemaqq- F
(qqF G
idOnaqqG L
,qqL M
	idEsquemaqqN W
)qqW X
;qqX Y
returnrr 
Okrr 
(rr 
newrr 
RespuestasAPIrr +
<rr+ ,
Listrr, 0
<rr0 1
EsquemaVistaDtorr1 @
>rr@ A
>rrA B
{rrC D
ResultrrE K
=rrL M
resultrrN T
}rrU V
)rrV W
;rrW X
}ss 
catchtt 
(tt 
	Exceptiontt 
ett 
)tt 
{uu 
returnvv 
HandleExceptionvv &
(vv& '
evv' (
,vv( )
nameofvv* 0
(vv0 1%
GetListaValidacionEsquemavv1 J
)vvJ K
)vvK L
;vvL M
}ww 
}xx 	
[
 	
HttpGet
	 
(
 
Routes
 
.
 
TEST
 
)
 
]
 
public
 
IActionResult
 
TestConnection
 +
(
+ ,
int
, /
idOna
0 5
)
5 6
{
 	
try
 
{
 
var
 
conexion
 
=
 
_dynamicService
 .
.
. /
GetConexion
/ :
(
: ;
idOna
; @
)
@ A
;
A B
if
 
(
 
conexion
 
==
 
null
  $
)
$ %
{
 
return
 
NotFound
 #
(
# $
new
$ '
{
( )
Message
* 1
=
2 3
$str
4 M
}
N O
)
O P
;
P Q
}
 
var
 
isConnected
 
=
  !
_dynamicService
" 1
.
1 2$
TestDatabaseConnection
2 H
(
H I
conexion
I Q
)
Q R
;
R S
return
 
Ok
 
(
 
new
 
{
 
	IsSuccess
 
=
 
isConnected
  +
,
+ ,
Message
 
=
 
isConnected
 )
?
* +
$str
, Q
:
R S
$str
T x
}
 
)
 
;
 
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
 
return
 

StatusCode
 !
(
! "
$num
" %
,
% &
new
' *
{
+ ,
Message
- 4
=
5 6
$"
7 9
$str
9 @
{
@ A
ex
A C
.
C D
Message
D K
}
K L
"
L M
}
N O
)
O P
;
P Q
}
 
}
 	
[
££ 	
HttpPost
££	 
(
££ 
Routes
££ 
.
££ 
MIGRAR
££ 
)
££  
]
££  !
public
¤¤ 
async
¤¤ 
Task
¤¤ 
<
¤¤ 
IActionResult
¤¤ '
>
¤¤' (
MigrarConexion
¤¤) 7
(
¤¤7 8
int
¤¤8 ;
idOna
¤¤< A
)
¤¤A B
{
¥¥ 	
try
¦¦ 
{
§§ 
bool
¨¨ 
	resultado
¨¨ 
=
¨¨  
await
¨¨! &
_dynamicService
¨¨' 6
.
¨¨6 7!
MigrarConexionAsync
¨¨7 J
(
¨¨J K
idOna
¨¨K P
)
¨¨P Q
;
¨¨Q R
return
ªª 
Ok
ªª 
(
ªª 
new
ªª 
{
«« 
	IsSuccess
¬¬ 
=
¬¬ 
	resultado
¬¬  )
,
¬¬) *
Message
­­ 
=
­­ 
	resultado
­­ '
?
­­( )
$str
­­* K
:
­­L M
$str
­­N n
}
®® 
)
®® 
;
®® 
}
¯¯ 
catch
°° 
(
°° 
	Exception
°° 
ex
°° 
)
°°  
{
±± 
return
²² 

StatusCode
²² !
(
²²! "
StatusCodes
²²" -
.
²²- .*
Status500InternalServerError
²². J
,
²²J K
new
²²L O
{
²²P Q
Success
²²R Y
=
²²Z [
false
²²\ a
,
²²a b
Message
²²c j
=
²²k l
ex
²²m o
.
²²o p
Message
²²p w
}
²²x y
)
²²y z
;
²²z {
}
³³ 
}
´´ 	
}
·· 
}¸¸ 
PC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\CatalogosController.cs
	namespace

 	
WebApp


 
.

 
Controllers

 
{ 
[ 
AllowAnonymous 
] 
[ 
Route 

(
 
Routes 
. 
	CATALOGOS 
) 
] 
[ 
ApiController 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
public 

class 
CatalogosController $
:% &
BaseController' 5
{ 
private 
readonly 
ICatalogosService *
_iCatalogosService+ =
;= >
public 
CatalogosController "
(" #
ICatalogosService# 4
iCatalogosService5 F
,F G
ILoggerH O
<O P
CatalogosControllerP c
>c d
loggere k
)k l
:m n
baseo s
(s t
loggert z
)z {
{ 	
this 
. 
_iCatalogosService #
=$ %
iCatalogosService& 7
;7 8
} 	
[%% 	
HttpGet%%	 
(%% 
Routes%% 
.%% 
GRID_SCHEMA%% #
)%%# $
]%%$ %
public&& 
IActionResult&& 
ObtenerVwGrilla&& ,
(&&, -
)&&- .
{'' 	
try(( 
{)) 
return** 
Ok** 
(** 
new** 
RespuestasAPI** +
<**+ ,
List**, 0
<**0 1
VwGrillaDto**1 <
>**< =
>**= >
{++ 
Result,, 
=,, 
_iCatalogosService,, /
.,,/ 0
ObtenerVwGrilla,,0 ?
(,,? @
),,@ A
}-- 
)-- 
;-- 
}.. 
catch// 
(// 
	Exception// 
e// 
)// 
{00 
return11 

StatusCode11 !
(11! "
$num11" %
,11% &
new11' *
{11+ ,
mensaje11- 4
=115 6
$str117 F
,11F G
detalle11H O
=11P Q
e11R S
.11S T
Message11T [
}11\ ]
)11] ^
;11^ _
}22 
}33 	
[<< 	
HttpGet<<	 
(<< 
Routes<< 
.<< 
FILTERS_SCHEMA<< &
)<<& '
]<<' (
public== 
IActionResult== 
ObtenerVwFiltro== ,
(==, -
)==- .
{>> 	
try?? 
{@@ 
returnAA 
OkAA 
(AA 
newAA 
RespuestasAPIAA +
<AA+ ,
ListAA, 0
<AA0 1
VwFiltroDtoAA1 <
>AA< =
>AA= >
{BB 
ResultCC 
=CC 
_iCatalogosServiceCC /
.CC/ 0
ObtenerVwFiltroCC0 ?
(CC? @
)CC@ A
}DD 
)DD 
;DD 
}EE 
catchFF 
(FF 
	ExceptionFF 
eFF 
)FF 
{GG 
returnHH 
HandleExceptionHH &
(HH& '
eHH' (
,HH( )
nameofHH* 0
(HH0 1
ObtenerVwFiltroHH1 @
)HH@ A
)HHA B
;HHB C
}II 
}JJ 	
[TT 	
HttpGetTT	 
(TT 
$"TT 
{TT 
RoutesTT 
.TT 
FILTERS_DATATT '
}TT' (
$strTT( 3
"TT3 4
)TT4 5
]TT5 6
publicUU 
IActionResultUU !
ObtenerFiltroDetallesUU 2
(UU2 3
stringUU3 9
codigoUU: @
)UU@ A
{VV 	
tryWW 
{XX 
returnYY 
OkYY 
(YY 
newYY 
RespuestasAPIYY +
<YY+ ,
ListYY, 0
<YY0 1
vwFiltroDetalleDtoYY1 C
>YYC D
>YYD E
{ZZ 
Result[[ 
=[[ 
_iCatalogosService[[ /
.[[/ 0!
ObtenerFiltroDetalles[[0 E
([[E F
codigo[[F L
)[[L M
}\\ 
)\\ 
;\\ 
}]] 
catch^^ 
(^^ 
	Exception^^ 
e^^ 
)^^ 
{__ 
return`` 
HandleException`` &
(``& '
e``' (
,``( )
nameof``* 0
(``0 1!
ObtenerFiltroDetalles``1 F
)``F G
)``G H
;``H I
}aa 
}bb 	
[kk 	
HttpGetkk	 
(kk 
Routeskk 
.kk 
DIMENSION_SCHEMAkk (
)kk( )
]kk) *
publicll 
IActionResultll 
ObtenerVwDimensionll /
(ll/ 0
)ll0 1
{mm 	
trynn 
{oo 
returnpp 
Okpp 
(pp 
newpp 
RespuestasAPIpp +
<pp+ ,
Listpp, 0
<pp0 1
VwDimensionDtopp1 ?
>pp? @
>pp@ A
{qq 
Resultrr 
=rr 
_iCatalogosServicerr /
.rr/ 0
ObtenerVwDimensionrr0 B
(rrB C
)rrC D
}ss 
)ss 
;ss 
}tt 
catchuu 
(uu 
	Exceptionuu 
euu 
)uu 
{vv 
returnww 
HandleExceptionww &
(ww& '
eww' (
,ww( )
nameofww* 0
(ww0 1
ObtenerVwDimensionww1 C
)wwC D
)wwD E
;wwE F
}xx 
}yy 	
[
 	
HttpGet
	 
(
 
Routes
 
.
 
GRUPOS
 
)
 
]
  
public
 
IActionResult
 
ObtenerGrupos
 *
(
* +
)
+ ,
{
 	
try
 
{
 
return
 
Ok
 
(
 
new
 
RespuestasAPI
 +
<
+ ,
List
, 0
<
0 1$
VwHomologacionGrupoDto
1 G
>
G H
>
H I
{
 
Result
 
=
  
_iCatalogosService
 /
.
/ 0(
ObtenerVwHomologacionGrupo
0 J
(
J K
)
K L
}
 
)
 
;
 
}
 
catch
 
(
 
	Exception
 
e
 
)
 
{
 
return
 
HandleException
 &
(
& '
e
' (
,
( )
nameof
* 0
(
0 1
ObtenerGrupos
1 >
)
> ?
)
? @
;
@ A
}
 
}
 	
[
 	
HttpGet
	 
(
 
Routes
 
.
 
ROLES
 
)
 
]
 
public
 
IActionResult
 
ObtenerVwRol
 )
(
) *
)
* +
{
 	
try
 
{
 
return
 
Ok
 
(
 
new
 
RespuestasAPI
 +
<
+ ,
List
, 0
<
0 1
VwRolDto
1 9
>
9 :
>
: ;
{
   
Result
¡¡ 
=
¡¡  
_iCatalogosService
¡¡ /
.
¡¡/ 0
ObtenerVwRol
¡¡0 <
(
¡¡< =
)
¡¡= >
}
¢¢ 
)
¢¢ 
;
¢¢ 
}
££ 
catch
¤¤ 
(
¤¤ 
	Exception
¤¤ 
e
¤¤ 
)
¤¤ 
{
¥¥ 
return
¦¦ 
HandleException
¦¦ &
(
¦¦& '
e
¦¦' (
,
¦¦( )
nameof
¦¦* 0
(
¦¦0 1
ObtenerVwRol
¦¦1 =
)
¦¦= >
)
¦¦> ?
;
¦¦? @
}
§§ 
}
¨¨ 	
[
±± 	
HttpGet
±±	 
(
±± 
Routes
±± 
.
±± 
ONAS
±± 
)
±± 
]
±± 
public
²² 
IActionResult
²² 

ObtenerOna
²² '
(
²²' (
)
²²( )
{
³³ 	
try
´´ 
{
µµ 
return
¶¶ 
Ok
¶¶ 
(
¶¶ 
new
¶¶ 
RespuestasAPI
¶¶ +
<
¶¶+ ,
List
¶¶, 0
<
¶¶0 1
OnaDto
¶¶1 7
>
¶¶7 8
>
¶¶8 9
{
·· 
Result
¸¸ 
=
¸¸  
_iCatalogosService
¸¸ /
.
¸¸/ 0

ObtenerOna
¸¸0 :
(
¸¸: ;
)
¸¸; <
}
¹¹ 
)
¹¹ 
;
¹¹ 
}
ºº 
catch
»» 
(
»» 
	Exception
»» 
e
»» 
)
»» 
{
¼¼ 
return
½½ 
HandleException
½½ &
(
½½& '
e
½½' (
,
½½( )
nameof
½½* 0
(
½½0 1

ObtenerOna
½½1 ;
)
½½; <
)
½½< =
;
½½= >
}
¾¾ 
}
¿¿ 	
[
ÊÊ 	
HttpGet
ÊÊ	 
(
ÊÊ 
Routes
ÊÊ 
.
ÊÊ 
MENU_CATALOGO
ÊÊ %
)
ÊÊ% &
]
ÊÊ& '
public
ËË 
IActionResult
ËË 
ObtenerVwMenu
ËË *
(
ËË* +
)
ËË+ ,
{
ÌÌ 	
try
ÍÍ 
{
ÎÎ 
return
ÏÏ 
Ok
ÏÏ 
(
ÏÏ 
new
ÏÏ 
RespuestasAPI
ÏÏ +
<
ÏÏ+ ,
List
ÏÏ, 0
<
ÏÏ0 1
	VwMenuDto
ÏÏ1 :
>
ÏÏ: ;
>
ÏÏ; <
{
ÐÐ 
Result
ÑÑ 
=
ÑÑ  
_iCatalogosService
ÑÑ /
.
ÑÑ/ 0
ObtenerVwMenu
ÑÑ0 =
(
ÑÑ= >
)
ÑÑ> ?
}
ÒÒ 
)
ÒÒ 
;
ÒÒ 
}
ÓÓ 
catch
ÔÔ 
(
ÔÔ 
	Exception
ÔÔ 
e
ÔÔ 
)
ÔÔ 
{
ÕÕ 
return
ÖÖ 
HandleException
ÖÖ &
(
ÖÖ& '
e
ÖÖ' (
,
ÖÖ( )
nameof
ÖÖ* 0
(
ÖÖ0 1
ObtenerVwMenu
ÖÖ1 >
)
ÖÖ> ?
)
ÖÖ? @
;
ÖÖ@ A
}
×× 
}
ØØ 	
[
áá 	
HttpGet
áá	 
(
áá 
Routes
áá 
.
áá 
PANEL
áá 
)
áá 
]
áá 
public
ââ 
IActionResult
ââ 
ObtenerPanelOna
ââ ,
(
ââ, -
)
ââ- .
{
ãã 	
try
ää 
{
åå 
return
ææ 
Ok
ææ 
(
ææ 
new
ææ 
RespuestasAPI
ææ +
<
ææ+ ,
List
ææ, 0
<
ææ0 1
vwPanelONADto
ææ1 >
>
ææ> ?
>
ææ? @
{
çç 
Result
èè 
=
èè  
_iCatalogosService
èè /
.
èè/ 0
ObtenerVwPanelOna
èè0 A
(
èèA B
)
èèB C
}
éé 
)
éé 
;
éé 
}
êê 
catch
ëë 
(
ëë 
	Exception
ëë 
e
ëë 
)
ëë 
{
ìì 
return
íí 
HandleException
íí &
(
íí& '
e
íí' (
,
íí( )
nameof
íí* 0
(
íí0 1
ObtenerPanelOna
íí1 @
)
íí@ A
)
ííA B
;
ííB C
}
îî 
}
ïï 	
[
øø 	
HttpGet
øø	 
(
øø 
Routes
øø 
.
øø "
ESQUEMA_ORGANIZACION
øø ,
)
øø, -
]
øø- .
public
ùù 
IActionResult
ùù $
ObtenerEsquemaOrganiza
ùù 3
(
ùù3 4
)
ùù4 5
{
úú 	
try
ûû 
{
üü 
return
ýý 
Ok
ýý 
(
ýý 
new
ýý 
RespuestasAPI
ýý +
<
ýý+ ,
List
ýý, 0
<
ýý0 1"
vwEsquemaOrganizaDto
ýý1 E
>
ýýE F
>
ýýF G
{
þþ 
Result
ÿÿ 
=
ÿÿ  
_iCatalogosService
ÿÿ /
.
ÿÿ/ 0&
ObtenervwEsquemaOrganiza
ÿÿ0 H
(
ÿÿH I
)
ÿÿI J
}
 
)
 
;
 
}
 
catch
 
(
 
	Exception
 
e
 
)
 
{
 
return
 
HandleException
 &
(
& '
e
' (
,
( )
nameof
* 0
(
0 1$
ObtenerEsquemaOrganiza
1 G
)
G H
)
H I
;
I J
}
 
}
 	
[
 	
HttpGet
	 
(
 
Routes
 
.
 
VW_ONA
 
)
 
]
  
public
 
IActionResult
 
ObtenerVwOna
 )
(
) *
)
* +
{
 	
try
 
{
 
return
 
Ok
 
(
 
new
 
RespuestasAPI
 +
<
+ ,
List
, 0
<
0 1
vwONADto
1 9
>
9 :
>
: ;
{
 
Result
 
=
  
_iCatalogosService
 /
.
/ 0
ObtenervwOna
0 <
(
< =
)
= >
}
 
)
 
;
 
}
 
catch
 
(
 
	Exception
 
e
 
)
 
{
 
return
 
HandleException
 &
(
& '
e
' (
,
( )
nameof
* 0
(
0 1
ObtenerVwOna
1 =
)
= >
)
> ?
;
? @
}
 
}
 	
[
¦¦ 	
HttpPost
¦¦	 
(
¦¦ 
Routes
¦¦ 
.
¦¦ 
FILTERS_ANINADOS
¦¦ )
)
¦¦) *
]
¦¦* +
public
§§ 
IActionResult
§§ $
ObtenerFiltrosAnidados
§§ 3
(
§§3 4
[
§§4 5
FromBody
§§5 =
]
§§= >
List
§§? C
<
§§C D)
FiltrosBusquedaSeleccionDto
§§D _
>
§§_ `"
filtrosSeleccionados
§§a u
)
§§u v
{
¨¨ 	
try
©© 
{
ªª 
var
«« 
	resultado
«« 
=
««  
_iCatalogosService
««  2
.
««2 3$
ObtenerFiltrosAnidados
««3 I
(
««I J"
filtrosSeleccionados
««J ^
)
««^ _
;
««_ `
return
¬¬ 
Ok
¬¬ 
(
¬¬ 
	resultado
¬¬ #
)
¬¬# $
;
¬¬$ %
}
­­ 
catch
®® 
(
®® 
	Exception
®® 
e
®® 
)
®® 
{
¯¯ 
return
°° 
HandleException
°° &
(
°°& '
e
°°' (
,
°°( )
nameof
°°* 0
(
°°0 1$
ObtenerFiltrosAnidados
°°1 G
)
°°G H
)
°°H I
;
°°I J
}
±± 
}
²² 	
[
»» 	
HttpGet
»»	 
(
»» 
Routes
»» 
.
»» 
ANINADOS
»»  
)
»»  !
]
»»! "
public
¼¼ 
IActionResult
¼¼ '
ObtenerFiltrosAnidadosAll
¼¼ 6
(
¼¼6 7
)
¼¼7 8
{
½½ 	
try
¾¾ 
{
¿¿ 
var
ÀÀ 
	resultado
ÀÀ 
=
ÀÀ  
_iCatalogosService
ÀÀ  2
.
ÀÀ2 3'
ObtenerFiltrosAnidadosAll
ÀÀ3 L
(
ÀÀL M
)
ÀÀM N
;
ÀÀN O
return
ÁÁ 
Ok
ÁÁ 
(
ÁÁ 
	resultado
ÁÁ #
)
ÁÁ# $
;
ÁÁ$ %
}
ÂÂ 
catch
ÃÃ 
(
ÃÃ 
	Exception
ÃÃ 
e
ÃÃ 
)
ÃÃ 
{
ÄÄ 
return
ÅÅ 

StatusCode
ÅÅ !
(
ÅÅ! "
$num
ÅÅ" %
,
ÅÅ% &
$"
ÅÅ' )
$str
ÅÅ) L
{
ÅÅL M
e
ÅÅM N
.
ÅÅN O
Message
ÅÅO V
}
ÅÅV W
"
ÅÅW X
)
ÅÅX Y
;
ÅÅY Z
}
ÆÆ 
}
ÇÇ 	
}
ÈÈ 
}ÉÉ Æ
OC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\BuscadorController.cs
	namespace 	
WebApp
 
. 
Controllers 
{		 
[ 
AllowAnonymous 
] 
[ 
ApiController 
] 
[ 
Route 

(
 
Routes 
. 
BUSCADOR 
) 
] 
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status200OK& 1
)1 2
]2 3
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status400BadRequest& 9
)9 :
]: ;
[  
ProducesResponseType 
( 
StatusCodes %
.% &!
Status401Unauthorized& ;
); <
]< =
[  
ProducesResponseType 
( 
StatusCodes %
.% &
Status403Forbidden& 8
)8 9
]9 :
[  
ProducesResponseType 
( 
StatusCodes %
.% &(
Status500InternalServerError& B
)B C
]C D
public 

class 
BuscadorController #
:$ %
BaseController& 4
{ 
private 
readonly 
IBuscadorService )
buscadorService* 9
;9 :
public 
BuscadorController !
(! "
IBuscadorService" 2
buscadorService3 B
,B C
ILoggerD K
<K L
BuscadorControllerL ^
>^ _
logger` f
)f g
:h i
basej n
(n o
loggero u
)u v
{ 	
this   
.   
buscadorService    
=  ! "
buscadorService  # 2
;  2 3
}!! 	
[%% 	
HttpGet%%	 
(%% 
Routes%% 
.%% 
SEARCH_PHRASE%% %
)%%% &
]%%& '
public&& 
IActionResult&& 
PsBuscarPalabra&& ,
(&&, -
string&&- 3
	paramJSON&&4 =
,&&= >
int&&? B

PageNumber&&C M
,&&M N
int&&O R
RowsPerPage&&S ^
)&&^ _
{'' 	
try(( 
{)) 
return** 
Ok** 
(** 
new** 
RespuestasAPI** +
<**+ ,
BuscadorDto**, 7
>**7 8
{++ 
Result,, 
=,, 
buscadorService,, ,
.,,, -
PsBuscarPalabra,,- <
(,,< =
	paramJSON,,= F
,,,F G

PageNumber,,H R
,,,R S
RowsPerPage,,T _
),,_ `
}-- 
)-- 
;-- 
}.. 
catch// 
(// 
	Exception// 
e// 
)// 
{00 
return11 
HandleException11 &
(11& '
e11' (
,11( )
nameof11* 0
(110 1
PsBuscarPalabra111 @
)11@ A
)11A B
;11B C
}22 
}33 	
[55 	
HttpGet55	 
(55 
Routes55 
.55 %
HOMOLOGACION_ESQUEMA_TODO55 1
)551 2
]552 3
public66 
IActionResult66 %
FnHomologacionEsquemaTodo66 6
(666 7
string667 =
VistaFk66> E
,66E F
int66G J
idOna66K P
)66P Q
{77 	
try88 
{99 
return:: 
Ok:: 
(:: 
new:: 
RespuestasAPI:: +
<::+ ,
List::, 0
<::0 1

EsquemaDto::1 ;
>::; <
>::< =
{;; 
Result<< 
=<< 
buscadorService<< ,
.<<, -%
FnHomologacionEsquemaTodo<<- F
(<<F G
VistaFk<<G N
,<<N O
idOna<<P U
)<<U V
}== 
)== 
;== 
}>> 
catch?? 
(?? 
	Exception?? 
e?? 
)?? 
{@@ 
returnAA 
HandleExceptionAA &
(AA& '
eAA' (
,AA( )
nameofAA* 0
(AA0 1%
FnHomologacionEsquemaTodoAA1 J
)AAJ K
)AAK L
;AAL M
}BB 
}CC 	
[EE 	
HttpGetEE	 
(EE 
$"EE 
{EE 
RoutesEE 
.EE #
HOMOLOGACION_ESQUEMA_IDEE 2
}EE2 3
$strEE3 E
"EEE F
)EEF G
]EEG H
publicFF 
IActionResultFF !
FnHomologacionEsquemaFF 2
(FF2 3
intFF3 6
	idEsquemaFF7 @
)FF@ A
{GG 	
tryHH 
{II 
returnJJ 
OkJJ 
(JJ 
newJJ 
RespuestasAPIJJ +
<JJ+ ,
FnEsquemaDtoJJ, 8
>JJ8 9
{KK 
ResultLL 
=LL 
buscadorServiceLL ,
.LL, -!
FnHomologacionEsquemaLL- B
(LLB C
	idEsquemaLLC L
)LLL M
}MM 
)MM 
;MM 
}NN 
catchOO 
(OO 
	ExceptionOO 
eOO 
)OO 
{PP 
returnQQ 
HandleExceptionQQ &
(QQ& '
eQQ' (
,QQ( )
nameofQQ* 0
(QQ0 1!
FnHomologacionEsquemaQQ1 F
)QQF G
)QQG H
;QQH I
}RR 
}SS 	
[UU 	
HttpGetUU	 
(UU 
$"UU 
{UU 
RoutesUU 
.UU "
FN_ESQUEMA_CABECERA_IDUU 1
}UU1 2
$strUU2 H
"UUH I
)UUI J
]UUJ K
publicVV 
IActionResultVV 
FnEsquemaCabeceraVV .
(VV. /
intVV/ 2
IdEsquemadataVV3 @
)VV@ A
{WW 	
tryXX 
{YY 
returnZZ 
OkZZ 
(ZZ 
newZZ 
RespuestasAPIZZ +
<ZZ+ , 
fnEsquemaCabeceraDtoZZ, @
>ZZ@ A
{[[ 
Result\\ 
=\\ 
buscadorService\\ ,
.\\, -
FnEsquemaCabecera\\- >
(\\> ?
IdEsquemadata\\? L
)\\L M
}]] 
)]] 
;]] 
}^^ 
catch__ 
(__ 
	Exception__ 
e__ 
)__ 
{`` 
returnaa 
HandleExceptionaa &
(aa& '
eaa' (
,aa( )
nameofaa* 0
(aa0 1
FnEsquemaCabeceraaa1 B
)aaB C
)aaC D
;aaD E
}bb 
}cc 	
[ee 	
HttpGetee	 
(ee 
$"ee 
{ee 
Routesee 
.ee %
HOMOLOGACION_ESQUEMA_DATOee 4
}ee4 5
$stree5 U
"eeU V
)eeV W
]eeW X
publicff 
IActionResultff %
FnHomologacionEsquemaDatoff 6
(ff6 7
intff7 :
	idEsquemaff; D
,ffD E
stringffF L
VistaFKffM T
,ffT U
intffV Y
idOnaffZ _
)ff_ `
{gg 	
tryhh 
{ii 
returnjj 
Okjj 
(jj 
newjj 
RespuestasAPIjj +
<jj+ ,
Listjj, 0
<jj0 1(
FnHomologacionEsquemaDataDtojj1 M
>jjM N
>jjN O
{kk 
Resultll 
=ll 
buscadorServicell ,
.ll, -%
FnHomologacionEsquemaDatoll- F
(llF G
	idEsquemallG P
,llP Q
VistaFKllR Y
,llY Z
idOnall[ `
)ll` a
}mm 
)mm 
;mm 
}nn 
catchoo 
(oo 
	Exceptionoo 
eoo 
)oo 
{pp 
returnqq 
HandleExceptionqq &
(qq& '
eqq' (
,qq( )
nameofqq* 0
(qq0 1%
FnHomologacionEsquemaDatoqq1 J
)qqJ K
)qqK L
;qqL M
}rr 
}ss 	
[uu 	
HttpGetuu	 
(uu 
Routesuu 
.uu  
ESQUEMA_DATO_BUSCADOuu ,
)uu, -
]uu- .
publicvv 
IActionResultvv 
FnEsquemaDatovv *
(vv* +
intvv+ .
idEsquemaDatavv/ <
,vv< =
stringvv> D
TextoBuscarvvE P
)vvP Q
{ww 	
tryxx 
{yy 
varzz 
resultzz 
=zz 
buscadorServicezz ,
.zz, -
FnEsquemaDatoBuscarzz- @
(zz@ A
idEsquemaDatazzA N
,zzN O
TextoBuscarzzP [
)zz[ \
;zz\ ]
return{{ 
Ok{{ 
({{ 
new{{ 
RespuestasAPI{{ +
<{{+ ,
List{{, 0
<{{0 1#
FnEsquemaDataBuscadoDto{{1 H
>{{H I
>{{I J
{{{K L
Result{{M S
={{T U
result{{V \
}{{] ^
){{^ _
;{{_ `
}|| 
catch}} 
(}} 
	Exception}} 
e}} 
)}} 
{~~ 
return 
HandleException &
(& '
e' (
,( )
nameof* 0
(0 1
FnEsquemaDato1 >
)> ?
)? @
;@ A
}
 
}
 	
[
 	
HttpGet
	 
(
 
Routes
 
.
 
PREDIC_WORDS
 $
)
$ %
]
% &
public
 
IActionResult
 
FnPredictWords
 +
(
+ ,
string
, 2
word
3 7
)
7 8
{
 	
try
 
{
 
return
 
Ok
 
(
 
new
 
RespuestasAPI
 +
<
+ ,
List
, 0
<
0 1
FnPredictWordsDto
1 B
>
B C
>
C D
{
 
Result
 
=
 
buscadorService
 ,
.
, -
FnPredictWords
- ;
(
; <
word
< @
)
@ A
}
 
)
 
;
 
}
 
catch
 
(
 
	Exception
 
e
 
)
 
{
 
return
 
HandleException
 &
(
& '
e
' (
,
( )
nameof
* 0
(
0 1
FnPredictWords
1 ?
)
? @
)
@ A
;
A B
}
 
}
 	
[
 	
HttpPost
	 
(
 
Routes
 
.
 
PREDIC_WORDS
 %
)
% &
]
& '
public
 
IActionResult
 
ValidateWords
 *
(
* +
[
+ ,
FromBody
, 4
]
4 5
List
6 :
<
: ;
string
; A
>
A B
words
C H
)
H I
{
 	
try
 
{
 
return
 
Ok
 
(
 
new
 
RespuestasAPI
 +
<
+ ,
bool
, 0
>
0 1
{
 
Result
 
=
 
buscadorService
 ,
.
, -
ValidateWords
- :
(
: ;
words
; @
)
@ A
}
 
)
 
;
 
}
 
catch
 
(
 
	Exception
 
e
 
)
 
{
 
return
 
HandleException
 &
(
& '
e
' (
,
( )
nameof
* 0
(
0 1
ValidateWords
1 >
)
> ?
)
? @
;
@ A
}
   
}
¡¡ 	
[
££ 	
HttpPost
££	 
(
££ 
Routes
££ 
.
££ 
EVENTTRACKING
££ &
)
££& '
]
££' (
public
¤¤ 
IActionResult
¤¤ 
AddEventTracking
¤¤ -
(
¤¤- .
[
¤¤. /
FromBody
¤¤/ 7
]
¤¤7 8
EventTrackingDto
¤¤9 I
eventTracking
¤¤J W
)
¤¤W X
{
¥¥ 	
try
¦¦ 
{
§§ 
var
¨¨ 
	ipAddress
¨¨ 
=
¨¨ 
HttpContext
¨¨  +
.
¨¨+ ,

Connection
¨¨, 6
.
¨¨6 7
RemoteIpAddress
¨¨7 F
?
¨¨F G
.
¨¨G H
ToString
¨¨H P
(
¨¨P Q
)
¨¨Q R
;
¨¨R S
buscadorService
©© 
.
©©  
AddEventTracking
©©  0
(
©©0 1
eventTracking
©©1 >
,
©©> ?
	ipAddress
©©@ I
)
©©I J
;
©©J K
return
ªª 
Ok
ªª 
(
ªª 
new
ªª 
RespuestasAPI
ªª +
<
ªª+ ,
string
ªª, 2
>
ªª2 3
{
ªª4 5
Result
ªª6 <
=
ªª= >
$str
ªª? ]
}
ªª^ _
)
ªª_ `
;
ªª` a
}
«« 
catch
¬¬ 
(
¬¬ 
	Exception
¬¬ 
e
¬¬ 
)
¬¬ 
{
­­ 
return
®® 
HandleException
®® &
(
®®& '
e
®®' (
,
®®( )
nameof
®®* 0
(
®®0 1
AddEventTracking
®®1 A
)
®®A B
)
®®B C
;
®®C D
}
¯¯ 
}
°° 	
[
²² 	
HttpGet
²²	 
(
²² 
Routes
²² 
.
²² 
GEO_CODE
²²  
)
²²  !
]
²²! "
public
³³ 
async
³³ 
Task
³³ 
<
³³ 
IActionResult
³³ '
>
³³' (
GetCoordinates
³³) 7
(
³³7 8
[
³³8 9
	FromQuery
³³9 B
]
³³B C
string
³³D J
address
³³K R
)
³³R S
{
´´ 	
try
µµ 
{
¶¶ 
var
·· 
response
·· 
=
·· 
await
·· $
buscadorService
··% 4
.
··4 5
GetCoordinates
··5 C
(
··C D
address
··D K
)
··K L
;
··L M
return
¹¹ 
Ok
¹¹ 
(
¹¹ 
response
¹¹ "
)
¹¹" #
;
¹¹# $
}
ºº 
catch
»» 
(
»» 
	Exception
»» 
e
»» 
)
»» 
{
»»  !
return
»»" (
HandleException
»») 8
(
»»8 9
e
»»9 :
,
»»: ;
nameof
»»< B
(
»»B C
GetCoordinates
»»C Q
)
»»Q R
)
»»R S
;
»»S T
}
»»U V
}
¼¼ 	
[
¾¾ 	
HttpPost
¾¾	 
(
¾¾ 
Routes
¾¾ 
.
¾¾ 
EXCEL
¾¾ 
)
¾¾ 
]
¾¾  
public
¿¿ 
IActionResult
¿¿ 
ExportExcel
¿¿ (
(
¿¿( )
[
¿¿) *
FromBody
¿¿* 2
]
¿¿2 3
List
¿¿4 8
<
¿¿8 9

Dictionary
¿¿9 C
<
¿¿C D
string
¿¿D J
,
¿¿J K
string
¿¿L R
>
¿¿R S
>
¿¿S T
data
¿¿U Y
)
¿¿Y Z
{
ÀÀ 	
if
ÁÁ 
(
ÁÁ 
data
ÁÁ 
.
ÁÁ 
Count
ÁÁ 
==
ÁÁ 
$num
ÁÁ 
)
ÁÁ  
return
ÁÁ! '

BadRequest
ÁÁ( 2
(
ÁÁ2 3
$str
ÁÁ3 O
)
ÁÁO P
;
ÁÁP Q
var
ÂÂ 
response
ÂÂ 
=
ÂÂ 
buscadorService
ÂÂ *
.
ÂÂ* +
ExportExcel
ÂÂ+ 6
(
ÂÂ6 7
data
ÂÂ7 ;
)
ÂÂ; <
;
ÂÂ< =
return
ÃÃ 
File
ÃÃ 
(
ÃÃ 
response
ÃÃ  
,
ÃÃ  !
$str
ÄÄ [
,
ÄÄ[ \
$str
ÅÅ *
)
ÅÅ* +
;
ÅÅ+ ,
}
ÆÆ 	
[
ÈÈ 	
HttpPost
ÈÈ	 
(
ÈÈ 
Routes
ÈÈ 
.
ÈÈ 
PDF
ÈÈ 
)
ÈÈ 
]
ÈÈ 
public
ÉÉ 
IActionResult
ÉÉ 
	ExportPdf
ÉÉ &
(
ÉÉ& '
[
ÉÉ' (
FromBody
ÉÉ( 0
]
ÉÉ0 1
List
ÉÉ2 6
<
ÉÉ6 7

Dictionary
ÉÉ7 A
<
ÉÉA B
string
ÉÉB H
,
ÉÉH I
string
ÉÉJ P
>
ÉÉP Q
>
ÉÉQ R
data
ÉÉS W
)
ÉÉW X
{
ÊÊ 	
var
ËË 
response
ËË 
=
ËË 
buscadorService
ËË *
.
ËË* +
	ExportPdf
ËË+ 4
(
ËË4 5
data
ËË5 9
)
ËË9 :
;
ËË: ;
return
ÌÌ 
File
ÌÌ 
(
ÌÌ 
response
ÌÌ  
,
ÌÌ  !
$str
ÌÌ" 3
,
ÌÌ3 4
$str
ÌÌ5 F
)
ÌÌF G
;
ÌÌG H
}
ÍÍ 	
}
ÎÎ 
}ÏÏ  
KC:\Users\Dell\source\repos\BuscadorCan\WebApp\Controllers\BaseController.cs
	namespace 	
WebApp
 
. 
Controllers 
{		 
public 

class 
BaseController 
:  !
ControllerBase" 0
{ 
private 
readonly 
ILogger  
<  !
BaseController! /
>/ 0
_logger1 8
;8 9
	protected 
BaseController  
(  !
ILogger! (
<( )
BaseController) 7
>7 8
logger9 ?
)? @
{ 	
this 
. 
_logger 
= 
logger !
;! "
} 	
	protected## 
IActionResult## 
HandleException##  /
(##/ 0
	Exception##0 9
e##: ;
,##; <
string$$ 

methodName$$ 
,$$ 
[%% 
CallerMemberName%% 
]%% 
string%% %
?%%% &
caller%%' -
=%%. /
null%%0 4
)%%4 5
{&& 	
_logger'' 
.'' 
LogError'' 
('' 
e'' 
,'' 
$str(( A
,((A B

methodName)) 
,)) 
caller** 
,** 
HttpContext++ 
.++ 
TraceIdentifier++ '
)++' (
;++( )
var.. 
	respuesta.. 
=.. 
new.. 
RespuestasAPI..  -
<..- .
object... 4
>..4 5
{// 

StatusCode00 
=00 
HttpStatusCode00 +
.00+ ,
InternalServerError00, ?
,00? @
	IsSuccess11 
=11 
false11 !
,11! "
ErrorMessages22 
=22 
new22  #
List22$ (
<22( )
string22) /
>22/ 0
{221 2
$str223 O
}22P Q
,22Q R
Result33 
=33 
new33 
{33 
}33  
}44 
;44 
return66 

StatusCode66 
(66 
StatusCodes66 )
.66) *(
Status500InternalServerError66* F
,66F G
	respuesta66H Q
)66Q R
;66R S
}77 	
	protectedAA 
IActionResultAA 
BadRequestResponseAA  2
(AA2 3
stringAA3 9
messageAA: A
)AAA B
{BB 	
returnCC 

BadRequestCC 
(CC 
newCC !
RespuestasAPICC" /
<CC/ 0
objectCC0 6
>CC6 7
{DD 

StatusCodeEE 
=EE 
HttpStatusCodeEE +
.EE+ ,

BadRequestEE, 6
,EE6 7
	IsSuccessFF 
=FF 
falseFF !
,FF! "
ErrorMessagesGG 
=GG 
newGG  #
ListGG$ (
<GG( )
stringGG) /
>GG/ 0
{GG1 2
messageGG3 :
}GG; <
,GG< =
ResultHH 
=HH 
newHH 
{HH 
}HH  
}II 
)II 
;II 
}JJ 	
	protectedTT 
IActionResultTT 
NotFoundResponseTT  0
(TT0 1
stringTT1 7
messageTT8 ?
)TT? @
{UU 	
returnVV 
NotFoundVV 
(VV 
newVV 
RespuestasAPIVV  -
<VV- .
objectVV. 4
>VV4 5
{WW 

StatusCodeXX 
=XX 
HttpStatusCodeXX +
.XX+ ,
NotFoundXX, 4
,XX4 5
	IsSuccessYY 
=YY 
falseYY !
,YY! "
ErrorMessagesZZ 
=ZZ 
newZZ  #
ListZZ$ (
<ZZ( )
stringZZ) /
>ZZ/ 0
{ZZ1 2
messageZZ3 :
}ZZ; <
,ZZ< =
Result[[ 
=[[ 
new[[ 
{[[ 
}[[  
}\\ 
)\\ 
;\\ 
}]] 	
}__ 
}`` 